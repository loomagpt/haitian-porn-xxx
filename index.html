<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streamflix - Video Streaming</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Roboto', Arial, sans-serif;
        }
        
        body {
            background-color: #0f0f0f;
            color: #f1f1f1;
            overflow-x: hidden;
        }
        
        /* OFFLINE MESSAGE */
        #offlineMessage {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: #ffcc00;
            color: #000;
            text-align: center;
            padding: 10px;
            z-index: 2000;
            display: none;
            font-weight: 500;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }
        
        /* SPLASH SCREEN */
        #splashScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #0f0f0f;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }
        
        .splash-logo {
            font-size: 48px;
            font-weight: bold;
            color: #ff0000;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .splash-logo i {
            font-size: 52px;
        }
        
        .splash-welcome {
            font-size: 24px;
            color: #f1f1f1;
            margin-bottom: 40px;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #303030;
            border-top: 4px solid #ff0000;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* AUTH SCREEN - SIMPLIFIED */
        #authScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #0f0f0f;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 999;
            padding: 20px;
        }
        
        .auth-container {
            background-color: #1a1a1a;
            border-radius: 12px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .auth-form h2 {
            margin-bottom: 20px;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #aaa;
            font-size: 14px;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 16px;
            background-color: #121212;
            border: 1px solid #303030;
            border-radius: 8px;
            color: #f1f1f1;
            font-size: 16px;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #ff0000;
        }
        
        .auth-button {
            width: 100%;
            padding: 14px;
            background-color: #ff0000;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .auth-button:hover {
            background-color: #cc0000;
        }
        
        /* MAIN APP */
        #mainApp {
            display: none;
        }
        
        /* Header Styles */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 16px;
            height: 56px;
            background-color: #0f0f0f;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid #303030;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .logo-image {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            overflow: hidden;
            background-color: #ff0000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logo-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .logo-text {
            font-size: 22px;
            font-weight: bold;
            color: #ff0000;
            text-decoration: none;
        }
        
        /* SMART SEARCH BAR */
        .search-container {
            display: flex;
            flex: 0 1 640px;
            margin: 0 40px;
            position: relative;
        }
        
        .search-box-container {
            display: flex;
            width: 100%;
            position: relative;
        }
        
        .search-box {
            flex: 1;
            padding: 8px 16px;
            background-color: #121212;
            border: 1px solid #303030;
            border-right: none;
            border-radius: 40px 0 0 40px;
            color: #f1f1f1;
            font-size: 16px;
            width: 100%;
        }
        
        .search-btn {
            background-color: #222222;
            border: 1px solid #303030;
            border-left: none;
            border-radius: 0 40px 40px 0;
            padding: 8px 20px;
            cursor: pointer;
            color: #f1f1f1;
            min-width: 64px;
        }
        
        .search-btn:hover {
            background-color: #303030;
        }
        
        .voice-search-btn {
            background: none;
            border: none;
            color: #f1f1f1;
            padding: 8px;
            margin-left: 12px;
            cursor: pointer;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .voice-search-btn:hover {
            background-color: #272727;
        }
        
        /* Search Suggestions Dropdown */
        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background-color: #212121;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            z-index: 101;
            display: none;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .suggestion-item {
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            color: #f1f1f1;
            text-decoration: none;
        }
        
        .suggestion-item:hover {
            background-color: #383838;
        }
        
        .suggestion-item i {
            color: #aaa;
            font-size: 16px;
            width: 24px;
        }
        
        .suggestion-item span {
            font-size: 14px;
        }
        
        .recent-searches {
            padding: 12px 16px;
            color: #aaa;
            font-size: 14px;
            border-bottom: 1px solid #303030;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .clear-recent {
            color: #3ea6ff;
            cursor: pointer;
            font-size: 13px;
        }
        
        .clear-recent:hover {
            text-decoration: underline;
        }
        
        .user-actions {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #ff0000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* Navigation */
        .nav-container {
            padding: 0 24px;
            background-color: #0f0f0f;
            border-bottom: 1px solid #303030;
            position: sticky;
            top: 56px;
            z-index: 99;
        }
        
        .nav-items {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            overflow-x: auto;
            white-space: nowrap;
        }
        
        .nav-item {
            background-color: #272727;
            color: #f1f1f1;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .nav-item.active {
            background-color: #f1f1f1;
            color: #0f0f0f;
        }
        
        /* Main Content Layout */
        .main-container {
            padding: 24px;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        /* HOME PAGE - Video Grid */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 24px 16px;
        }
        
        .video-card {
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .video-card:hover {
            transform: scale(1.02);
        }
        
        .thumbnail-container {
            position: relative;
            width: 100%;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 12px;
            background-color: #000;
            aspect-ratio: 16/9;
        }
        
        .thumbnail {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        
        .duration {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .video-info {
            display: flex;
            gap: 12px;
        }
        
        .channel-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: #ff0000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
            overflow: hidden;
        }
        
        .channel-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .video-details h3 {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 6px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .video-details p {
            font-size: 14px;
            color: #aaa;
            margin-bottom: 4px;
        }
        
        /* VIDEO DETAIL PAGE */
        .detail-page {
            display: none;
        }
        
        .video-container {
            display: flex;
            gap: 24px;
        }
        
        .video-player-section {
            flex: 7;
        }
        
        .sidebar {
            flex: 3;
            max-width: 400px;
        }
        
        /* Video Player */
        .video-player {
            width: 100%;
            background-color: #000;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 16px;
        }
        
        video {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .video-title {
            font-size: 20px;
            font-weight: 600;
            margin: 12px 0;
        }
        
        /* Video Actions */
        .video-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #303030;
        }
        
        .channel-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .channel-avatar-large {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #ff0000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            overflow: hidden;
        }
        
        .channel-avatar-large img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .channel-name {
            font-weight: 600;
        }
        
        .subscribe-btn {
            background-color: #ff0000;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            margin-left: 20px;
        }
        
        .subscribe-btn.subscribed {
            background-color: #303030;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            background-color: #272727;
            border: none;
            color: #f1f1f1;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
        }
        
        .action-btn:hover {
            background-color: #3f3f3f;
        }
        
        .action-btn.active {
            color: #ff0000;
        }
        
        /* Video Description */
        .video-description {
            background-color: #272727;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
            line-height: 1.6;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .views-date {
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            gap: 20px;
        }
        
        /* Comments Section */
        .comments-section {
            margin-top: 24px;
        }
        
        .comments-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .comment-input {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .comment-user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #3ea6ff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .comment-box {
            flex: 1;
            background: transparent;
            border: none;
            border-bottom: 1px solid #303030;
            color: #f1f1f1;
            padding: 8px 0;
            font-size: 14px;
        }
        
        .comment-box:focus {
            outline: none;
            border-bottom-color: #3ea6ff;
        }
        
        .comment {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .comment-content h4 {
            font-size: 14px;
            margin-bottom: 4px;
        }
        
        .comment-text {
            font-size: 14px;
            line-height: 1.5;
        }
        
        .comment-actions {
            display: flex;
            gap: 12px;
            margin-top: 8px;
        }
        
        .comment-action {
            color: #aaa;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
        }
        
        /* Sidebar - Recommendations */
        .recommendations-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .recommendations-header h3 {
            font-size: 18px;
            font-weight: 600;
        }
        
        .ai-badge {
            background-color: #3ea6ff;
            color: #0f0f0f;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .recommended-video {
            display: flex;
            gap: 12px;
            margin-bottom: 12px;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
        }
        
        .recommended-video:hover {
            background-color: #272727;
        }
        
        .recommended-thumbnail {
            width: 168px;
            height: 94px;
            border-radius: 8px;
            overflow: hidden;
            flex-shrink: 0;
            background-color: #333;
            position: relative;
        }
        
        .recommended-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .recommended-thumbnail .duration {
            position: absolute;
            bottom: 4px;
            right: 4px;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 2px 4px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .recommended-info h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 6px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .recommended-info p {
            font-size: 12px;
            color: #aaa;
            margin-bottom: 4px;
        }
        
        /* Back to Home Button */
        .back-home {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #f1f1f1;
            text-decoration: none;
            margin-bottom: 20px;
            padding: 8px 16px;
            border-radius: 20px;
            background-color: #272727;
        }
        
        .back-home:hover {
            background-color: #3f3f3f;
        }
        
        /* Offline Content Styling */
        .offline-content {
            text-align: center;
            padding: 40px 20px;
        }
        
        .offline-icon {
            font-size: 64px;
            color: #666;
            margin-bottom: 20px;
        }
        
        .offline-content h2 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #f1f1f1;
        }
        
        .offline-content p {
            color: #aaa;
            font-size: 16px;
            margin-bottom: 20px;
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .video-container {
                flex-direction: column;
            }
            
            .sidebar {
                max-width: 100%;
            }
            
            .search-container {
                flex: 0 1 400px;
                margin: 0 20px;
            }
            
            .video-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .search-container {
                display: none;
            }
            
            .mobile-search-btn {
                display: block;
            }
            
            .video-actions {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }
            
            .action-buttons {
                width: 100%;
                justify-content: space-between;
            }
            
            .recommended-video {
                flex-direction: column;
            }
            
            .recommended-thumbnail {
                width: 100%;
                height: 180px;
            }
            
            .video-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
        }
        
        /* Mobile Search Overlay */
        .mobile-search-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #0f0f0f;
            z-index: 1000;
            display: none;
            flex-direction: column;
        }
        
        .mobile-search-header {
            display: flex;
            align-items: center;
            padding: 16px;
            background-color: #0f0f0f;
            border-bottom: 1px solid #303030;
        }
        
        .mobile-search-input {
            flex: 1;
            padding: 12px 16px;
            background-color: #121212;
            border: 1px solid #303030;
            border-radius: 20px;
            color: #f1f1f1;
            font-size: 16px;
            margin: 0 12px;
        }
        
        .mobile-search-close {
            background: none;
            border: none;
            color: #f1f1f1;
            font-size: 20px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- OFFLINE MESSAGE -->
    <div id="offlineMessage">
        <i class="fas fa-wifi"></i> You're offline. Check your connection.
    </div>
    
    <!-- SPLASH SCREEN -->
    <div id="splashScreen">
        <div class="splash-logo">
            <i class="fas fa-play-circle"></i>
            Stream Flix
        </div>
        <div class="splash-welcome">Welcome</div>
        <div class="loading-spinner"></div>
    </div>
    
    <!-- AUTH SCREEN - SIMPLIFIED -->
    <div id="authScreen">
        <div class="auth-container">
            <div class="auth-form">
                <h2>Welcome to Streamflix</h2>
                <p style="color: #aaa; text-align: center; margin-bottom: 30px;">Enter a username to continue</p>
                
                <div class="form-group">
                    <label for="authUsername">Username</label>
                    <input type="text" id="authUsername" placeholder="Enter your username">
                </div>
                
                <button class="auth-button" id="skipAuthButton">
                    <i class="fas fa-play"></i> Continue
                </button>
                
                <div style="text-align: center; margin-top: 20px;">
                    <p style="color: #aaa; font-size: 14px;">By continuing, you agree to our Terms of Service</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- MOBILE SEARCH OVERLAY -->
    <div class="mobile-search-overlay" id="mobileSearchOverlay">
        <div class="mobile-search-header">
            <button class="mobile-search-close" id="mobileSearchClose">
                <i class="fas fa-arrow-left"></i>
            </button>
            <input type="text" class="mobile-search-input" id="mobileSearchInput" placeholder="Search Streamflix">
            <button class="search-btn" id="mobileSearchBtn">
                <i class="fas fa-search"></i>
            </button>
        </div>
        <div class="search-suggestions" id="mobileSearchSuggestions">
            <!-- Mobile search suggestions will appear here -->
        </div>
    </div>
    
    <!-- MAIN APP -->
    <div id="mainApp">
        <!-- Header with Logo and Search -->
        <header>
            <div class="logo-container">
                <button class="mobile-search-btn" id="mobileSearchBtnIcon" style="display: none; background: none; border: none; color: #f1f1f1; margin-right: 12px;">
                    <i class="fas fa-search"></i>
                </button>
                <div class="logo-image">
                    <img id="channelLogo" src="https://cdn.leonardo.ai/users/59cc19c6-be61-41ed-ab82-8485d4d58d54/generations/807f5487-c3b8-4ccd-9ab8-dabab318a67d/Phoenix_10_Create_a_clean_bold_modern_logo_for_an_app_named_St_0.jpg" alt="Streamflix Logo">
                </div>
                <a href="#" class="logo-text" id="homeLogo">
                    Streamflix
                </a>
            </div>
            
            <!-- SMART SEARCH BAR -->
            <div class="search-container">
                <div class="search-box-container">
                    <input type="text" class="search-box" id="searchBox" placeholder="Search" aria-label="Search videos">
                    <button class="search-btn" id="searchBtn" aria-label="Search">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                <button class="voice-search-btn" id="voiceSearchBtn" aria-label="Voice search" title="Voice search">
                    <i class="fas fa-microphone"></i>
                </button>
                
                <!-- Search Suggestions Dropdown -->
                <div class="search-suggestions" id="searchSuggestions">
                    <div class="recent-searches">
                        <span>Recent searches</span>
                        <span class="clear-recent" id="clearRecent">Clear all</span>
                    </div>
                    <!-- Search suggestions will be dynamically inserted here -->
                </div>
            </div>
            
            <div class="user-actions">
                <div class="user-avatar" id="userAvatar">U</div>
            </div>
        </header>
        
        <!-- Navigation -->
        <div class="nav-container">
            <div class="nav-items">
                <button class="nav-item active">All</button>
                <button class="nav-item">Movies</button>
                <button class="nav-item">Action</button>
                <button class="nav-item">Horror</button>
                <button class="nav-item">French</button>
                <button class="nav-item">Sci-Fi</button>
                <button class="nav-item">Adventure</button>
                <button class="nav-item">Zombie</button>
            </div>
        </div>
        
        <!-- HOME PAGE -->
        <div class="main-container" id="homePage">
            <h1 style="margin-bottom: 20px;">Recommended Videos</h1>
            
            <div class="video-grid" id="videoGrid">
                <!-- Video cards will be generated by JavaScript -->
            </div>
            
            <!-- Offline Content Placeholder -->
            <div id="offlineContent" class="offline-content" style="display: none;">
                <div class="offline-icon">
                    <i class="fas fa-wifi-slash"></i>
                </div>
                <h2>No Internet Connection</h2>
                <p>You're offline. Check your internet connection and try again.</p>
                <p>Videos will appear when you're back online.</p>
            </div>
        </div>
        
        <!-- VIDEO DETAIL PAGE -->
        <div class="main-container detail-page" id="detailPage">
            <a href="#" class="back-home" id="backHomeBtn">
                <i class="fas fa-arrow-left"></i> Back to Home
            </a>
            
            <div class="video-container">
                <!-- Video Player Section -->
                <div class="video-player-section">
                    <!-- Video Player -->
                    <div class="video-player">
                        <video id="mainVideo" controls poster="" preload="metadata">
                            <source src="" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                    
                    <!-- Video Title -->
                    <h1 class="video-title" id="detailVideoTitle"></h1>
                    
                    <!-- Video Actions -->
                    <div class="video-actions">
                        <div class="channel-info">
                            <div class="channel-avatar-large" id="detailChannelAvatar">
                                <img id="channelLogoDetail" src="https://cdn.leonardo.ai/users/59cc19c6-be61-41ed-ab82-8485d4d58d54/generations/807f5487-c3b8-4ccd-9ab8-dabab318a67d/Phoenix_10_Create_a_clean_bold_modern_logo_for_an_app_named_St_0.jpg" alt="Streamflix Logo">
                            </div>
                            <div>
                                <div class="channel-name" id="detailChannelName"></div>
                                <div class="subscribers" id="detailSubscribers"></div>
                            </div>
                            <button class="subscribe-btn" id="subscribeBtn">SUBSCRIBE</button>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="action-btn" id="likeBtn">
                                <i class="fas fa-thumbs-up"></i> <span id="likeCount">0</span>
                            </button>
                            <button class="action-btn" id="dislikeBtn">
                                <i class="fas fa-thumbs-down"></i> <span id="dislikeCount">0</span>
                            </button>
                            <button class="action-btn" id="shareBtn">
                                <i class="fas fa-share"></i> Share
                            </button>
                            <button class="action-btn">
                                <i class="fas fa-download"></i> Download
                            </button>
                        </div>
                    </div>
                    
                    <!-- Video Description -->
                    <div class="video-description">
                        <div class="views-date">
                            <span id="detailViews">0 views</span>
                            <span id="detailDate">Just now</span>
                        </div>
                        <p id="detailDescription"></p>
                    </div>
                    
                    <!-- Comments Section -->
                    <div class="comments-section">
                        <div class="comments-title">
                            <span id="commentCount">Comments â€¢ 0</span>
                        </div>
                        
                        <div class="comment-input">
                            <div class="comment-user-avatar" id="commentUserAvatar">U</div>
                            <input type="text" class="comment-box" id="commentInput" placeholder="Add a comment...">
                        </div>
                        
                        <div id="commentsContainer">
                            <!-- Comments will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <!-- Sidebar with Recommendations -->
                <div class="sidebar">
                    <div class="recommendations-header">
                        <h3>Recommended Videos</h3>
                        <div class="ai-badge">
                            <i class="fas fa-robot"></i> AI Recommended
                        </div>
                    </div>
                    
                    <div id="recommendationsContainer">
                        <!-- Recommended videos will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // App State
        let currentUser = null;
        let videos = [];
        let currentVideoId = null;
        let isSubscribed = false;
        let isLiked = false;
        let isDisliked = false;
        let currentVideoData = null;
        let isOnline = navigator.onLine;
        let recentSearches = JSON.parse(localStorage.getItem('streamflix_recent_searches')) || [];
        let searchTimeout = null;

        // Smart search suggestions database
        const searchSuggestions = {
            // Movies
            'bloodshot': ['bloodshot film', 'bloodshot complet', 'bloodshot franÃ§ais', 'vin diesel'],
            'beast': ['beast warrior', 'beast film', 'beast action'],
            'robin': ['robin des bois', 'robin hood', 'robin rebellion'],
            'rats': ['rats zombies', 'rats mutants', 'rats film', 'rats train'],
            'zombie': ['zombie film', 'zombie horror', 'zombie rats'],
            'horror': ['horror film', 'horror movie', 'horror complet'],
            'action': ['action film', 'action movie', 'action complet'],
            'french': ['french film', 'film franÃ§ais', 'french movie'],
            'film': ['film complet', 'full movie', 'movie'],
            'movie': ['movie', 'film', 'full movie'],
            'complet': ['film complet', 'movie complet', 'full'],
            
            // Genres
            'sci-fi': ['science fiction', 'sci fi film', 'futuriste'],
            'adventure': ['aventure', 'adventure film', 'exploration'],
            'thriller': ['thriller film', 'suspense', 'mystery'],
            
            // Actors/Directors
            'vin diesel': ['vin diesel film', 'fast furious', 'xxx'],
            'action francais': ['action franÃ§ais', 'film action franÃ§ais'],
            
            // Specific phrases
            'des rats': ['rats zombies', 'rats mutants', 'train rats'],
            'train': ['train film', 'train action', 'train horror'],
            'mutants': ['mutants film', 'mutants horror', 'creatures mutants']
        };

        // Common search queries
        const commonQueries = [
            'Film complet franÃ§ais',
            'Action film complet',
            'Horror movie',
            'Sci-fi film',
            'Zombie rats',
            'Vin Diesel',
            'French movies',
            'Full movie'
        ];

        // Video Data - INCLUDING NEW ZOMBIE RAT FILM
        const videoData = [
            {
                id: 1,
                title: "Bloodshot film complet en franÃ§ais",
                channel: "Streamflix Movies",
                channelInitial: "S",
                views: 2450321,
                uploadDate: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000), // 7 days ago
                duration: "1:49:12",
                thumbnail: "https://dn720703.ca.archive.org/0/items/images-3_20250908/images%20%283%29.jpeg",
                videoUrl: "https://archive.org/download/bloodshot-version-francaise-360-p/Bloodshot_%5BVersion_fran%C3%A7aise%5D_360P.mp4",
                description: "Ray Garrison, a soldier resurrected with nanotech after being killed, gaining superhuman strength and healing, but then discovers his memories and mission (avenging his wife) are manipulated by the corporation that created him, forcing him to fight for truth and escape his programming in a sci-fi action thriller starring Vin Diesel.",
                subscribers: "1.2M subscribers",
                likes: 245000,
                dislikes: 12000,
                comments: 8452,
                commentsList: [
                    { user: "John MovieCritic", text: "This movie exceeded my expectations! Vin Diesel delivers one of his best performances. The nanotech concept is fascinating.", likes: 1200, time: "2 days ago" },
                    { user: "SciFiFan99", text: "The visual effects are stunning, especially the regeneration scenes. Hope they make a sequel!", likes: 845, time: "1 week ago" }
                ],
                tags: ["action", "sci-fi", "french", "vin diesel", "film complet", "franÃ§ais"]
            },
            {
                id: 2,
                title: "Beast Warrior Film action Complet en franÃ§ais",
                channel: "Streamflix Action",
                channelInitial: "S",
                views: 1850432,
                uploadDate: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000), // 2 days ago
                duration: "1:38:00",
                thumbnail: "https://archive.org/download/obrp-c-smwp-8-hd/OBrpC_SMWP8-HD.jpg",
                videoUrl: "https://archive.org/download/beast-warrior-film-complet-en-francais-action-sf-720p/Beast_Warrior___Film_Complet_en_Fran%C3%A7ais___Action%2C_SF%28720p%29.mp4",
                description: "Beast Warrior is an action-packed science fiction film featuring epic battles, advanced technology, and a hero's journey in a futuristic world. Follow the warrior's quest to protect humanity from formidable threats using extraordinary abilities and combat skills.",
                subscribers: "950K subscribers",
                likes: 185000,
                dislikes: 8500,
                comments: 5234,
                commentsList: [
                    { user: "ActionMovieFan", text: "Incredible action sequences! The fight choreography is top-notch.", likes: 850, time: "1 day ago" },
                    { user: "FrenchCinema", text: "Great to see quality action films available in French. Excellent dubbing!", likes: 621, time: "3 days ago" }
                ],
                tags: ["action", "sci-fi", "french", "adventure", "film complet", "franÃ§ais"]
            },
            {
                id: 3,
                title: "Robin Des Bois La RÃ©bellion Film Complet En FranÃ§ais Action Aventure ACE",
                channel: "Streamflix Adventure",
                channelInitial: "S",
                views: 1567890,
                uploadDate: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000), // 1 day ago
                duration: "1:45:00",
                thumbnail: "https://archive.org/download/maxresdefault-1-1_202508/maxresdefault%20%281%29%20%281%29.jpg",
                videoUrl: "https://archive.org/download/robin-des-bois-la-rebellion-film-complet-en-francais-action-aventure-ace-720p/Robin_des_bois___la_r%C3%A9bellion___Film_Complet_en_Fran%C3%A7ais___Action___Aventure___ACE%28720p%29.mp4",
                description: "Robin Hood La RÃ©bellion - Suivez les aventures du cÃ©lÃ¨bre hors-la-loi qui vole aux riches pour donner aux pauvres. Dans cette version captivante, Robin des Bois mÃ¨ne la rÃ©bellion contre le shÃ©rif corrompu de Nottingham, combattant pour la justice et l'Ã©galitÃ© dans l'Angleterre mÃ©diÃ©vale.",
                subscribers: "850K subscribers",
                likes: 165000,
                dislikes: 7500,
                comments: 4123,
                commentsList: [
                    { user: "AdventureSeeker", text: "Fantastic adaptation of Robin Hood! The rebellion scenes are epic.", likes: 45, time: "Just now" },
                    { user: "HistoryBuff", text: "Love the medieval setting and the fight for justice. True to the Robin Hood legend!", likes: 67, time: "5 hours ago" }
                ],
                tags: ["action", "adventure", "french", "historical", "robin hood", "film complet", "franÃ§ais"]
            },
            {
                id: 4,
                title: "FILM COMPLET] Des rats se transforment en zombies ! Une horde de rats mutants attaque fÃ©rocement des survivants",
                channel: "Streamflix Horror",
                channelInitial: "S",
                views: 892345,
                uploadDate: new Date(Date.now() - 12 * 60 * 60 * 1000), // 12 hours ago
                duration: "1:32:15",
                thumbnail: "https://archive.org/download/11d-8d-0d-1-2852-4a-87-b-739-d-5fac-85f-6d-8c/11d8d0d1-2852-4a87-b739-d5fac85f6d8c.jpeg",
                videoUrl: "https://archive.org/download/des-rats-se-transforment-en-zombies-une-horde-de-rats-mutants-attaque-feroceme/YTDown.com_YouTube_Media_Z91WwO5nCyE_001_1080p.mp4",
                description: "ðŸ’•ã€Sous licence officielleã€‘Toutes les vidÃ©os de cette chaÃ®ne sont sous licence. ðŸ™ŒAbonnez-vous pour Ãªtre informÃ© des nouvelles vidÃ©os. Un film d'horreur intense oÃ¹ des rats se transforment en zombies ! Une horde de rats mutants attaque fÃ©rocement des survivants qui tentent dÃ©sespÃ©rÃ©ment de s'Ã©chapper d'un wagon de train exigu. Suspense, action et horreur garantis !",
                subscribers: "720K subscribers",
                likes: 89000,
                dislikes: 4200,
                comments: 3124,
                commentsList: [
                    { user: "HorrorFanatic", text: "This movie gave me nightmares! The rat zombie concept is terrifying and original.", likes: 320, time: "3 hours ago" },
                    { user: "SurvivalExpert", text: "The train setting creates such claustrophobic tension. Amazing suspense throughout!", likes: 215, time: "6 hours ago" },
                    { user: "ZombieLover", text: "Finally a fresh take on zombie movies! Rat zombies are both creepy and creative.", likes: 189, time: "1 day ago" }
                ],
                tags: ["horror", "zombie", "rats", "mutants", "survival", "train", "french", "film complet", "franÃ§ais", "thriller"]
            }
        ];

        // DOM Elements
        const splashScreen = document.getElementById('splashScreen');
        const authScreen = document.getElementById('authScreen');
        const mainApp = document.getElementById('mainApp');
        const homePage = document.getElementById('homePage');
        const detailPage = document.getElementById('detailPage');
        const videoGrid = document.getElementById('videoGrid');
        const offlineMessage = document.getElementById('offlineMessage');
        const offlineContent = document.getElementById('offlineContent');
        const homeLogo = document.getElementById('homeLogo');
        const backHomeBtn = document.getElementById('backHomeBtn');
        const searchBox = document.getElementById('searchBox');
        const searchBtn = document.getElementById('searchBtn');
        const voiceSearchBtn = document.getElementById('voiceSearchBtn');
        const searchSuggestionsEl = document.getElementById('searchSuggestions');
        const clearRecentBtn = document.getElementById('clearRecent');
        const userAvatar = document.getElementById('userAvatar');
        const skipAuthButton = document.getElementById('skipAuthButton');
        const authUsername = document.getElementById('authUsername');
        const mobileSearchBtnIcon = document.getElementById('mobileSearchBtnIcon');
        const mobileSearchOverlay = document.getElementById('mobileSearchOverlay');
        const mobileSearchClose = document.getElementById('mobileSearchClose');
        const mobileSearchInput = document.getElementById('mobileSearchInput');
        const mobileSearchBtn = document.getElementById('mobileSearchBtn');
        const mobileSearchSuggestions = document.getElementById('mobileSearchSuggestions');
        
        // Detail page elements
        const mainVideo = document.getElementById('mainVideo');
        const detailVideoTitle = document.getElementById('detailVideoTitle');
        const detailChannelName = document.getElementById('detailChannelName');
        const detailSubscribers = document.getElementById('detailSubscribers');
        const detailViews = document.getElementById('detailViews');
        const detailDate = document.getElementById('detailDate');
        const detailDescription = document.getElementById('detailDescription');
        const likeBtn = document.getElementById('likeBtn');
        const dislikeBtn = document.getElementById('dislikeBtn');
        const likeCount = document.getElementById('likeCount');
        const dislikeCount = document.getElementById('dislikeCount');
        const subscribeBtn = document.getElementById('subscribeBtn');
        const commentCount = document.getElementById('commentCount');
        const commentsContainer = document.getElementById('commentsContainer');
        const recommendationsContainer = document.getElementById('recommendationsContainer');
        const commentInput = document.getElementById('commentInput');
        const commentUserAvatar = document.getElementById('commentUserAvatar');

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Check network status
            updateNetworkStatus();
            
            // Listen for online/offline events
            window.addEventListener('online', updateNetworkStatus);
            window.addEventListener('offline', updateNetworkStatus);
            
            // Check screen size for responsive search
            checkScreenSize();
            window.addEventListener('resize', checkScreenSize);
            
            // Start with splash screen
            setTimeout(() => {
                splashScreen.style.opacity = '0';
                setTimeout(() => {
                    splashScreen.style.display = 'none';
                    showAuthScreen();
                }, 500);
            }, 2000);
            
            // Skip auth button
            skipAuthButton.addEventListener('click', function() {
                const username = authUsername.value.trim() || 'Guest';
                currentUser = { displayName: username, email: 'guest@streamflix.com' };
                showMainApp();
                loadVideos();
                updateRecentSearchesUI();
            });
            
            // Set up main app event listeners
            homeLogo.addEventListener('click', function(e) {
                e.preventDefault();
                showHomePage();
            });
            
            backHomeBtn.addEventListener('click', function(e) {
                e.preventDefault();
                showHomePage();
            });
            
            // Desktop search functionality
            searchBtn.addEventListener('click', function() {
                performSearch(searchBox.value);
            });
            
            searchBox.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch(this.value);
                }
            });
            
            searchBox.addEventListener('input', function() {
                showSearchSuggestions(this.value);
            });
            
            searchBox.addEventListener('focus', function() {
                if (this.value.trim() === '') {
                    showRecentSearches();
                }
            });
            
            // Voice search button
            voiceSearchBtn.addEventListener('click', function() {
                initiateVoiceSearch();
            });
            
            // Clear recent searches
            clearRecentBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                clearRecentSearches();
            });
            
            // Close search suggestions when clicking outside
            document.addEventListener('click', function(event) {
                if (!searchBox.contains(event.target) && !searchSuggestionsEl.contains(event.target)) {
                    hideSearchSuggestions();
                }
            });
            
            // Mobile search functionality
            mobileSearchBtnIcon.addEventListener('click', function() {
                showMobileSearch();
            });
            
            mobileSearchClose.addEventListener('click', function() {
                hideMobileSearch();
            });
            
            mobileSearchBtn.addEventListener('click', function() {
                performSearch(mobileSearchInput.value);
                hideMobileSearch();
            });
            
            mobileSearchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch(this.value);
                    hideMobileSearch();
                }
            });
            
            mobileSearchInput.addEventListener('input', function() {
                showMobileSearchSuggestions(this.value);
            });
            
            // Set up like/dislike buttons
            likeBtn.addEventListener('click', toggleLike);
            dislikeBtn.addEventListener('click', toggleDislike);
            subscribeBtn.addEventListener('click', toggleSubscribe);
            
            // Comment input
            commentInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && this.value.trim()) {
                    addComment(this.value.trim());
                    this.value = '';
                }
            });
            
            // Video player events
            mainVideo.addEventListener('play', function() {
                if (currentVideoId && currentUser) {
                    // Record view when video starts playing
                    recordView(currentVideoId);
                }
            });
            
            mainVideo.addEventListener('loadeddata', function() {
                console.log('Video loaded successfully');
            });
            
            mainVideo.addEventListener('error', function(e) {
                console.error('Error loading video:', e);
                // Show alternative message
                const videoPlayer = document.querySelector('.video-player');
                if (videoPlayer && !videoPlayer.querySelector('.video-error')) {
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'video-error';
                    errorDiv.style.cssText = `
                        position: absolute;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0,0,0,0.8);
                        color: white;
                        display: flex;
                        flex-direction: column;
                        justify-content: center;
                        align-items: center;
                        padding: 20px;
                        text-align: center;
                    `;
                    errorDiv.innerHTML = `
                        <i class="fas fa-exclamation-triangle" style="font-size: 48px; margin-bottom: 20px;"></i>
                        <h3>Video Playback Error</h3>
                        <p>There was an error loading the video. Please try again later.</p>
                        <p style="font-size: 12px; margin-top: 10px;">If the problem persists, the video might be temporarily unavailable.</p>
                    `;
                    videoPlayer.appendChild(errorDiv);
                }
            });
        });

        // Check screen size for responsive search
        function checkScreenSize() {
            if (window.innerWidth <= 768) {
                document.querySelector('.search-container').style.display = 'none';
                mobileSearchBtnIcon.style.display = 'block';
            } else {
                document.querySelector('.search-container').style.display = 'flex';
                mobileSearchBtnIcon.style.display = 'none';
                if (mobileSearchOverlay.style.display === 'flex') {
                    hideMobileSearch();
                }
            }
        }

        // Show mobile search overlay
        function showMobileSearch() {
            mobileSearchOverlay.style.display = 'flex';
            mobileSearchInput.focus();
        }

        // Hide mobile search overlay
        function hideMobileSearch() {
            mobileSearchOverlay.style.display = 'none';
            mobileSearchInput.value = '';
            mobileSearchSuggestions.innerHTML = '';
            mobileSearchSuggestions.style.display = 'none';
        }

        // Update network status
        function updateNetworkStatus() {
            isOnline = navigator.onLine;
            
            if (isOnline) {
                // Hide offline message
                offlineMessage.style.display = 'none';
                
                // If we're on home page and offline content is showing, reload
                if (homePage.style.display !== 'none' && offlineContent.style.display === 'block') {
                    loadVideos();
                }
            } else {
                // Show offline message
                offlineMessage.style.display = 'block';
                
                // Show offline content on home page
                if (homePage.style.display !== 'none') {
                    showOfflineContent();
                }
            }
        }

        // Show offline content
        function showOfflineContent() {
            // Hide video grid
            videoGrid.style.display = 'none';
            
            // Show offline content
            offlineContent.style.display = 'block';
        }

        // Show online content
        function showOnlineContent() {
            // Show video grid
            videoGrid.style.display = 'grid';
            
            // Hide offline content
            offlineContent.style.display = 'none';
        }

        // Show authentication screen
        function showAuthScreen() {
            authScreen.style.display = 'flex';
            mainApp.style.display = 'none';
        }

        // Show main app
        function showMainApp() {
            authScreen.style.display = 'none';
            mainApp.style.display = 'block';
            
            // Update user avatar
            if (currentUser.displayName) {
                userAvatar.textContent = currentUser.displayName.charAt(0).toUpperCase();
                commentUserAvatar.textContent = currentUser.displayName.charAt(0).toUpperCase();
            }
        }

        // Load videos
        function loadVideos() {
            videos = videoData;
            
            // Show online content
            showOnlineContent();
            
            // Render home page
            renderHomePage();
        }

        // Render home page with videos
        function renderHomePage() {
            videoGrid.innerHTML = '';
            
            // Sort videos by upload date (newest first)
            const sortedVideos = [...videos].sort((a, b) => b.uploadDate - a.uploadDate);
            
            sortedVideos.forEach(video => {
                const videoCard = document.createElement('div');
                videoCard.className = 'video-card';
                videoCard.setAttribute('data-id', video.id);
                
                // Format time ago
                const timeAgo = getTimeAgo(video.uploadDate);
                
                // Create thumbnail
                const thumbnailHtml = `
                    <div class="thumbnail-container">
                        <img src="${video.thumbnail}" 
                             alt="${video.title}" 
                             class="thumbnail"
                             onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1536440136628-849c177e76a1?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80';">
                        <div class="duration">${video.duration}</div>
                    </div>
                    <div class="video-info">
                        <div class="channel-avatar">
                            <img src="https://cdn.leonardo.ai/users/59cc19c6-be61-41ed-ab82-8485d4d58d54/generations/807f5487-c3b8-4ccd-9ab8-dabab318a67d/Phoenix_10_Create_a_clean_bold_modern_logo_for_an_app_named_St_0.jpg" 
                                 alt="Streamflix Logo"
                                 onerror="this.style.display='none'; this.parentElement.innerHTML='<span>${video.channelInitial}</span>';">
                        </div>
                        <div class="video-details">
                            <h3>${video.title.length > 60 ? video.title.substring(0, 60) + '...' : video.title}</h3>
                            <p>${video.channel}</p>
                            <p>${formatCount(video.views)} views â€¢ ${timeAgo}</p>
                        </div>
                    </div>
                `;
                
                videoCard.innerHTML = thumbnailHtml;
                
                videoCard.addEventListener('click', function() {
                    if (!isOnline) {
                        alert('You need an internet connection to watch videos. Please check your connection.');
                        return;
                    }
                    const videoId = parseInt(this.getAttribute('data-id'));
                    showVideoDetail(videoId);
                });
                
                videoGrid.appendChild(videoCard);
            });
        }

        // Show video detail page
        function showVideoDetail(videoId) {
            const video = videos.find(v => v.id === videoId);
            if (!video) return;
            
            currentVideoId = videoId;
            currentVideoData = video;
            
            // Clear any previous error messages
            const videoPlayer = document.querySelector('.video-player');
            const errorDiv = videoPlayer.querySelector('.video-error');
            if (errorDiv) {
                errorDiv.remove();
            }
            
            // Update video player and info
            mainVideo.src = video.videoUrl;
            mainVideo.poster = video.thumbnail;
            
            // Set video title and load metadata
            mainVideo.load();
            
            detailVideoTitle.textContent = video.title;
            detailChannelName.textContent = video.channel;
            detailSubscribers.textContent = video.subscribers;
            detailViews.textContent = `${formatCount(video.views)} views`;
            detailDate.textContent = getTimeAgo(video.uploadDate);
            detailDescription.textContent = video.description;
            
            // Update like/dislike counts
            likeCount.textContent = formatCount(video.likes);
            dislikeCount.textContent = formatCount(video.dislikes);
            
            // Update comment count
            commentCount.textContent = `Comments â€¢ ${formatCount(video.comments)}`;
            
            // Load comments
            loadComments(video);
            
            // Load recommendations (excluding current video)
            loadRecommendations(videoId);
            
            // Reset like/dislike/subscribe states
            isLiked = false;
            isDisliked = false;
            isSubscribed = false;
            likeBtn.classList.remove('active');
            dislikeBtn.classList.remove('active');
            subscribeBtn.textContent = 'SUBSCRIBE';
            subscribeBtn.classList.remove('subscribed');
            
            // Show detail page, hide home page
            homePage.style.display = 'none';
            detailPage.style.display = 'block';
            
            // Scroll to top
            window.scrollTo(0, 0);
            
            // Try to auto-play the video (only if online)
            if (isOnline) {
                setTimeout(() => {
                    const playPromise = mainVideo.play();
                    if (playPromise !== undefined) {
                        playPromise.catch(error => {
                            console.log("Auto-play prevented:", error);
                            // Don't show error, let user click play
                        });
                    }
                }, 1000);
            } else {
                // Show offline message for video player
                videoPlayer.innerHTML = `
                    <div style="background: #000; color: #fff; padding: 40px; text-align: center; height: 400px; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                        <div style="font-size: 64px; margin-bottom: 20px;">
                            <i class="fas fa-wifi-slash"></i>
                        </div>
                        <h2>Video Unavailable Offline</h2>
                        <p>You need an internet connection to watch this video.</p>
                        <p>Please check your connection and try again.</p>
                    </div>
                `;
            }
        }

        // Show home page
        function showHomePage() {
            // Pause current video
            if (mainVideo) {
                mainVideo.pause();
            }
            
            homePage.style.display = 'block';
            detailPage.style.display = 'none';
            
            // Check network status
            if (!isOnline) {
                showOfflineContent();
            }
            
            window.scrollTo(0, 0);
        }

        // Load comments
        function loadComments(video) {
            commentsContainer.innerHTML = '';
            
            video.commentsList.forEach(comment => {
                const commentElement = document.createElement('div');
                commentElement.className = 'comment';
                
                commentElement.innerHTML = `
                    <div class="comment-user-avatar">${comment.user.charAt(0)}</div>
                    <div class="comment-content">
                        <h4>${comment.user} <span>${comment.time}</span></h4>
                        <p class="comment-text">${comment.text}</p>
                        <div class="comment-actions">
                            <div class="comment-action">
                                <i class="fas fa-thumbs-up"></i> ${comment.likes}
                            </div>
                            <div class="comment-action">
                                <i class="fas fa-thumbs-down"></i>
                            </div>
                            <div class="comment-action">REPLY</div>
                        </div>
                    </div>
                `;
                
                commentsContainer.appendChild(commentElement);
            });
        }

        // Add a new comment
        function addComment(text) {
            if (!currentUser || !currentVideoId) return;
            
            // Create new comment object
            const newComment = {
                user: currentUser.displayName || 'Guest',
                text: text,
                likes: 0,
                time: 'Just now'
            };
            
            // Add to current video data
            if (currentVideoData) {
                currentVideoData.comments += 1;
                currentVideoData.commentsList.unshift(newComment);
                
                // Update UI
                commentCount.textContent = `Comments â€¢ ${formatCount(currentVideoData.comments)}`;
                
                // Add comment to UI
                const commentElement = document.createElement('div');
                commentElement.className = 'comment';
                
                commentElement.innerHTML = `
                    <div class="comment-user-avatar">${newComment.user.charAt(0)}</div>
                    <div class="comment-content">
                        <h4>${newComment.user} <span>${newComment.time}</span></h4>
                        <p class="comment-text">${newComment.text}</p>
                        <div class="comment-actions">
                            <div class="comment-action">
                                <i class="fas fa-thumbs-up"></i> ${newComment.likes}
                            </div>
                            <div class="comment-action">
                                <i class="fas fa-thumbs-down"></i>
                            </div>
                            <div class="comment-action">REPLY</div>
                        </div>
                    </div>
                `;
                
                commentsContainer.prepend(commentElement);
            }
        }

        // Load recommendations
        function loadRecommendations(currentVideoId) {
            recommendationsContainer.innerHTML = '';
            
            // Get other videos (excluding current video)
            const otherVideos = videos.filter(v => v.id !== currentVideoId);
            
            if (otherVideos.length === 0) {
                recommendationsContainer.innerHTML = `
                    <div style="padding: 20px; text-align: center; color: #aaa;">
                        <p>More videos coming soon!</p>
                    </div>
                `;
                return;
            }
            
            // Sort by views (most popular first) and take up to 4
            const sortedVideos = [...otherVideos]
                .sort((a, b) => b.views - a.views)
                .slice(0, 4);
            
            sortedVideos.forEach(video => {
                const timeAgo = getTimeAgo(video.uploadDate);
                
                const recommendedVideo = document.createElement('div');
                recommendedVideo.className = 'recommended-video';
                recommendedVideo.setAttribute('data-id', video.id);
                
                recommendedVideo.innerHTML = `
                    <div class="recommended-thumbnail">
                        <img src="${video.thumbnail}" alt="${video.title}" onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1536440136628-849c177e76a1?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80';">
                        <div class="duration">${video.duration}</div>
                    </div>
                    <div class="recommended-info">
                        <h4>${video.title.length > 50 ? video.title.substring(0, 50) + '...' : video.title}</h4>
                        <p>${video.channel}</p>
                        <p>${formatCount(video.views)} views â€¢ ${timeAgo}</p>
                    </div>
                `;
                
                recommendedVideo.addEventListener('click', function() {
                    if (!isOnline) {
                        alert('You need an internet connection to watch videos. Please check your connection.');
                        return;
                    }
                    const videoId = parseInt(this.getAttribute('data-id'));
                    showVideoDetail(videoId);
                });
                
                recommendationsContainer.appendChild(recommendedVideo);
            });
        }

        // SMART SEARCH FUNCTIONS

        // Show search suggestions based on input
        function showSearchSuggestions(query) {
            clearTimeout(searchTimeout);
            
            searchTimeout = setTimeout(() => {
                const suggestionsContainer = searchSuggestionsEl;
                suggestionsContainer.innerHTML = '';
                
                if (query.trim() === '') {
                    showRecentSearches();
                    return;
                }
                
                // Show recent searches that match query
                const matchingRecent = recentSearches.filter(search => 
                    search.toLowerCase().includes(query.toLowerCase())
                ).slice(0, 3);
                
                if (matchingRecent.length > 0) {
                    const recentHeader = document.createElement('div');
                    recentHeader.className = 'recent-searches';
                    recentHeader.innerHTML = '<span>Recent searches</span>';
                    suggestionsContainer.appendChild(recentHeader);
                    
                    matchingRecent.forEach(search => {
                        const item = document.createElement('a');
                        item.className = 'suggestion-item';
                        item.href = '#';
                        item.innerHTML = `
                            <i class="fas fa-history"></i>
                            <span>${search}</span>
                        `;
                        item.addEventListener('click', function(e) {
                            e.preventDefault();
                            searchBox.value = search;
                            performSearch(search);
                        });
                        suggestionsContainer.appendChild(item);
                    });
                }
                
                // Generate smart suggestions based on query
                const suggestions = generateSmartSuggestions(query);
                
                if (suggestions.length > 0) {
                    suggestions.forEach(suggestion => {
                        const item = document.createElement('a');
                        item.className = 'suggestion-item';
                        item.href = '#';
                        item.innerHTML = `
                            <i class="fas fa-search"></i>
                            <span>${suggestion}</span>
                        `;
                        item.addEventListener('click', function(e) {
                            e.preventDefault();
                            searchBox.value = suggestion;
                            performSearch(suggestion);
                        });
                        suggestionsContainer.appendChild(item);
                    });
                }
                
                // Show common queries if no specific suggestions
                if (suggestions.length === 0 && matchingRecent.length === 0) {
                    commonQueries.slice(0, 5).forEach(queryText => {
                        const item = document.createElement('a');
                        item.className = 'suggestion-item';
                        item.href = '#';
                        item.innerHTML = `
                            <i class="fas fa-fire"></i>
                            <span>${queryText}</span>
                        `;
                        item.addEventListener('click', function(e) {
                            e.preventDefault();
                            searchBox.value = queryText;
                            performSearch(queryText);
                        });
                        suggestionsContainer.appendChild(item);
                    });
                }
                
                suggestionsContainer.style.display = 'block';
            }, 300);
        }

        // Show mobile search suggestions
        function showMobileSearchSuggestions(query) {
            const suggestionsContainer = mobileSearchSuggestions;
            suggestionsContainer.innerHTML = '';
            
            if (query.trim() === '') {
                showMobileRecentSearches();
                return;
            }
            
            // Generate smart suggestions based on query
            const suggestions = generateSmartSuggestions(query);
            
            if (suggestions.length > 0) {
                suggestions.forEach(suggestion => {
                    const item = document.createElement('a');
                    item.className = 'suggestion-item';
                    item.href = '#';
                    item.innerHTML = `
                        <i class="fas fa-search"></i>
                        <span>${suggestion}</span>
                    `;
                    item.addEventListener('click', function(e) {
                        e.preventDefault();
                        mobileSearchInput.value = suggestion;
                        performSearch(suggestion);
                        hideMobileSearch();
                    });
                    suggestionsContainer.appendChild(item);
                });
            }
            
            // Show common queries if no specific suggestions
            if (suggestions.length === 0) {
                commonQueries.slice(0, 5).forEach(queryText => {
                    const item = document.createElement('a');
                    item.className = 'suggestion-item';
                    item.href = '#';
                    item.innerHTML = `
                        <i class="fas fa-fire"></i>
                        <span>${queryText}</span>
                    `;
                    item.addEventListener('click', function(e) {
                        e.preventDefault();
                        mobileSearchInput.value = queryText;
                        performSearch(queryText);
                        hideMobileSearch();
                    });
                    suggestionsContainer.appendChild(item);
                });
            }
            
            suggestionsContainer.style.display = 'block';
        }

        // Generate smart search suggestions
        function generateSmartSuggestions(query) {
            const queryLower = query.toLowerCase().trim();
            const suggestions = new Set();
            
            // Check for direct matches in suggestion database
            for (const [key, values] of Object.entries(searchSuggestions)) {
                if (queryLower.includes(key)) {
                    values.forEach(value => {
                        if (value.toLowerCase().includes(queryLower) || queryLower.includes(key)) {
                            suggestions.add(value);
                        }
                    });
                }
            }
            
            // Check video titles and tags
            videos.forEach(video => {
                // Check title
                if (video.title.toLowerCase().includes(queryLower)) {
                    const words = video.title.split(' ');
                    for (let i = 0; i < Math.min(3, words.length); i++) {
                        if (words[i].toLowerCase().includes(queryLower)) {
                            suggestions.add(words.slice(0, i + 1).join(' '));
                        }
                    }
                }
                
                // Check tags
                video.tags.forEach(tag => {
                    if (tag.toLowerCase().includes(queryLower)) {
                        suggestions.add(tag);
                        // Add related phrases
                        if (tag.includes('film')) suggestions.add(`${tag} complet`);
                        if (tag.includes('french')) suggestions.add(`film ${tag}`);
                    }
                });
            });
            
            // Add genre suggestions
            const genres = ['action', 'horror', 'sci-fi', 'adventure', 'thriller', 'zombie', 'french'];
            genres.forEach(genre => {
                if (queryLower.includes(genre)) {
                    suggestions.add(`${genre} film`);
                    suggestions.add(`${genre} movie`);
                    suggestions.add(`film ${genre}`);
                }
            });
            
            // Add language suggestions
            if (queryLower.includes('franÃ§ais') || queryLower.includes('french')) {
                suggestions.add('film franÃ§ais');
                suggestions.add('movie french');
                suggestions.add('french film complet');
            }
            
            // Limit to 8 suggestions
            return Array.from(suggestions).slice(0, 8);
        }

        // Show recent searches
        function showRecentSearches() {
            const suggestionsContainer = searchSuggestionsEl;
            suggestionsContainer.innerHTML = '';
            
            if (recentSearches.length === 0) {
                const noRecent = document.createElement('div');
                noRecent.className = 'recent-searches';
                noRecent.innerHTML = '<span>No recent searches</span>';
                suggestionsContainer.appendChild(noRecent);
                
                // Show trending searches instead
                commonQueries.slice(0, 5).forEach(queryText => {
                    const item = document.createElement('a');
                    item.className = 'suggestion-item';
                    item.href = '#';
                    item.innerHTML = `
                        <i class="fas fa-fire"></i>
                        <span>${queryText}</span>
                    `;
                    item.addEventListener('click', function(e) {
                        e.preventDefault();
                        searchBox.value = queryText;
                        performSearch(queryText);
                    });
                    suggestionsContainer.appendChild(item);
                });
            } else {
                const recentHeader = document.createElement('div');
                recentHeader.className = 'recent-searches';
                recentHeader.innerHTML = `
                    <span>Recent searches</span>
                    <span class="clear-recent" id="clearRecent">Clear all</span>
                `;
                suggestionsContainer.appendChild(recentHeader);
                
                // Re-attach clear button event
                recentHeader.querySelector('.clear-recent').addEventListener('click', function(e) {
                    e.stopPropagation();
                    clearRecentSearches();
                });
                
                recentSearches.slice(0, 8).forEach(search => {
                    const item = document.createElement('a');
                    item.className = 'suggestion-item';
                    item.href = '#';
                    item.innerHTML = `
                        <i class="fas fa-history"></i>
                        <span>${search}</span>
                    `;
                    item.addEventListener('click', function(e) {
                        e.preventDefault();
                        searchBox.value = search;
                        performSearch(search);
                    });
                    suggestionsContainer.appendChild(item);
                });
            }
            
            suggestionsContainer.style.display = 'block';
        }

        // Show mobile recent searches
        function showMobileRecentSearches() {
            const suggestionsContainer = mobileSearchSuggestions;
            suggestionsContainer.innerHTML = '';
            
            if (recentSearches.length === 0) {
                const noRecent = document.createElement('div');
                noRecent.className = 'recent-searches';
                noRecent.innerHTML = '<span>No recent searches</span>';
                suggestionsContainer.appendChild(noRecent);
            } else {
                const recentHeader = document.createElement('div');
                recentHeader.className = 'recent-searches';
                recentHeader.innerHTML = `
                    <span>Recent searches</span>
                    <span class="clear-recent" id="mobileClearRecent">Clear all</span>
                `;
                suggestionsContainer.appendChild(recentHeader);
                
                // Attach clear button event for mobile
                recentHeader.querySelector('.clear-recent').addEventListener('click', function(e) {
                    e.stopPropagation();
                    clearRecentSearches();
                    showMobileRecentSearches();
                });
                
                recentSearches.slice(0, 8).forEach(search => {
                    const item = document.createElement('a');
                    item.className = 'suggestion-item';
                    item.href = '#';
                    item.innerHTML = `
                        <i class="fas fa-history"></i>
                        <span>${search}</span>
                    `;
                    item.addEventListener('click', function(e) {
                        e.preventDefault();
                        mobileSearchInput.value = search;
                        performSearch(search);
                        hideMobileSearch();
                    });
                    suggestionsContainer.appendChild(item);
                });
            }
            
            suggestionsContainer.style.display = 'block';
        }

        // Update recent searches UI
        function updateRecentSearchesUI() {
            // This will be called after login to update UI if needed
        }

        // Hide search suggestions
        function hideSearchSuggestions() {
            searchSuggestionsEl.style.display = 'none';
        }

        // Perform search
        function performSearch(query) {
            if (!isOnline) {
                alert('You need to be online to search.');
                return;
            }
            
            const searchTerm = query.trim();
            if (!searchTerm) return;
            
            // Add to recent searches
            addToRecentSearches(searchTerm);
            
            // Filter videos based on search term
            const filteredVideos = videos.filter(video => {
                const searchLower = searchTerm.toLowerCase();
                
                // Check title
                if (video.title.toLowerCase().includes(searchLower)) return true;
                
                // Check channel
                if (video.channel.toLowerCase().includes(searchLower)) return true;
                
                // Check description
                if (video.description.toLowerCase().includes(searchLower)) return true;
                
                // Check tags
                if (video.tags.some(tag => tag.toLowerCase().includes(searchLower))) return true;
                
                return false;
            });
            
            // Update video grid with search results
            videoGrid.innerHTML = '';
            
            if (filteredVideos.length === 0) {
                videoGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                        <h2>No videos found for "${searchTerm}"</h2>
                        <p>Try different keywords or check spelling</p>
                        <div style="margin-top: 20px;">
                            <p style="color: #aaa; margin-bottom: 10px;">Try searching for:</p>
                            <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                                ${commonQueries.slice(0, 4).map(query => `
                                    <button style="background: #272727; color: #f1f1f1; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer;" 
                                            onclick="searchBox.value='${query}'; performSearch('${query}')">
                                        ${query}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else {
                filteredVideos.forEach(video => {
                    const timeAgo = getTimeAgo(video.uploadDate);
                    
                    const videoCard = document.createElement('div');
                    videoCard.className = 'video-card';
                    videoCard.setAttribute('data-id', video.id);
                    
                    videoCard.innerHTML = `
                        <div class="thumbnail-container">
                            <img src="${video.thumbnail}" 
                                 alt="${video.title}" 
                                 class="thumbnail"
                                 onerror="this.onerror=null; this.src='https://images.unsplash.com/photo-1536440136628-849c177e76a1?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80';">
                            <div class="duration">${video.duration}</div>
                        </div>
                        <div class="video-info">
                            <div class="channel-avatar">
                                <img src="https://cdn.leonardo.ai/users/59cc19c6-be61-41ed-ab82-8485d4d58d54/generations/807f5487-c3b8-4ccd-9ab8-dabab318a67d/Phoenix_10_Create_a_clean_bold_modern_logo_for_an_app_named_St_0.jpg" 
                                     alt="Streamflix Logo"
                                     onerror="this.style.display='none'; this.parentElement.innerHTML='<span>${video.channelInitial}</span>';">
                            </div>
                            <div class="video-details">
                                <h3>${video.title.length > 60 ? video.title.substring(0, 60) + '...' : video.title}</h3>
                                <p>${video.channel}</p>
                                <p>${formatCount(video.views)} views â€¢ ${timeAgo}</p>
                            </div>
                        </div>
                    `;
                    
                    videoCard.addEventListener('click', function() {
                        if (!isOnline) {
                            alert('You need an internet connection to watch videos. Please check your connection.');
                            return;
                        }
                        const videoId = parseInt(this.getAttribute('data-id'));
                        showVideoDetail(videoId);
                    });
                    
                    videoGrid.appendChild(videoCard);
                });
            }
            
            // Show home page with search results
            showHomePage();
            
            // Hide search suggestions
            hideSearchSuggestions();
        }

        // Add search to recent searches
        function addToRecentSearches(searchTerm) {
            // Remove if already exists
            recentSearches = recentSearches.filter(s => s.toLowerCase() !== searchTerm.toLowerCase());
            
            // Add to beginning
            recentSearches.unshift(searchTerm);
            
            // Keep only last 10 searches
            if (recentSearches.length > 10) {
                recentSearches.pop();
            }
            
            // Save to localStorage
            localStorage.setItem('streamflix_recent_searches', JSON.stringify(recentSearches));
        }

        // Clear recent searches
        function clearRecentSearches() {
            recentSearches = [];
            localStorage.setItem('streamflix_recent_searches', JSON.stringify(recentSearches));
            showRecentSearches();
            
            // Also update mobile if visible
            if (mobileSearchOverlay.style.display === 'flex') {
                showMobileRecentSearches();
            }
        }

        // Voice search simulation
        function initiateVoiceSearch() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Voice search is not supported in your browser. Please use Chrome or Edge.');
                return;
            }
            
            alert('Voice search activated. Say your search query. (Note: This is a simulation in this demo)');
            
            // In a real implementation, you would use the Web Speech API
            // For demo purposes, we'll simulate it
            setTimeout(() => {
                const demoQueries = ['action movies', 'horror films', 'french cinema', 'zombie rats'];
                const randomQuery = demoQueries[Math.floor(Math.random() * demoQueries.length)];
                
                searchBox.value = randomQuery;
                performSearch(randomQuery);
                
                // Show voice animation
                voiceSearchBtn.innerHTML = '<i class="fas fa-microphone-slash"></i>';
                voiceSearchBtn.style.color = '#ff0000';
                
                setTimeout(() => {
                    voiceSearchBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                    voiceSearchBtn.style.color = '#f1f1f1';
                }, 2000);
            }, 1500);
        }

        // Toggle like
        function toggleLike() {
            if (!currentUser || !currentVideoId) {
                alert('Please login to like videos');
                return;
            }
            
            if (!isOnline) {
                alert('You need to be online to like videos.');
                return;
            }
            
            if (!isLiked) {
                // Update video likes
                if (currentVideoData) {
                    currentVideoData.likes += 1;
                    likeCount.textContent = formatCount(currentVideoData.likes);
                    likeBtn.classList.add('active');
                    isLiked = true;
                    
                    // Remove dislike if present
                    if (isDisliked) {
                        currentVideoData.dislikes -= 1;
                        dislikeCount.textContent = formatCount(currentVideoData.dislikes);
                        dislikeBtn.classList.remove('active');
                        isDisliked = false;
                    }
                }
            } else {
                // Remove like
                if (currentVideoData) {
                    currentVideoData.likes -= 1;
                    likeCount.textContent = formatCount(currentVideoData.likes);
                    likeBtn.classList.remove('active');
                    isLiked = false;
                }
            }
        }

        // Toggle dislike
        function toggleDislike() {
            if (!currentUser || !currentVideoId) {
                alert('Please login to dislike videos');
                return;
            }
            
            if (!isOnline) {
                alert('You need to be online to dislike videos.');
                return;
            }
            
            if (!isDisliked) {
                // Update video dislikes
                if (currentVideoData) {
                    currentVideoData.dislikes += 1;
                    dislikeCount.textContent = formatCount(currentVideoData.dislikes);
                    dislikeBtn.classList.add('active');
                    isDisliked = true;
                    
                    // Remove like if present
                    if (isLiked) {
                        currentVideoData.likes -= 1;
                        likeCount.textContent = formatCount(currentVideoData.likes);
                        likeBtn.classList.remove('active');
                        isLiked = false;
                    }
                }
            } else {
                // Remove dislike
                if (currentVideoData) {
                    currentVideoData.dislikes -= 1;
                    dislikeCount.textContent = formatCount(currentVideoData.dislikes);
                    dislikeBtn.classList.remove('active');
                    isDisliked = false;
                }
            }
        }

        // Toggle subscribe
        function toggleSubscribe() {
            if (!currentUser) {
                alert('Please login to subscribe');
                return;
            }
            
            if (!isOnline) {
                alert('You need to be online to subscribe.');
                return;
            }
            
            // Toggle UI state
            if (!isSubscribed) {
                subscribeBtn.textContent = 'SUBSCRIBED';
                subscribeBtn.classList.add('subscribed');
                isSubscribed = true;
            } else {
                subscribeBtn.textContent = 'SUBSCRIBE';
                subscribeBtn.classList.remove('subscribed');
                isSubscribed = false;
            }
        }

        // Record a view for a video
        function recordView(videoId) {
            if (!currentUser || !videoId || !isOnline) return;
            
            // Update view count locally
            const video = videos.find(v => v.id === videoId);
            if (video) {
                video.views += 1;
                detailViews.textContent = `${formatCount(video.views)} views`;
            }
        }

        // Helper Functions
        function formatCount(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num;
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffMs = now - date;
            const diffSec = Math.floor(diffMs / 1000);
            const diffMin = Math.floor(diffSec / 60);
            const diffHour = Math.floor(diffMin / 60);
            const diffDay = Math.floor(diffHour / 24);
            const diffMonth = Math.floor(diffDay / 30);
            const diffYear = Math.floor(diffDay / 365);
            
            if (diffYear > 0) {
                return `${diffYear} year${diffYear > 1 ? 's' : ''} ago`;
            } else if (diffMonth > 0) {
                return `${diffMonth} month${diffMonth > 1 ? 's' : ''} ago`;
            } else if (diffDay > 0) {
                if (diffDay === 1) return 'Yesterday';
                return `${diffDay} day${diffDay > 1 ? 's' : ''} ago`;
            } else if (diffHour > 0) {
                return `${diffHour} hour${diffHour > 1 ? 's' : ''} ago`;
            } else if (diffMin > 0) {
                return `${diffMin} minute${diffMin > 1 ? 's' : ''} ago`;
            } else {
                return 'Just now';
            }
        }
    </script>
</body>
</html>
