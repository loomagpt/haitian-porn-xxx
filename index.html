<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="monetag" content="d5d43a0a7fb19e1da8689edc281da044">
<!-- GOOGLE VERIFICATION -->
<meta name="google-site-verification" content="jUFvWg6T0RGd45tCoerev16CHRJYJ7j_fBJXesmxztE" />

<!-- BASIC SEO -->
<title>Free HD Porn Videos & XXX Streaming Online | Haitian Porn XXX</title>

<meta name="description"
content="Watch free HD porn videos online. Daily updated XXX videos, trending adult content, fast streaming and unlimited access.">

<meta name="keywords"
content="free porn, hd porn videos, xxx videos, sex videos, porn tube, free sexvideo, online porn, adult videos, streaming porn">

<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1">

<link rel="canonical" href="https://www.haitianpornxxx.icu/">

<!-- LANGUAGE -->
<meta http-equiv="content-language" content="en">

<!-- AUTHOR -->
<meta name="author" content="Haitian Porn XXX">

<!-- OPEN GRAPH (Facebook / WhatsApp / Telegram) -->
<meta property="og:type" content="website">
<meta property="og:title" content="Free HD Porn Videos - Watch XXX Online">
<meta property="og:description" content="Enjoy unlimited free HD porn videos updated daily with fast streaming.">
<meta property="og:url" content="https://www.haitianpornxxx.icu">
<meta property="og:image" content="https://www.haitianpornxxx.icu/assets/preview.jpg">
<meta property="og:site_name" content="Haitian Porn XXX">

<!-- TWITTER CARD -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free HD Porn Videos">
<meta name="twitter:description" content="Watch trending XXX videos online in HD quality.">
<meta name="twitter:image" content="https://www.haitianpornxxx.icu/assets/preview.jpg">

<!-- FAVICON -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">

</head>

<script type="application/javascript">
(function() {
    function randStr(e,t){for(var n="",r=t||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",o=0;o<e;o++)n+=r.charAt(Math.floor(Math.random()*r.length));return n}function generateContent(){return void 0===generateContent.val&&(generateContent.val="document.dispatchEvent("+randStr(4*Math.random()+3)+");"),generateContent.val}try{Object.defineProperty(document.currentScript,"innerHTML",{get:generateContent}),Object.defineProperty(document.currentScript,"textContent",{get:generateContent})}catch(e){};

    //version 8.0.0

    var adConfig = {
    "ads_host": "a.pemsrv.com",
    "syndication_host": "s.pemsrv.com",
    "idzone": 5856034,
    "popup_fallback": false,
    "popup_force": false,
    "chrome_enabled": true,
    "new_tab": false,
    "frequency_period": 5,
    "frequency_count": 1,
    "trigger_method": 3,
    "trigger_class": "",
    "trigger_delay": 0,
    "capping_enabled": true,
    "tcf_enabled": true,
    "only_inline": false
};

window.document.querySelectorAll||(document.querySelectorAll=document.body.querySelectorAll=Object.querySelectorAll=function(e,o,t,i,n){var r=document,a=r.createStyleSheet();for(n=r.all,o=[],t=(e=e.replace(/\[for\b/gi,"[htmlFor").split(",")).length;t--;){for(a.addRule(e[t],"k:v"),i=n.length;i--;)n[i].currentStyle.k&&o.push(n[i]);a.removeRule(0)}return o});var popMagic={version:8,cookie_name:"",url:"",config:{},open_count:0,top:null,browser:null,venor_loaded:!1,venor:!1,tcfData:null,remoteLicensedDomains:["exdynsrv.com","exosrv.com","exoclick.com","opoxv.com","exacdn.com","pemsrv.com"],configTpl:{ads_host:"",syndication_host:"",idzone:"",frequency_period:720,frequency_count:1,trigger_method:1,trigger_class:"",popup_force:!1,popup_fallback:!1,chrome_enabled:!0,new_tab:!1,cat:"",tags:"",el:"",sub:"",sub2:"",sub3:"",only_inline:!1,trigger_delay:0,capping_enabled:!0,tcf_enabled:!1,cookieconsent:!0,should_fire:function(){return!0},on_redirect:null},isAdsDomainLicensed:function(){for(var e=this.config.ads_host,o=this.remoteLicensedDomains.concat([".local","localhost","127.0.0.1"]),t=0;t<o.length;t++){var i=o[t];if("string"==typeof i)if("."===i.charAt(0)){var n=i,r=i.substring(1);if(e.slice(-n.length)===n||e===r)return!0}else{var a=e===i,c="."+i,p=e.slice(-c.length)===c;if(a||p)return!0}}return!1},init:function(e){if(void 0!==e.idzone&&e.idzone){void 0===e.customTargeting&&(e.customTargeting=[]),window.customTargeting=e.customTargeting||null;var o=Object.keys(e.customTargeting).filter(function(e){return e.search("ex_")>=0});for(var t in o.length&&o.forEach(function(e){return this.configTpl[e]=null}.bind(this)),this.configTpl)Object.prototype.hasOwnProperty.call(this.configTpl,t)&&(void 0!==e[t]?this.config[t]=e[t]:this.config[t]=this.configTpl[t]);if(void 0!==this.config.idzone&&""!==this.config.idzone){!0!==this.config.only_inline&&this.isAdsDomainLicensed()&&this.loadHosted();var i=this;this.checkTCFConsent(function(){"complete"===document.readyState?i.preparePopWait():i.addEventToElement(window,"load",i.preparePop)})}}},getCountFromCookie:function(){if(!this.config.cookieconsent)return 0;var e=popMagic.getCookie(popMagic.cookie_name),o=void 0===e?0:parseInt(e);return isNaN(o)&&(o=0),o},getLastOpenedTimeFromCookie:function(){var e=popMagic.getCookie(popMagic.cookie_name),o=null;if(void 0!==e){var t=e.split(";")[1];o=t>0?parseInt(t):0}return isNaN(o)&&(o=null),o},shouldShow:function(e){if(e=e||!1,!popMagic.config.capping_enabled){var o=!0,t=popMagic.config.should_fire;try{e||"function"!=typeof t||(o=Boolean(t()))}catch(e){console.error("Error executing should fire callback function:",e)}return o&&0===popMagic.open_count}if(popMagic.open_count>=popMagic.config.frequency_count)return!1;var i=popMagic.getCountFromCookie(),n=popMagic.getLastOpenedTimeFromCookie(),r=Math.floor(Date.now()/1e3),a=n+popMagic.config.trigger_delay;return!(n&&a>r)&&(popMagic.open_count=i,!(i>=popMagic.config.frequency_count))},venorShouldShow:function(){return popMagic.venor_loaded&&"0"===popMagic.venor},setAsOpened:function(e){var o=e?e.target||e.srcElement:null,t={id:"",tagName:"",classes:"",text:"",href:"",elm:""};void 0!==o&&null!=o&&(t={id:void 0!==o.id&&null!=o.id?o.id:"",tagName:void 0!==o.tagName&&null!=o.tagName?o.tagName:"",classes:void 0!==o.classList&&null!=o.classList?o.classList:"",text:void 0!==o.outerText&&null!=o.outerText?o.outerText:"",href:void 0!==o.href&&null!=o.href?o.href:"",elm:o});var i=new CustomEvent("creativeDisplayed-"+popMagic.config.idzone,{detail:t});if(document.dispatchEvent(i),popMagic.config.capping_enabled){var n=1;n=0!==popMagic.open_count?popMagic.open_count+1:popMagic.getCountFromCookie()+1;var r=Math.floor(Date.now()/1e3);popMagic.config.cookieconsent&&popMagic.setCookie(popMagic.cookie_name,n+";"+r,popMagic.config.frequency_period)}else++popMagic.open_count},loadHosted:function(){var e=document.createElement("script");for(var o in e.type="application/javascript",e.async=!0,e.src="//"+this.config.ads_host+"/popunder1000.js",e.id="popmagicldr",this.config)Object.prototype.hasOwnProperty.call(this.config,o)&&"ads_host"!==o&&"syndication_host"!==o&&e.setAttribute("data-exo-"+o,this.config[o]);var t=document.getElementsByTagName("body").item(0);t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)},preparePopWait:function(){setTimeout(popMagic.preparePop,400)},preparePop:function(){if("object"!=typeof exoJsPop101||!Object.prototype.hasOwnProperty.call(exoJsPop101,"add")){if(popMagic.top=self,popMagic.top!==self)try{top.document.location.toString()&&(popMagic.top=top)}catch(e){}if(popMagic.cookie_name="zone-cap-"+popMagic.config.idzone,popMagic.config.capping_enabled||(document.cookie=popMagic.cookie_name+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/"),popMagic.shouldShow(!0)){var e=new XMLHttpRequest;e.onreadystatechange=function(){e.readyState==XMLHttpRequest.DONE&&(popMagic.venor_loaded=!0,200==e.status?popMagic.venor=e.responseText:popMagic.venor="0")};var o="https:"!==document.location.protocol&&"http:"!==document.location.protocol?"https:":document.location.protocol;e.open("GET",o+"//"+popMagic.config.syndication_host+"/venor.php",!0);try{e.send()}catch(e){popMagic.venor_loaded=!0}}if(popMagic.buildUrl(),popMagic.browser=popMagic.browserDetector.getBrowserInfo(),popMagic.config.chrome_enabled||!popMagic.browser.isChrome){var t=popMagic.getPopMethod(popMagic.browser);popMagic.addEvent("click",t)}}},getPopMethod:function(e){return popMagic.config.popup_force||popMagic.config.popup_fallback&&e.isChrome&&e.version>=68&&!e.isMobile?popMagic.methods.popup:e.isMobile?popMagic.methods.default:e.isChrome?popMagic.methods.chromeTab:popMagic.methods.default},checkTCFConsent:function(e){if(this.config.tcf_enabled&&"function"==typeof window.__tcfapi){var o=this;window.__tcfapi("addEventListener",2,function(t,i){i&&(o.tcfData=t,"tcloaded"!==t.eventStatus&&"useractioncomplete"!==t.eventStatus||(window.__tcfapi("removeEventListener",2,function(){},t.listenerId),e()))})}else e()},buildUrl:function(){var e,o="https:"!==document.location.protocol&&"http:"!==document.location.protocol?"https:":document.location.protocol,t=top===self?document.URL:document.referrer,i={type:"inline",name:"popMagic",ver:this.version},n="";customTargeting&&Object.keys(customTargeting).length&&("object"==typeof customTargeting?Object.keys(customTargeting):customTargeting).forEach(function(o){"object"==typeof customTargeting?e=customTargeting[o]:Array.isArray(customTargeting)&&(e=scriptEl.getAttribute(o));var t=o.replace("data-exo-","");n+="&"+t+"="+e});var r=this.tcfData&&this.tcfData.gdprApplies&&!0===this.tcfData.gdprApplies?1:0,a=popMagic.getCookie("__suvt");this.url=o+"//"+this.config.syndication_host+"/v1/link.php?cat="+this.config.cat+"&idzone="+this.config.idzone+"&type=8&p="+encodeURIComponent(t)+"&sub="+this.config.sub+(""!==this.config.sub2?"&sub2="+this.config.sub2:"")+(""!==this.config.sub3?"&sub3="+this.config.sub3:"")+"&block=1&el="+this.config.el+"&tags="+this.config.tags+"&scr_info="+function(e){var o=e.type+"|"+e.name+"|"+e.ver;return encodeURIComponent(btoa(o))}(i)+n+"&gdpr="+r+"&cb="+Math.floor(1e9*Math.random())+(a?"&suvt="+a:""),this.tcfData&&this.tcfData.tcString?this.url+="&gdpr_consent="+encodeURIComponent(this.tcfData.tcString):this.url+="&cookieconsent="+this.config.cookieconsent},addEventToElement:function(e,o,t){e.addEventListener?e.addEventListener(o,t,!1):e.attachEvent?(e["e"+o+t]=t,e[o+t]=function(){e["e"+o+t](window.event)},e.attachEvent("on"+o,e[o+t])):e["on"+o]=e["e"+o+t]},getTriggerClasses:function(){var e,o=[];-1===popMagic.config.trigger_class.indexOf(",")?e=popMagic.config.trigger_class.split(" "):e=popMagic.config.trigger_class.replace(/\s/g,"").split(",");for(var t=0;t<e.length;t++)""!==e[t]&&o.push("."+e[t]);return o},addEvent:function(e,o){var t;if("3"!=popMagic.config.trigger_method)if("2"!=popMagic.config.trigger_method||""==popMagic.config.trigger_class)if("4"!=popMagic.config.trigger_method||""==popMagic.config.trigger_class)if("5"!=popMagic.config.trigger_method||""==popMagic.config.trigger_class)popMagic.addEventToElement(document,e,o);else{var i="a"+popMagic.getTriggerClasses().map(function(e){return":not("+e+")"}).join("");t=document.querySelectorAll(i);for(var n=0;n<t.length;n++)popMagic.addEventToElement(t[n],e,o)}else{var r=popMagic.getTriggerClasses();popMagic.addEventToElement(document,e,function(e){r.some(function(o){return null!==e.target.closest(o)})||o.call(e.target,e)})}else{var a=popMagic.getTriggerClasses();for(t=document.querySelectorAll(a.join(", ")),n=0;n<t.length;n++)popMagic.addEventToElement(t[n],e,o)}else for(t=document.querySelectorAll("a"),n=0;n<t.length;n++)popMagic.addEventToElement(t[n],e,o)},setCookie:function(e,o,t){if(!this.config.cookieconsent)return!1;t=parseInt(t,10);var i=new Date;i.setMinutes(i.getMinutes()+parseInt(t));var n=encodeURIComponent(o)+"; expires="+i.toUTCString()+"; path=/";document.cookie=e+"="+n},getCookie:function(e){if(!this.config.cookieconsent)return!1;var o,t,i,n=document.cookie.split(";");for(o=0;o<n.length;o++)if(t=n[o].substr(0,n[o].indexOf("=")),i=n[o].substr(n[o].indexOf("=")+1),(t=t.replace(/^\s+|\s+$/g,""))===e)return decodeURIComponent(i)},randStr:function(e,o){for(var t="",i=o||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=i.charAt(Math.floor(Math.random()*i.length));return t},isValidUserEvent:function(e){return!(!("isTrusted"in e)||!e.isTrusted||"ie"===popMagic.browser.name||"safari"===popMagic.browser.name)||0!=e.screenX&&0!=e.screenY},isValidHref:function(e){if(void 0===e||""==e)return!1;return!/\s?javascript\s?:/i.test(e)},findLinkToOpen:function(e){var o=e,t=!1;try{for(var i=0;i<20&&!o.getAttribute("href")&&o!==document&&"html"!==o.nodeName.toLowerCase();)o=o.parentNode,i++;var n=o.getAttribute("target");n&&-1!==n.indexOf("_blank")||(t=o.getAttribute("href"))}catch(e){}return popMagic.isValidHref(t)||(t=!1),t||window.location.href},getPuId:function(){return"ok_"+Math.floor(89999999*Math.random()+1e7)},executeOnRedirect:function(){try{popMagic.config.capping_enabled||"function"!=typeof popMagic.config.on_redirect||popMagic.config.on_redirect()}catch(e){console.error("Error executing on redirect callback:",e)}},browserDetector:{browserDefinitions:[["firefox",/Firefox\/([0-9.]+)(?:\s|$)/],["opera",/Opera\/([0-9.]+)(?:\s|$)/],["opera",/OPR\/([0-9.]+)(:?\s|$)$/],["edge",/Edg(?:e|)\/([0-9._]+)/],["ie",/Trident\/7\.0.*rv:([0-9.]+)\).*Gecko$/],["ie",/MSIE\s([0-9.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["safari",/Version\/([0-9._]+).*Safari/],["chrome",/(?!Chrom.*Edg(?:e|))Chrom(?:e|ium)\/([0-9.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9.]+)(:?\s|$)/],["bb10",/BB10;\sTouch.*Version\/([0-9.]+)/],["android",/Android\s([0-9.]+)/],["ios",/Version\/([0-9._]+).*Mobile.*Safari.*/],["yandexbrowser",/YaBrowser\/([0-9._]+)/],["crios",/CriOS\/([0-9.]+)(:?\s|$)/]],isChromeOrChromium:function(){var e=window.navigator,o=(e.userAgent||"").toLowerCase(),t=e.vendor||"";if(-1!==o.indexOf("crios"))return!0;if(e.userAgentData&&Array.isArray(e.userAgentData.brands)&&e.userAgentData.brands.length>0){var i=e.userAgentData.brands,n=i.some(function(e){return"Google Chrome"===e.brand}),r=i.some(function(e){return"Chromium"===e.brand})&&2===i.length;return n||r}var a=!!window.chrome,c=-1!==o.indexOf("edg"),p=!!window.opr||-1!==o.indexOf("opr"),s=!(!e.brave||!e.brave.isBrave),g=-1!==o.indexOf("vivaldi"),l=-1!==o.indexOf("yabrowser"),d=-1!==o.indexOf("samsungbrowser"),u=-1!==o.indexOf("ucbrowser");return a&&"Google Inc."===t&&!c&&!p&&!s&&!g&&!l&&!d&&!u},getBrowserInfo:function(){var e=window.navigator.userAgent,o={name:"other",version:"1.0",versionNumber:1,isChrome:this.isChromeOrChromium(),isMobile:!!e.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile|WebOS|Windows Phone/i)};for(var t in this.browserDefinitions){var i=this.browserDefinitions[t];if(i[1].test(e)){var n=i[1].exec(e),r=n&&n[1].split(/[._]/).slice(0,3),a=Array.prototype.slice.call(r,1).join("")||"0";r&&r.length<3&&Array.prototype.push.apply(r,1===r.length?[0,0]:[0]),o.name=i[0],o.version=r.join("."),o.versionNumber=parseFloat(r[0]+"."+a);break}}return o}},methods:{default:function(e){if(!popMagic.shouldShow()||!popMagic.venorShouldShow()||!popMagic.isValidUserEvent(e))return!0;var o=e.target||e.srcElement,t=popMagic.findLinkToOpen(o);return window.open(t,"_blank"),popMagic.setAsOpened(e),popMagic.executeOnRedirect(),popMagic.top.document.location=popMagic.url,void 0!==e.preventDefault&&(e.preventDefault(),e.stopPropagation()),!0},chromeTab:function(e){if(!popMagic.shouldShow()||!popMagic.venorShouldShow()||!popMagic.isValidUserEvent(e))return!0;if(void 0===e.preventDefault)return!0;e.preventDefault(),e.stopPropagation();var o=top.window.document.createElement("a"),t=e.target||e.srcElement;o.href=popMagic.findLinkToOpen(t),document.getElementsByTagName("body")[0].appendChild(o);var i=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!0,altKey:!1,shiftKey:!1,metaKey:!0,button:0});i.preventDefault=void 0,o.dispatchEvent(i),o.parentNode.removeChild(o),popMagic.executeOnRedirect(),window.open(popMagic.url,"_self"),popMagic.setAsOpened(e)},popup:function(e){if(!popMagic.shouldShow()||!popMagic.venorShouldShow()||!popMagic.isValidUserEvent(e))return!0;var o="";if(popMagic.config.popup_fallback&&!popMagic.config.popup_force){var t=Math.max(Math.round(.8*window.innerHeight),300);o="menubar=1,resizable=1,width="+Math.max(Math.round(.7*window.innerWidth),300)+",height="+t+",top="+(window.screenY+100)+",left="+(window.screenX+100)}var i=document.location.href,n=window.open(i,popMagic.getPuId(),o);popMagic.setAsOpened(e),setTimeout(function(){n.location.href=popMagic.url,popMagic.executeOnRedirect()},200),void 0!==e.preventDefault&&(e.preventDefault(),e.stopPropagation())}}};    popMagic.init(adConfig);
})();


</script>

      <!-- SEO Meta Tags -->
<title>Free HD Porn Videos & XXX Streaming Online | Haitian Porn XXX</title>

<meta name="description"
content="Watch free HD porn videos online. Discover trending XXX videos updated daily with fast streaming and unlimited access.">

<meta name="keywords"
content="free porn, hd porn videos, xxx videos, sex videos, adult videos, porn tube, free sexvideo, online porn, streaming xxx">

<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1">

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Canonical URL -->
<link rel="canonical" href="https://www.haitianpornxxx.icu">

<!-- Open Graph (Facebook / WhatsApp / Telegram) -->
<meta property="og:type" content="website">
<meta property="og:title" content="Free HD Porn Videos - Watch XXX Online">
<meta property="og:description" content="Enjoy unlimited free HD porn videos with daily updates and fast streaming.">
<meta property="og:url" content="https://www.haitianpornxxx.icu">
<meta property="og:image" content="https://www.haitianpornxxx.icu/assets/preview.jpg">
<meta property="og:site_name" content="Haitian Porn XXX">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Free HD Porn Videos">
<meta name="twitter:description" content="Watch trending XXX videos online in HD quality.">
<meta name="twitter:image" content="https://www.haitianpornxxx.icu/assets/preview.jpg">
    <!-- Fluid Player -->
    <link rel="stylesheet" href="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.css">
    <script src="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-storage-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-analytics-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    
    <!-- Parse SDK -->
    <script src="https://npmcdn.com/parse/dist/parse.min.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- Stripe for Payments -->
    <script src="https://js.stripe.com/v3/"></script>
    
    <!-- PayPal SDK -->
    <script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD"></script>
    
    <!-- Ad Scripts -->
    <script async type="application/javascript" src="https://a.magsrv.com/ad-provider.js"></script>
    <script async type="application/javascript" src="https://a.pemsrv.com/ad-provider.js"></script>
    <script async type="application/javascript" src="https://a.pemsrv.com/ad-provider.js"></script> 
 <ins class="eas6a97888e33" data-zoneid="5834970"></ins> 
 <script>(AdProvider = window.AdProvider || []).push({"serve": {}});</script>

    <!-- IP Detection -->
    <script src="https://api.ipify.org?format=jsonp&callback=getIP"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary-blue: #0066FF;
            --primary-blue-dark: #0052CC;
            --primary-red: #FF3B30;
            --primary-red-dark: #DC3545;
            --neon-red: #ff0000;
            --neon-red-glow: rgba(255, 0, 0, 0.5);
            --bg-dark: #000000;
            --bg-surface: #121212;
            --bg-surface-light: #1E1E1E;
            --text-primary: #FFFFFF;
            --text-secondary: #AAAAAA;
            --text-muted: #6B6B6B;
            --border-color: #2A2A2A;
            --shadow: 0 2px 8px rgba(0,0,0,0.5);
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --safe-area-top: env(safe-area-inset-top);
            --safe-area-bottom: env(safe-area-inset-bottom);
            --header-height: 60px;
            --bottom-nav-height: 60px;
        }

        [data-theme="light"] {
            --bg-dark: #F5F5F5;
            --bg-surface: #FFFFFF;
            --bg-surface-light: #F0F0F0;
            --text-primary: #000000;
            --text-secondary: #4A4A4A;
            --text-muted: #8E8E8E;
            --border-color: #E0E0E0;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.4;
            font-size: 14px;
        }

        /* Header */
        .app-header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: var(--header-height);
            background: var(--bg-surface);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            z-index: 1000;
            border-bottom: 1px solid var(--border-color);
            padding-top: var(--safe-area-top);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-red));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 4px 10px rgba(0,102,255,0.3);
        }

        .logo-icon i {
            color: white;
            font-size: 22px;
            z-index: 2;
        }

        .logo-icon::after {
            content: 'HT';
            position: absolute;
            font-size: 8px;
            font-weight: bold;
            bottom: 2px;
            right: 2px;
            color: white;
            background: rgba(0,0,0,0.3);
            padding: 1px 2px;
            border-radius: 2px;
        }

        .logo-text {
            font-size: 20px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-red));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .icon-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-surface-light);
            border: none;
            color: var(--text-primary);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .icon-button:active {
            background: var(--primary-blue);
            transform: scale(0.95);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-red));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
            color: white;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .user-avatar:hover {
            border-color: var(--neon-red);
            box-shadow: 0 0 15px var(--neon-red-glow);
        }

        /* Verified Badge Animation */
        .verified-badge {
            display: inline-block;
            margin-left: 4px;
            animation: neonPulse 1.5s ease-in-out infinite;
        }

        .verified-badge i {
            color: var(--neon-red);
            font-size: 14px;
            filter: drop-shadow(0 0 5px var(--neon-red-glow));
        }

        @keyframes neonPulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.1);
                filter: drop-shadow(0 0 10px var(--neon-red));
            }
        }

        /* Search */
        .search-section {
            position: fixed;
            top: var(--header-height);
            left: 0;
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border-color);
            z-index: 999;
            transition: all 0.3s;
        }

        .search-container {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--bg-surface-light);
            border-radius: 24px;
            padding: 4px 12px;
        }

        .search-container i {
            color: var(--text-muted);
            font-size: 18px;
        }

        .search-container input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 16px;
            padding: 10px 0;
            outline: none;
        }

        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-surface);
            max-height: 400px;
            overflow-y: auto;
            display: none;
            border-bottom: 1px solid var(--border-color);
        }

        .search-suggestions.active {
            display: block;
        }

        .suggestion-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
        }

        .suggestion-item:active {
            background: var(--bg-surface-light);
        }

        /* Categories - Fixed, No Shaking */
        .categories-scroll {
            position: fixed;
            top: calc(var(--header-height) + 60px);
            left: 0;
            width: 100%;
            background: var(--bg-surface);
            padding: 8px 16px;
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            z-index: 90;
            border-bottom: 1px solid var(--border-color);
            scrollbar-width: none;
            will-change: transform;
            backface-visibility: hidden;
        }

        .categories-scroll::-webkit-scrollbar {
            display: none;
        }

        .category-chip {
            display: inline-block;
            padding: 8px 16px;
            margin-right: 8px;
            background: var(--bg-surface-light);
            border-radius: 20px;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
            border: 1px solid transparent;
        }

        .category-chip.active {
            background: var(--primary-blue);
            color: white;
            border-color: var(--neon-red);
            box-shadow: 0 0 10px rgba(255,0,0,0.3);
        }

        .category-chip:active {
            transform: scale(0.95);
        }

        /* Main Content */
        .main-content {
            margin-top: calc(var(--header-height) + 104px);
            margin-bottom: var(--bottom-nav-height);
            padding: 12px 16px;
        }

        /* Video Grid */
        .video-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
        }

        .video-card {
            background: var(--bg-surface);
            border-radius: var(--radius-md);
            overflow: hidden;
            cursor: pointer;
            border: 1px solid var(--border-color);
            transition: all 0.2s;
        }

        .video-card:active {
            transform: scale(0.98);
            border-color: var(--primary-blue);
        }

        .thumbnail {
            position: relative;
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
        }

        .thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .duration {
            position: absolute;
            bottom: 6px;
            right: 6px;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        .video-info {
            padding: 10px;
            display: flex;
            gap: 10px;
        }

        .channel-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-red));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            flex-shrink: 0;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .channel-avatar:hover {
            border-color: var(--neon-red);
        }

        .video-details {
            flex: 1;
        }

        .video-title {
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 4px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-meta {
            color: var(--text-muted);
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
            flex-wrap: wrap;
        }

        /* Shorts Grid */
        .shorts-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin: 16px 0;
        }

        .short-card {
            aspect-ratio: 9/16;
            background: var(--bg-surface);
            border-radius: var(--radius-sm);
            overflow: hidden;
            position: relative;
            cursor: pointer;
            border: 1px solid var(--border-color);
        }

        .short-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .short-title {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 8px;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
            color: white;
            font-size: 11px;
            font-weight: 600;
        }

        /* Video Player Page */
        .page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-dark);
            z-index: 2000;
            overflow-y: auto;
            display: none;
            padding-top: var(--safe-area-top);
        }

        .page-header {
            position: sticky;
            top: 0;
            background: var(--bg-surface);
            padding: 8px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 10;
            border-bottom: 1px solid var(--border-color);
        }

        .page-header button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-surface-light);
            border: none;
            color: var(--text-primary);
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .page-header button:active {
            background: var(--primary-blue);
        }

        .page-title {
            flex: 1;
            font-weight: 700;
            font-size: 16px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-container {
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
        }

        #fluid-player {
            width: 100%;
            height: 100%;
        }

        /* Ad Containers */
        .ad-container-banner {
            width: 100%;
            min-height: 90px;
            background: var(--bg-surface);
            margin: 8px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
        }

        .ad-container-interstitial {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        /* Engagement Bar */
        .engagement-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border-color);
        }

        .engagement-left {
            display: flex;
            gap: 24px;
        }

        .engagement-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .engagement-btn i {
            font-size: 22px;
        }

        .engagement-btn:active {
            transform: scale(0.9);
        }

        .engagement-btn.active i {
            color: var(--primary-blue);
        }

        .engagement-right {
            display: flex;
            gap: 20px;
        }

        /* Channel Info */
        .channel-info {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border-color);
        }

        .channel-details {
            flex: 1;
        }

        .channel-name {
            font-weight: 700;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .channel-stats {
            color: var(--text-muted);
            font-size: 12px;
        }

        .subscribe-btn {
            padding: 8px 20px;
            background: var(--primary-red);
            border: none;
            border-radius: 20px;
            color: white;
            font-weight: 700;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .subscribe-btn:active {
            transform: scale(0.95);
            background: var(--primary-red-dark);
        }

        .subscribe-btn.subscribed {
            background: var(--bg-surface-light);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        /* Description */
        .video-description {
            padding: 12px 16px;
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border-color);
        }

        .description-stats {
            display: flex;
            gap: 12px;
            margin-bottom: 8px;
            color: var(--text-muted);
            font-size: 12px;
        }

        .description-text {
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.6;
            max-height: 60px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .description-text.expanded {
            max-height: 500px;
        }

        .show-more {
            color: var(--text-muted);
            font-size: 12px;
            margin-top: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        /* Comments */
        .comments-section {
            padding: 12px 16px;
            background: var(--bg-surface);
            margin-top: 8px;
        }

        .comments-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .comments-title {
            font-weight: 700;
            font-size: 15px;
        }

        .sort-selector {
            display: flex;
            align-items: center;
            gap: 4px;
            color: var(--text-secondary);
            font-size: 13px;
            cursor: pointer;
        }

        .add-comment {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        .comment-input-wrapper {
            flex: 1;
            display: flex;
            gap: 8px;
        }

        .comment-input {
            flex: 1;
            background: var(--bg-surface-light);
            border: 1px solid var(--border-color);
            border-radius: 24px;
            padding: 10px 16px;
            color: var(--text-primary);
            font-size: 13px;
            outline: none;
        }

        .comment-input:focus {
            border-color: var(--primary-blue);
        }

        .comment-submit {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-blue);
            border: none;
            color: white;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .comment-submit:active {
            transform: scale(0.9);
        }

        .comment-item {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }

        .comment-content {
            flex: 1;
        }

        .comment-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 4px;
            flex-wrap: wrap;
        }

        .comment-author {
            font-weight: 700;
            font-size: 13px;
        }

        .comment-time {
            color: var(--text-muted);
            font-size: 11px;
        }

        .comment-text {
            color: var(--text-secondary);
            font-size: 13px;
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .comment-actions {
            display: flex;
            gap: 20px;
        }

        .comment-action {
            display: flex;
            align-items: center;
            gap: 4px;
            color: var(--text-muted);
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .comment-action:active {
            color: var(--primary-blue);
        }

        .replies {
            margin-left: 45px;
            margin-top: 12px;
        }

        .reply-item {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
        }

        /* Recommended */
        .recommended-section {
            padding: 12px 16px;
            background: var(--bg-surface);
            margin-top: 8px;
        }

        .recommended-title {
            font-weight: 700;
            font-size: 15px;
            margin-bottom: 16px;
        }

        .recommended-item {
            display: flex;
            gap: 12px;
            margin-bottom: 16px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .recommended-item:active {
            opacity: 0.8;
            transform: translateX(5px);
        }

        .recommended-thumb {
            width: 120px;
            aspect-ratio: 16/9;
            background: #000;
            border-radius: var(--radius-sm);
            overflow: hidden;
            flex-shrink: 0;
        }

        .recommended-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .recommended-info {
            flex: 1;
        }

        .recommended-info h4 {
            font-weight: 700;
            font-size: 13px;
            margin-bottom: 4px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .recommended-info p {
            color: var(--text-muted);
            font-size: 11px;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: var(--bottom-nav-height);
            background: var(--bg-surface);
            display: flex;
            align-items: center;
            justify-content: space-around;
            border-top: 1px solid var(--border-color);
            padding-bottom: var(--safe-area-bottom);
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
            color: var(--text-muted);
            font-size: 11px;
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px 0;
            flex: 1;
            transition: all 0.2s;
        }

        .nav-item i {
            font-size: 22px;
        }

        .nav-item.active {
            color: var(--primary-blue);
        }

        .nav-item:active {
            transform: scale(0.9);
        }

        /* Channel Page */
        .channel-header {
            padding: 20px;
            background: var(--bg-surface);
            margin-bottom: 8px;
        }

        .channel-cover {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .channel-large-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-red));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 800;
            color: white;
            border: 3px solid transparent;
            transition: all 0.2s;
        }

        .channel-large-avatar:hover {
            border-color: var(--neon-red);
        }

        .channel-info h1 {
            font-size: 20px;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .channel-info p {
            color: var(--text-muted);
            font-size: 12px;
            margin-bottom: 2px;
        }

        .channel-stats-row {
            display: flex;
            gap: 12px;
            color: var(--text-muted);
            font-size: 12px;
        }

        .channel-tabs {
            display: flex;
            gap: 20px;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 12px;
            padding: 0 16px;
        }

        .channel-tab {
            padding: 12px 0;
            color: var(--text-muted);
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .channel-tab.active {
            color: var(--primary-blue);
            border-bottom: 2px solid var(--primary-blue);
        }

        .channel-link-btn {
            background: var(--bg-surface-light);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            margin-top: 8px;
            transition: all 0.2s;
        }

        .channel-link-btn:active {
            background: var(--primary-blue);
            color: white;
        }

        /* Library Page */
        .library-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            padding: 16px;
        }

        .library-item {
            background: var(--bg-surface);
            border-radius: var(--radius-md);
            padding: 20px;
            text-align: center;
            cursor: pointer;
            border: 1px solid var(--border-color);
            transition: all 0.2s;
        }

        .library-item:active {
            transform: scale(0.95);
            border-color: var(--primary-blue);
        }

        .library-item i {
            font-size: 32px;
            color: var(--primary-blue);
            margin-bottom: 8px;
        }

        .library-item span {
            font-size: 14px;
            font-weight: 600;
        }

        .library-item p {
            color: var(--text-muted);
            font-size: 11px;
            margin-top: 4px;
        }

        /* Wallet Page */
        .wallet-header {
            background: var(--bg-surface);
            padding: 24px;
            margin-bottom: 8px;
            text-align: center;
        }

        .wallet-balance {
            font-size: 48px;
            font-weight: 800;
            margin-bottom: 8px;
            color: var(--primary-blue);
        }

        .wallet-actions {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .wallet-btn {
            padding: 10px 24px;
            border-radius: 24px;
            border: none;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .wallet-btn:active {
            transform: scale(0.95);
        }

        .withdraw-btn {
            background: var(--primary-blue);
            color: white;
        }

        .deposit-btn {
            background: var(--bg-surface-light);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border-color);
        }

        .transaction-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .transaction-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-surface-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-blue);
        }

        .transaction-details h4 {
            font-size: 13px;
            font-weight: 600;
        }

        .transaction-details p {
            color: var(--text-muted);
            font-size: 11px;
        }

        .transaction-amount {
            font-weight: 700;
            font-size: 14px;
        }

        .transaction-amount.positive {
            color: #4CAF50;
        }

        .transaction-amount.negative {
            color: var(--primary-red);
        }

        /* Creator Studio - Enhanced */
        .studio-header {
            padding: 20px;
            background: var(--bg-surface);
            margin-bottom: 8px;
        }

        .studio-stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 16px;
        }

        .studio-stat-card {
            background: var(--bg-surface);
            padding: 20px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
        }

        .studio-stat-card h3 {
            color: var(--text-muted);
            font-size: 11px;
            margin-bottom: 4px;
        }

        .studio-stat-card .value {
            font-size: 28px;
            font-weight: 800;
            color: var(--primary-blue);
        }

        .studio-stat-card .label {
            color: var(--text-muted);
            font-size: 11px;
            margin-top: 4px;
        }

        .studio-section {
            background: var(--bg-surface);
            margin: 12px 16px;
            padding: 16px;
            border-radius: var(--radius-md);
            border: 1px solid var(--border-color);
        }

        .studio-section-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .studio-section-title i {
            color: var(--primary-blue);
        }

        .studio-form-group {
            margin-bottom: 16px;
        }

        .studio-form-group label {
            display: block;
            color: var(--text-muted);
            font-size: 12px;
            margin-bottom: 4px;
        }

        .studio-form-group small {
            display: block;
            color: var(--text-muted);
            font-size: 10px;
            margin-top: 4px;
        }

        .studio-input {
            width: 100%;
            padding: 12px;
            background: var(--bg-surface-light);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 14px;
        }

        .studio-input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .studio-select {
            width: 100%;
            padding: 12px;
            background: var(--bg-surface-light);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 14px;
        }

        .studio-button {
            padding: 12px 24px;
            background: var(--primary-blue);
            border: none;
            border-radius: 24px;
            color: white;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .studio-button:active {
            transform: scale(0.95);
        }

        .studio-button.secondary {
            background: var(--bg-surface-light);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .studio-button.danger {
            background: var(--primary-red);
        }

        .last-updated-badge {
            display: inline-block;
            padding: 4px 8px;
            background: var(--bg-surface-light);
            border-radius: 12px;
            color: var(--text-muted);
            font-size: 10px;
            margin-left: 8px;
        }

        /* Video Management */
        .video-management-item {
            display: flex;
            gap: 12px;
            padding: 16px;
            background: var(--bg-surface);
            border-radius: var(--radius-md);
            margin-bottom: 12px;
            border: 1px solid var(--border-color);
        }

        .management-thumb {
            width: 100px;
            aspect-ratio: 16/9;
            border-radius: var(--radius-sm);
            overflow: hidden;
        }

        .management-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .management-info {
            flex: 1;
        }

        .management-title {
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .management-stats {
            color: var(--text-muted);
            font-size: 11px;
            margin-bottom: 8px;
        }

        .management-meta {
            display: flex;
            gap: 12px;
            color: var(--text-muted);
            font-size: 10px;
            margin-bottom: 8px;
        }

        .management-actions {
            display: flex;
            gap: 8px;
        }

        .management-btn {
            padding: 6px 12px;
            border-radius: 16px;
            border: none;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .management-btn:active {
            transform: scale(0.95);
        }

        .edit-btn {
            background: var(--primary-blue);
            color: white;
        }

        .delete-btn {
            background: var(--primary-red);
            color: white;
        }

        .analytics-btn {
            background: var(--bg-surface-light);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        /* Country Earnings */
        .country-earnings-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .country-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .country-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .country-flag {
            width: 30px;
            height: 20px;
            background: var(--bg-surface-light);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .country-details h4 {
            font-size: 13px;
            font-weight: 600;
        }

        .country-details p {
            color: var(--text-muted);
            font-size: 10px;
        }

        .country-earnings-value {
            font-weight: 700;
            font-size: 14px;
            color: #4CAF50;
        }

        .country-cpm {
            color: var(--text-muted);
            font-size: 10px;
            margin-left: 4px;
        }

        /* Share Modal */
        .share-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.98);
            display: none;
            z-index: 3000;
            padding: 20px;
            overflow-y: auto;
        }

        .share-container {
            background: var(--bg-surface);
            border-radius: var(--radius-lg);
            padding: 24px;
            max-width: 400px;
            margin: auto;
            border: 1px solid var(--border-color);
        }

        .share-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .share-header h3 {
            font-size: 18px;
            font-weight: 700;
        }

        .share-link-container {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .share-link-input {
            flex: 1;
            padding: 12px;
            background: var(--bg-surface-light);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 12px;
        }

        .copy-btn {
            padding: 12px 20px;
            background: var(--primary-blue);
            border: none;
            border-radius: var(--radius-sm);
            color: white;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
        }

        .embed-code {
            background: var(--bg-surface-light);
            padding: 12px;
            border-radius: var(--radius-sm);
            margin-bottom: 20px;
            font-size: 11px;
            word-break: break-all;
            border: 1px solid var(--border-color);
        }

        .share-platforms {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }

        .share-platform {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 16px 8px;
            background: var(--bg-surface-light);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .share-platform:active {
            background: var(--primary-blue);
            transform: scale(0.95);
        }

        .share-platform i {
            font-size: 24px;
        }

        .share-platform span {
            font-size: 10px;
        }

        /* Age Verification - Shows on every refresh */
        .age-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.98);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 5000;
            padding: 20px;
        }

        .age-card {
            background: var(--bg-surface);
            border-radius: var(--radius-lg);
            padding: 32px;
            text-align: center;
            max-width: 350px;
            border: 2px solid var(--primary-red);
            box-shadow: 0 0 30px rgba(255,0,0,0.3);
        }

        .age-card i {
            font-size: 60px;
            color: var(--primary-red);
            margin-bottom: 16px;
        }

        .age-card h2 {
            font-size: 24px;
            margin-bottom: 8px;
            font-weight: 800;
        }

        .age-card p {
            color: var(--text-muted);
            font-size: 13px;
            margin-bottom: 24px;
        }

        .age-buttons {
            display: flex;
            gap: 12px;
        }

        .age-btn {
            flex: 1;
            padding: 14px;
            border-radius: var(--radius-md);
            font-weight: 700;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .age-btn:active {
            transform: scale(0.95);
        }

        .age-btn.confirm {
            background: var(--primary-blue);
            color: white;
            border: none;
        }

        .age-btn.deny {
            background: var(--bg-surface-light);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        /* Payment Modals */
        .payment-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.98);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 7000;
            padding: 20px;
        }

        .payment-card {
            background: var(--bg-surface);
            border-radius: var(--radius-lg);
            padding: 28px;
            max-width: 400px;
            width: 100%;
            border: 1px solid var(--border-color);
        }

        .payment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .payment-header h3 {
            font-size: 20px;
            font-weight: 700;
        }

        .payment-methods {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }

        .payment-method {
            flex: 1;
            padding: 16px;
            background: var(--bg-surface-light);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .payment-method.active {
            border-color: var(--primary-blue);
            background: var(--primary-blue);
            color: white;
        }

        .payment-method i {
            font-size: 28px;
            margin-bottom: 4px;
        }

        .payment-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 24px;
        }

        .payment-input {
            padding: 14px;
            background: var(--bg-surface-light);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 14px;
        }

        .payment-input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .bank-details {
            background: var(--bg-surface-light);
            padding: 20px;
            border-radius: var(--radius-md);
            margin-bottom: 24px;
        }

        .bank-details h4 {
            margin-bottom: 12px;
            color: var(--text-secondary);
        }

        .bank-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .bank-row span:first-child {
            color: var(--text-muted);
        }

        /* Modals */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.98);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 4000;
            padding: 20px;
        }

        .modal-content {
            background: var(--bg-surface);
            border-radius: var(--radius-lg);
            padding: 24px;
            width: 100%;
            max-width: 400px;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h3 {
            font-size: 18px;
            font-weight: 700;
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 24px;
            cursor: pointer;
        }

        .auth-tabs {
            display: flex;
            gap: 8px;
            background: var(--bg-surface-light);
            padding: 4px;
            border-radius: 30px;
            margin-bottom: 20px;
        }

        .auth-tab {
            flex: 1;
            padding: 10px;
            background: none;
            border: none;
            border-radius: 30px;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .auth-tab.active {
            background: var(--primary-blue);
            color: white;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .form-input {
            padding: 14px;
            background: var(--bg-surface-light);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            color: var(--text-primary);
            font-size: 14px;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .auth-button {
            padding: 14px;
            background: var(--primary-blue);
            border: none;
            border-radius: var(--radius-sm);
            color: white;
            font-weight: 700;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .auth-button:active {
            transform: scale(0.98);
        }

        .logout-btn {
            background: var(--primary-red);
        }

        .delete-account-btn {
            background: transparent;
            border: 2px solid var(--primary-red);
            color: var(--primary-red);
        }

        /* Upload */
        .upload-dropzone {
            border: 2px dashed var(--border-color);
            border-radius: var(--radius-md);
            padding: 32px 16px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .upload-dropzone.dragover {
            border-color: var(--primary-blue);
            background: rgba(0,102,255,0.1);
        }

        .upload-dropzone i {
            font-size: 48px;
            color: var(--primary-blue);
            margin-bottom: 8px;
        }

        .upload-dropzone h4 {
            font-size: 16px;
            margin-bottom: 4px;
        }

        .upload-dropzone p {
            color: var(--text-muted);
            font-size: 11px;
        }

        .thumbnail-options {
            display: flex;
            gap: 8px;
            margin: 16px 0;
        }

        .thumbnail-option {
            flex: 1;
            padding: 10px;
            background: var(--bg-surface-light);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            font-size: 11px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }

        .thumbnail-option.active {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .thumbnail-preview {
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
            border-radius: var(--radius-sm);
            margin-bottom: 16px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .thumbnail-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .upload-progress {
            margin: 16px 0;
            display: none;
        }

        .progress-bar {
            height: 8px;
            background: var(--bg-surface-light);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-blue), var(--primary-red));
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            font-size: 11px;
            color: var(--text-muted);
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 80px;
            left: 16px;
            right: 16px;
            background: var(--bg-surface-light);
            color: var(--text-primary);
            padding: 14px 20px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            gap: 12px;
            z-index: 6000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success {
            border-left: 4px solid #4CAF50;
        }

        .toast.error {
            border-left: 4px solid var(--primary-red);
        }

        .toast.info {
            border-left: 4px solid var(--primary-blue);
        }

        /* Loading */
        .loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px;
            color: var(--text-muted);
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-color);
            border-top-color: var(--primary-blue);
            border-right-color: var(--primary-red);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 12px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Dark Mode Toggle */
        .theme-toggle {
            position: fixed;
            bottom: 80px;
            right: 16px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-red));
            color: white;
            border: none;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: all 0.2s;
        }

        .theme-toggle:active {
            transform: scale(0.9);
        }

        /* Copyright Detection */
        .copyright-warning {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.98);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .copyright-card {
            background: var(--bg-surface);
            border-radius: var(--radius-lg);
            padding: 32px;
            text-align: center;
            max-width: 400px;
            border: 2px solid var(--primary-red);
        }

        .copyright-card i {
            font-size: 48px;
            color: var(--primary-red);
            margin-bottom: 16px;
        }

        .copyright-card h2 {
            font-size: 20px;
            margin-bottom: 8px;
        }

        .copyright-card p {
            color: var(--text-muted);
            font-size: 13px;
            margin-bottom: 20px;
        }

        /* Responsive */
        @media (min-width: 768px) {
            .video-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .video-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Age Verification Modal - Shows on every refresh -->
    <div class="age-modal" id="ageModal">
        <div class="age-card">
            <i class="fas fa-exclamation-triangle"></i>
        <h2>Age Verification</h2>
<p>
This website contains adult material. By entering, you confirm that you are
at least 18 years old (or the legal age in your country) and that you wish
to view adult content. If you are not of legal age, please leave this site now.
</p>
            <div class="age-buttons">
                <button class="age-btn confirm" id="confirmAge">I am 18+</button>
                <button class="age-btn deny" id="denyAge">I am under 18</button>
            </div>
        </div>
    </div>

    <!-- Copyright Detection Modal -->
    <div class="copyright-warning" id="copyrightModal">
        <div class="copyright-card">
            <i class="fas fa-copyright"></i>
            <h2>Copyright Detection</h2>
            <p id="copyrightMessage">This content appears to be from another platform. Original content only.</p>
            <button class="auth-button" id="closeCopyright">OK</button>
        </div>
    </div>

    <!-- Header -->
    <header class="app-header">
        <div class="logo" id="homeBtn">
            <div class="logo-icon">
                <i class="fas fa-play"></i>
            </div>
            <span class="logo-text">HaitianTube</span>
        </div>
        
        <div class="header-actions">
            <button class="icon-button" id="searchToggle">
                <i class="fas fa-search"></i>
            </button>
            <button class="icon-button" id="uploadBtn">
                <i class="fas fa-upload"></i>
            </button>
            <div class="user-avatar" id="avatarBtn">
                <span id="avatarInitial">G</span>
            </div>
        </div>
    </header>

    <!-- Search Section -->
    <div class="search-section" id="searchSection" style="display: none;">
        <div class="search-container">
            <i class="fas fa-search"></i>
            <input type="text" placeholder="Discover videos & models" id="searchInput">
            <button class="icon-button" id="clearSearch" style="display: none;">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="search-suggestions" id="searchSuggestions"></div>
    </div>

    <!-- Categories - Fixed, No Shaking -->
    <div class="categories-scroll" id="categories">
        <span class="category-chip active" data-category="all">All</span>
        <span class="category-chip" data-category="shorts">Shorts</span>
        <span class="category-chip" data-category="amateur">amateur</span>
        <span class="category-chip" data-category="Couples">Couples</span>
        <span class="category-chip" data-category="solo"></span>
        <span class="category-chip" data-category="Exclusive">Exclusive</span>
        <span class="category-chip" data-category="live">Live Cams</span>
        <span class="category-chip" data-category="trending">Trending</span>
        <span class="category-chip" data-category="HD video">HD video</span>
        <span class="category-chip" data-category="Premium">premium</span>
        <span class="category-chip" data-category="verified">verified creators</span>
        <span class="category-chip" data-category="18plus">18+ only</span>
        <span class="category-chip" data-category="hot">Hot</span>
<span class="category-chip" data-category="sensual">Sensual</span>
<span class="category-chip" data-category="lingerie">Lingerie</span>
<span class="category-chip" data-category="models">Models</span>
<span class="category-chip" data-category="couples">Couples</span>
<span class="category-chip" data-category="romance">Romance</span>
<span class="category-chip" data-category="fantasy">Fantasy</span>
<span class="category-chip" data-category="cosplay">Cosplay</span>
<span class="category-chip" data-category="amateur">Amateur</span>
<span class="category-chip" data-category="trending">Trending</span>
</div> 


<!-- Main Content -->
<main class="main-content" id="mainContent">

    <!-- Banner Ad -->
    <div class="ad-container-banner">

        <!-- Your Banner -->
        <a href="https://t.mbjms.com/387067/3785/0?bo=Array&target=banners&file_id=554082&po=6456&aff_sub5=SF_006OG000004lmDN&aff_sub4=AT_0002"
           target="_blank" rel="noopener noreferrer">
            <img src="https://www.imglnkx.com/3785/010766A_GDAT_18_ALL_EN_71_L.gif"
                 alt="Advertisement Banner"
                 style="max-width:100%; height:auto; border:0;">
        </a>

        <!-- AdProvider Banner -->
        <ins class="eas6a97888e31" data-zoneid="5830152"></ins>
        <script>
            (AdProvider = window.AdProvider || []).push({"serve": {}});
        </script>

    </div>


        <div class="loading" id="loadingState">
            <div class="spinner"></div>
            <p> Please wait adults only </p>
        </div>
        
        <div class="video-grid" id="videoGrid"></div>
        
        <div class="shorts-section" id="shortsSection" style="display: none;">
            <h3 style="margin: 16px 0; font-size: 18px;">Shorts</h3>
            <div class="shorts-grid" id="shortsGrid"></div>
        </div>
        
        <!-- Video Slider Ads -->
        <script async type="application/javascript" src="https://a.magsrv.com/ad-provider.js"></script> 
        <ins class="eas6a97888e31" data-zoneid="5830152"></ins> 
        <script>(AdProvider = window.AdProvider || []).push({"serve": {}});</script>
        
        <div id="noVideos" style="display: none; text-align: center; padding: 40px;">
            <i class="fas fa-video-slash" style="font-size: 48px; color: var(--text-muted); margin-bottom: 12px;"></i>
            <h3 style="font-size: 18px;">No Videos Found</h3>
            <p style="color: var(--text-muted); font-size: 13px; margin: 8px 0;">Be the first to upload original content!</p>
            <button class="auth-button" id="uploadFirstBtn" style="margin-top: 16px;">Upload Video</button>
        </div>
    </main>

    <!-- Video Player Page -->
    <div class="page" id="videoPlayerPage">
        <div class="page-header">
            <button id="closePlayer"><i class="fas fa-arrow-left"></i></button>
            <div class="page-title" id="playerVideoTitle"></div>
        </div>
        
        <div class="player-container">
            <div id="fluid-player"></div>
        </div>
        
        <div class="engagement-bar">
            <div class="engagement-left">
                <button class="engagement-btn" id="likeBtn">
                    <i class="far fa-thumbs-up"></i>
                    <span id="likeCount">0</span>
                </button>
                <button class="engagement-btn" id="dislikeBtn">
                    <i class="far fa-thumbs-down"></i>
                    <span id="dislikeCount">0</span>
                </button>
            </div>
            <div class="engagement-right">
                <button class="engagement-btn" id="shareBtn">
                    <i class="fas fa-share"></i>
                </button>
                <button class="engagement-btn" id="saveBtn">
                    <i class="far fa-bookmark"></i>
                </button>
            </div>
        </div>
        
        <div class="channel-info">
            <div class="channel-avatar" id="playerChannelAvatar" onclick="window.openChannelFromPlayer()">C</div>
            <div class="channel-details">
                <div class="channel-name">
                    <span id="playerChannelName" onclick="window.openChannelFromPlayer()">Channel Name</span>
                    <span class="verified-badge" id="verifiedBadge" style="display: none;">
                        <i class="fas fa-check-circle"></i>
                    </span>
                </div>
                <div class="channel-stats">
                    <span id="playerSubscribers">0</span> subscribers  
                    <span id="playerVideoCount">0</span> videos
                </div>
            </div>
            <button class="subscribe-btn" id="subscribeBtn">Subscribe</button>
        </div>
        
        <div class="video-description">
            <div class="description-stats">
                <span id="playerViews">0 views</span>
                <span id="playerDate"></span>
            </div>
            <div class="description-text" id="playerDescription"></div>
            <div class="show-more" id="showMoreDesc">Show more</div>
        </div>
        
        <!-- Mid-roll Ad Container -->
        <div class="ad-container-banner" id="midRollAd" style="display: none;"></div>
        
        <div class="comments-section">
            <div class="comments-header">
                <span class="comments-title" id="commentCount">0 Comments</span>
                <div class="sort-selector" id="sortComments">
                    <i class="fas fa-sort"></i>
                    <span>Top</span>
                </div>
            </div>
            
            <div class="add-comment">
                <div class="channel-avatar" id="commentAvatar">Y</div>
                <div class="comment-input-wrapper">
                    <input type="text" class="comment-input" placeholder="Add a comment..." id="commentInput">
                    <button class="comment-submit" id="submitComment">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
            
            <div id="commentsList"></div>
        </div>
        
        <div class="recommended-section">
            <div class="recommended-title">Recommended Videos</div>
            <div id="recommendedList"></div>
        </div>
    </div>

    <!-- Channel Page -->
    <div class="page" id="channelPage">
        <div class="page-header">
            <button id="closeChannel"><i class="fas fa-arrow-left"></i></button>
            <div class="page-title" id="channelPageTitle">Channel</div>
            <button class="icon-button" id="shareChannelBtn">
                <i class="fas fa-share-alt"></i>
            </button>
        </div>
        
        <div class="channel-header">
            <div class="channel-cover">
                <div class="channel-large-avatar" id="channelLargeAvatar">C</div>
                <div class="channel-info">
                    <h1 id="channelPageName">
                        Channel Name
                        <span class="verified-badge" id="channelVerifiedBadge" style="display: none;">
                            <i class="fas fa-check-circle"></i>
                        </span>
                    </h1>
                    <p id="channelPageSubscribers">0 subscribers</p>
                    <div class="channel-stats-row">
                        <span id="channelPageVideos">0 videos</span>
                        <span id="channelPageViews">0 views</span>
                    </div>
                    <button class="channel-link-btn" id="copyChannelLink">
                        <i class="fas fa-link"></i> Copy Channel Link
                    </button>
                </div>
            </div>
        </div>
        
        <div class="channel-tabs">
            <span class="channel-tab active" data-tab="videos">Videos</span>
            <span class="channel-tab" data-tab="shorts">Shorts</span>
            <span class="channel-tab" data-tab="playlists">Playlists</span>
            <span class="channel-tab" data-tab="about">About</span>
        </div>
        
        <div id="channelVideos" class="video-grid"></div>
        <div id="channelShorts" class="shorts-grid" style="display: none; padding: 12px;"></div>
        <div id="channelAbout" style="display: none; padding: 20px;">
            <p style="color: var(--text-secondary); line-height: 1.6;" id="channelDescription">No description available.</p>
            <p style="color: var(--text-muted); margin-top: 12px;" id="channelJoined">Joined: </p>
            <p style="color: var(--text-muted); margin-top: 4px;" id="channelLastUpdated">Last name change: </p>
        </div>
    </div>

    <!-- Creator Studio Page - Enhanced -->
    <div class="page" id="studioPage">
        <div class="page-header">
            <button id="closeStudio"><i class="fas fa-arrow-left"></i></button>
            <div class="page-title">Creator Studio</div>
        </div>
        
        <div class="studio-header">
            <div style="display: flex; gap: 20px; align-items: center;">
                <div class="channel-large-avatar" id="studioAvatar" onclick="document.getElementById('avatarUpload').click()">C</div>
                <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
                <div>
                    <h2 id="studioName">Channel Name</h2>
                    <p style="color: var(--text-muted); font-size: 12px;" id="studioLevel">Creator Level: Basic</p>
                    <p style="color: var(--text-muted); font-size: 10px;" id="studioLastUpdate">Last name change: Available now</p>
                </div>
            </div>
        </div>
        
        <div class="channel-tabs" style="padding: 0 16px;">
            <span class="channel-tab active" data-studio="dashboard">Dashboard</span>
            <span class="channel-tab" data-studio="videos">Videos</span>
            <span class="channel-tab" data-studio="analytics">Analytics</span>
            <span class="channel-tab" data-studio="wallet">Wallet</span>
            <span class="channel-tab" data-studio="settings">Settings</span>
        </div>
        
        <!-- Dashboard Tab -->
        <div id="studioDashboard">
            <div class="studio-stats-grid">
                <div class="studio-stat-card">
                    <h3>Total Views</h3>
                    <div class="value" id="studioTotalViews">0</div>
                    <div class="label">Lifetime</div>
                </div>
                <div class="studio-stat-card">
                    <h3>Subscribers</h3>
                    <div class="value" id="studioTotalSubs">0</div>
                    <div class="label">Total</div>
                </div>
                <div class="studio-stat-card">
                    <h3>Watch Hours</h3>
                    <div class="value" id="studioWatchHours">0</div>
                    <div class="label">Last 28 days</div>
                </div>
                <div class="studio-stat-card">
                    <h3>Balance</h3>
                    <div class="value" id="studioBalance">$0</div>
                    <div class="label">Available</div>
                </div>
            </div>
            
            <div class="studio-section">
                <div class="studio-section-title">
                    <i class="fas fa-chart-line"></i>
                    <span>Performance Overview</span>
                </div>
                <canvas id="studioChart" style="height: 250px;"></canvas>
            </div>
            
            <div class="studio-section">
                <div class="studio-section-title">
                    <i class="fas fa-dollar-sign"></i>
                    <span>Earnings by Country</span>
                </div>
                <div class="country-earnings-list" id="countryEarnings"></div>
            </div>
        </div>
        
        <!-- Videos Tab -->
        <div id="studioVideos" style="display: none; padding: 12px;">
            <button class="auth-button" id="studioUploadBtn" style="margin-bottom: 16px; width: 100%;">
                <i class="fas fa-upload"></i> Upload New Video
            </button>
            <div id="studioVideosList"></div>
        </div>
        
        <!-- Analytics Tab -->
        <div id="studioAnalytics" style="display: none; padding: 12px;">
            <div class="studio-section">
                <div class="studio-section-title">
                    <i class="fas fa-chart-bar"></i>
                    <span>Real-Time Analytics</span>
                </div>
                <div class="studio-stats-grid">
                    <div class="studio-stat-card">
                        <h3>Views (Today)</h3>
                        <div class="value" id="analyticsTodayViews">0</div>
                    </div>
                    <div class="studio-stat-card">
                        <h3>Watch Time</h3>
                        <div class="value" id="analyticsWatchTime">0h</div>
                    </div>
                    <div class="studio-stat-card">
                        <h3>Est. Revenue</h3>
                        <div class="value" id="analyticsRevenue">$0</div>
                    </div>
                    <div class="studio-stat-card">
                        <h3>CPM Avg</h3>
                        <div class="value" id="analyticsCPM">$0</div>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <h4 style="margin-bottom: 12px;">Top Countries by Revenue</h4>
                    <div id="topCountriesList"></div>
                </div>
                
                <div style="margin-top: 20px;">
                    <h4 style="margin-bottom: 12px;">Traffic Sources</h4>
                    <canvas id="trafficChart" style="height: 200px;"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Wallet Tab -->
        <div id="studioWallet" style="display: none;">
            <div class="wallet-header">
                <div class="wallet-balance" id="walletMainBalance">$0.00</div>
                <p style="color: var(--text-muted); font-size: 12px;">Available Balance</p>
                <div class="wallet-actions">
                    <button class="wallet-btn withdraw-btn" id="withdrawBtn">Withdraw</button>
                    <button class="wallet-btn deposit-btn" id="depositBtn">Deposit</button>
                </div>
            </div>
            
            <div style="padding: 12px;">
                <h4 style="margin-bottom: 12px; font-size: 14px;">Transaction History</h4>
                <div id="transactionHistory"></div>
            </div>
            
            <div style="padding: 12px;">
                <h4 style="margin-bottom: 12px; font-size: 14px;">Earnings by Country</h4>
                <div id="walletCountryEarnings"></div>
            </div>
            
            <div style="padding: 12px;">
                <h4 style="margin-bottom: 12px; font-size: 14px;">Payment Methods</h4>
                <div class="studio-section">
                    <div class="studio-form-group">
                        <label>PayPal Email</label>
                        <input type="email" class="studio-input" id="walletPaypalEmail" placeholder="Enter PayPal email">
                    </div>
                    <div class="studio-form-group">
                        <label>Bank Account Number</label>
                        <input type="text" class="studio-input" id="walletBankAccount" placeholder="Enter bank account">
                    </div>
                    <div class="studio-form-group">
                        <label>Routing Number</label>
                        <input type="text" class="studio-input" id="walletRoutingNumber" placeholder="Enter routing number">
                    </div>
                    <div class="studio-form-group">
                        <label>Account Holder Name</label>
                        <input type="text" class="studio-input" id="walletAccountHolder" placeholder="Enter account holder name">
                    </div>
                    <button class="studio-button" id="saveWalletPaymentBtn">Save Payment Details</button>
                </div>
            </div>
        </div>
        
        <!-- Settings Tab - Enhanced -->
        <div id="studioSettings" style="display: none; padding: 16px;">
            <div class="studio-section">
                <div class="studio-section-title">
                    <i class="fas fa-user"></i>
                    <span>Profile Settings</span>
                </div>
                
                <div class="studio-form-group">
                    <label>Channel Name</label>
                    <input type="text" class="studio-input" id="settingsChannelName" placeholder="Enter channel name" maxlength="50">
                    <small>Can be changed once every 10 days. Last change: <span id="lastNameChange">Never</span></small>
                </div>
                
                <div class="studio-form-group">
                    <label>Username</label>
                    <input type="text" class="studio-input" id="settingsUsername" placeholder="Enter username" maxlength="30">
                    <small>Unique identifier. Can be changed once every 10 days.</small>
                </div>
                
                <div class="studio-form-group">
                    <label>Channel Description</label>
                    <textarea class="studio-input" id="settingsChannelDesc" rows="4" placeholder="Tell viewers about your channel" maxlength="5000"></textarea>
                </div>
                
                <div class="studio-form-group">
                    <label>Website / Social Links</label>
                    <input type="url" class="studio-input" id="settingsWebsite" placeholder="https://">
                </div>
                
                <div class="studio-form-group">
                    <label>Channel Link</label>
                    <div style="display: flex; gap: 8px;">
                        <input type="text" class="studio-input" id="settingsChannelLink" readonly>
                        <button class="studio-button secondary" id="copyChannelLinkSettings">Copy</button>
                    </div>
                </div>
                
                <button class="studio-button" id="updateChannelBtn">Update Profile</button>
            </div>
            
            <div class="studio-section">
                <div class="studio-section-title">
                    <i class="fas fa-credit-card"></i>
                    <span>Payment Settings</span>
                </div>
                
                <div class="studio-form-group">
                    <label>PayPal Email</label>
                    <input type="email" class="studio-input" id="paypalEmail" placeholder="Enter PayPal email">
                </div>
                
                <div class="studio-form-group">
                    <label>Bank Account Number</label>
                    <input type="text" class="studio-input" id="bankAccount" placeholder="Enter bank account">
                </div>
                
                <div class="studio-form-group">
                    <label>Routing Number</label>
                    <input type="text" class="studio-input" id="routingNumber" placeholder="Enter routing number">
                </div>
                
                <div class="studio-form-group">
                    <label>Account Holder Name</label>
                    <input type="text" class="studio-input" id="accountHolder" placeholder="Enter account holder name">
                </div>
                
                <button class="studio-button" id="savePaymentBtn">Save Payment Details</button>
            </div>
            
            <div class="studio-section">
                <div class="studio-section-title">
                    <i class="fas fa-crown"></i>
                    <span>Creator Level</span>
                </div>
                
                <p style="color: var(--text-secondary); margin-bottom: 12px;">Current Level: <span id="currentLevel" style="font-weight: 700;">Basic</span></p>
                <p style="color: var(--text-muted); font-size: 12px; margin-bottom: 16px;">Verified creators get:
                    <br> Neon red verified badge with animation
                    <br> Higher revenue share (70% vs 55%)
                    <br> Priority support
                    <br> Early access to features
                </p>
                
                <button class="studio-button" id="upgradeLevelBtn">Upgrade to Verified ($9.99/month)</button>
            </div>
            
            <div class="studio-section">
                <div class="studio-section-title">
                    <i class="fas fa-shield-alt"></i>
                    <span>Security</span>
                </div>
                
                <button class="studio-button secondary" id="changePasswordBtn" style="margin-bottom: 8px;">Change Password</button>
                <button class="studio-button secondary" id="twoFactorBtn">Enable 2FA</button>
            </div>
            
            <div class="studio-section">
                <div class="studio-section-title" style="color: var(--primary-red);">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Danger Zone</span>
                </div>
                
                <button class="studio-button danger" id="logoutBtn" style="margin-bottom: 8px;">Logout</button>
                <button class="studio-button danger" id="deleteAccountBtn">Delete Account</button>
            </div>
        </div>
    </div>

    <!-- Library Page -->
    <div class="page" id="libraryPage">
        <div class="page-header">
            <button id="closeLibrary"><i class="fas fa-arrow-left"></i></button>
            <div class="page-title">Library</div>
        </div>
        
        <div class="library-grid">
            <div class="library-item" data-library="history">
                <i class="fas fa-history"></i>
                <span>History</span>
                <p>Videos you've watched</p>
            </div>
            <div class="library-item" data-library="liked">
                <i class="fas fa-thumbs-up"></i>
                <span>Liked Videos</span>
                <p>Videos you've liked</p>
            </div>
            <div class="library-item" data-library="watchlater">
                <i class="fas fa-clock"></i>
                <span>Watch Later</span>
                <p>Saved for later</p>
            </div>
            <div class="library-item" data-library="playlists">
                <i class="fas fa-list"></i>
                <span>Playlists</span>
                <p>Your created playlists</p>
            </div>
            <div class="library-item" data-library="subscriptions">
                <i class="fas fa-users"></i>
                <span>Subscriptions</span>
                <p>Channels you follow</p>
            </div>
            <div class="library-item" data-library="downloads">
                <i class="fas fa-download"></i>
                <span>Downloads</span>
                <p>Offline videos</p>
            </div>
        </div>
        
        <div id="libraryContent" style="padding: 16px;"></div>
    </div>

    <!-- Wallet Page -->
    <div class="page" id="walletPage">
        <div class="page-header">
            <button id="closeWallet"><i class="fas fa-arrow-left"></i></button>
            <div class="page-title">Wallet</div>
        </div>
        
        <div class="wallet-header">
            <div class="wallet-balance" id="walletPageBalance">$0.00</div>
            <p style="color: var(--text-muted); font-size: 12px;">Available Balance</p>
            <div class="wallet-actions" style="margin-top: 12px;">
                <button class="wallet-btn withdraw-btn" id="walletWithdrawBtn">Withdraw</button>
                <button class="wallet-btn deposit-btn" id="walletDepositBtn">Add Funds</button>
            </div>
        </div>
        
        <div style="padding: 12px;">
            <h4 style="margin-bottom: 12px; font-size: 14px;">Recent Transactions</h4>
            <div id="walletTransactions"></div>
        </div>
        
        <div style="padding: 12px;">
            <h4 style="margin-bottom: 12px; font-size: 14px;">Earnings Overview</h4>
            <canvas id="walletChart" style="height: 200px;"></canvas>
        </div>
    </div>

    <!-- Category Page -->
    <div class="page" id="categoryPage">
        <div class="page-header">
            <button id="closeCategory"><i class="fas fa-arrow-left"></i></button>
            <div class="page-title" id="categoryTitle">Category</div>
        </div>
        <div class="video-grid" id="categoryVideos"></div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <button class="nav-item active" data-view="home">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </button>
        <button class="nav-item" data-view="shorts">
            <i class="fas fa-bolt"></i>
            <span>Shorts</span>
        </button>
        <button class="nav-item" data-view="subscriptions">
            <i class="fas fa-users"></i>
            <span>Subs</span>
        </button>
        <button class="nav-item" data-view="library">
            <i class="fas fa-bars"></i>
            <span>Library</span>
        </button>
        <button class="nav-item" data-view="studio">
            <i class="fas fa-chart-line"></i>
            <span>Studio</span>
        </button>
    </nav>

    <!-- Dark Mode Toggle -->
    <button class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
    </button>

    <!-- Mobile Fullpage Interstitial Ad -->
    <div class="ad-container-interstitial" id="interstitialAd">
        <script async type="application/javascript" src="https://a.pemsrv.com/ad-provider.js"></script> 
        <ins class="eas6a97888e33" data-zoneid="5834970"></ins> 
        <script>(AdProvider = window.AdProvider || []).push({"serve": {}});</script>
        <button class="close-modal" id="closeInterstitial" style="position: absolute; top: 20px; right: 20px; background: var(--bg-surface); width: 40px; height: 40px; border-radius: 50%; border: none; color: white;"></button>
    </div>

    <!-- Share Modal -->
    <div class="modal" id="shareModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Share Video</h3>
                <button class="close-modal" id="closeShareModal">&times;</button>
            </div>
            
            <div class="share-link-container">
                <input type="text" class="share-link-input" id="shareLink" readonly>
                <button class="copy-btn" id="copyLinkBtn">Copy</button>
            </div>
            
            <div class="embed-code" id="embedCode"></div>
            
            <div class="share-platforms">
                <button class="share-platform" data-platform="whatsapp">
                    <i class="fab fa-whatsapp" style="color: #25D366;"></i>
                    <span>WhatsApp</span>
                </button>
                <button class="share-platform" data-platform="telegram">
                    <i class="fab fa-telegram" style="color: #0088cc;"></i>
                    <span>Telegram</span>
                </button>
                <button class="share-platform" data-platform="facebook">
                    <i class="fab fa-facebook" style="color: #1877F2;"></i>
                    <span>Facebook</span>
                </button>
                <button class="share-platform" data-platform="twitter">
                    <i class="fab fa-twitter" style="color: #1DA1F2;"></i>
                    <span>Twitter</span>
                </button>
                <button class="share-platform" data-platform="email">
                    <i class="fas fa-envelope"></i>
                    <span>Email</span>
                </button>
                <button class="share-platform" data-platform="copy">
                    <i class="fas fa-copy"></i>
                    <span>Copy</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3> Discover Exclusive Content </h3>
                <button class="close-modal" id="closeAuthModal">&times;</button>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">Sign In</button>
                <button class="auth-tab" data-tab="signup">Sign Up</button>
            </div>
            
            <form class="auth-form" id="loginForm">
                <input type="email" class="form-input" placeholder="Email" id="loginEmail" required>
                <input type="password" class="form-input" placeholder="Password" id="loginPassword" required>
                <button type="submit" class="auth-button">Sign In</button>
            </form>
            
            <form class="auth-form" id="signupForm" style="display: none;">
                <input type="text" class="form-input" placeholder="Username" id="signupUsername" required>
                <input type="email" class="form-input" placeholder="Email" id="signupEmail" required>
                <input type="password" class="form-input" placeholder="Password" id="signupPassword" required>
                <input type="password" class="form-input" placeholder="Confirm Password" id="signupConfirm" required>
                <button type="submit" class="auth-button">Create Account</button>
            </form>
        </div>
    </div>

    <!-- Upload Modal -->
    <div class="modal" id="uploadModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upload Video</h3>
                <button class="close-modal" id="closeUploadModal">&times;</button>
            </div>
            
            <div class="upload-dropzone" id="uploadDropzone">
                <i class="fas fa-cloud-upload-alt"></i>
                <h4>Drag & Drop Video</h4>
                <p>or tap to browse</p>
                <p style="font-size: 10px;">MP4, MOV up to 2GB - Original content only</p>
                <input type="file" id="videoFileInput" accept="video/*" style="display: none;">
            </div>
            
            <div id="uploadPreview" style="display: none;">
                <video controls style="width: 100%; border-radius: var(--radius-sm); margin-bottom: 12px;" id="previewVideo"></video>
            </div>
            
            <div class="thumbnail-preview" id="thumbnailPreview" style="display: none;">
                <img src="" alt="Thumbnail" id="thumbnailImg">
            </div>
            
            <div class="thumbnail-options">
                <div class="thumbnail-option active" data-thumb="auto">Auto Generate</div>
                <div class="thumbnail-option" data-thumb="upload">Upload Thumbnail</div>
            </div>
            
            <input type="file" id="thumbnailFileInput" accept="image/*" style="display: none;">
            
            <input type="text" class="form-input" placeholder="Video Title" id="videoTitle" style="margin-bottom: 8px;" maxlength="100">
            <textarea class="form-input" placeholder="Description" id="videoDescription" rows="2" style="margin-bottom: 8px;" maxlength="5000"></textarea>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                <input type="text" class="form-input" placeholder="Tags (comma separated)" id="videoTags">
                <select class="form-input" id="videoCategory">
              <option value="amateur">Amateur</option>
<option value="professional">Professional</option>
<option value="couples">Couples</option>
<option value="solo">Solo</option>
<option value="livecams">Live Cams</option>
<option value="exclusive">Exclusive</option>
<option value="trending">Trending</option>
<option value="fantasy">Fantasy</option>
<option value="sensual">Sensual</option>
<option value="romance">Romance</option>
<option value="amateur">Amateur</option>
<option value="cosplay">Cosplay</option>
<option value="18plus">18+ Only</option>
</select>
</div>
            
            <label style="display: flex; align-items: center; gap: 6px; margin-bottom: 12px;">
                <input type="checkbox" id="isShort"> Mark as Short
            </label>
            
            <div class="upload-progress" id="uploadProgress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text">
                    <span>Uploading...</span>
                    <span id="progressPercent">0%</span>
                </div>
            </div>
            
            <div id="copyrightCheck" style="margin-bottom: 12px; display: none;">
                <p style="color: var(--primary-red); font-size: 12px;">
                    <i class="fas fa-exclamation-triangle"></i> Checking for copyright...
                </p>
            </div>
            
            <button class="auth-button" id="submitUpload" disabled>Upload Video</button>
        </div>
    </div>

    <!-- Verified Modal -->
    <div class="modal" id="verifiedModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Get Verified</h3>
                <button class="close-modal" id="closeVerifiedModal">&times;</button>
            </div>
            
            <div style="text-align: center; margin-bottom: 20px;">
                <i class="fas fa-check-circle" style="font-size: 60px; color: var(--neon-red); filter: drop-shadow(0 0 10px var(--neon-red-glow)); animation: neonPulse 1.5s infinite;"></i>
            </div>
            
            <ul style="list-style: none; margin-bottom: 20px;">
                <li style="margin-bottom: 10px;"> Neon red verified badge with animation</li>
                <li style="margin-bottom: 10px;"> 70% revenue share (vs 55% basic)</li>
                <li style="margin-bottom: 10px;"> Higher search ranking</li>
                <li style="margin-bottom: 10px;"> Priority recommendations</li>
                <li style="margin-bottom: 10px;"> Early access to features</li>
                <li style="margin-bottom: 10px;"> Priority support</li>
            </ul>
            
            <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                <button class="auth-button" style="flex: 1;" id="monthlyPlan">$9.99/month</button>
                <button class="auth-button" style="flex: 1;" id="yearlyPlan">$80.99/year</button>
            </div>
            
            <button class="auth-button" id="subscribeVerified">Subscribe with Wallet</button>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="payment-modal" id="paymentModal">
        <div class="payment-card">
            <div class="payment-header">
                <h3>Withdraw Funds</h3>
                <button class="close-modal" id="closePaymentModal">&times;</button>
            </div>
            
            <div class="payment-methods">
                <div class="payment-method active" data-method="paypal">
                    <i class="fab fa-paypal"></i>
                    <span>PayPal</span>
                </div>
                <div class="payment-method" data-method="bank">
                    <i class="fas fa-university"></i>
                    <span>Bank</span>
                </div>
            </div>
            
            <div id="paypalMethod" style="display: block;">
                <div class="payment-form">
                    <input type="email" class="payment-input" placeholder="PayPal Email" id="paypalEmailInput" value="">
                    <input type="number" class="payment-input" placeholder="Amount ($)" id="withdrawAmount" min="10" max="10000" step="0.01">
                    <p style="color: var(--text-muted); font-size: 10px; margin-top: -8px;">Minimum withdrawal: $10</p>
                    <button class="auth-button" id="confirmPaypalWithdraw">Withdraw via PayPal</button>
                </div>
                <div id="paypal-button-container" style="margin-top: 12px;"></div>
            </div>
            
            <div id="bankMethod" style="display: none;">
                <div class="bank-details">
                    <h4>Bank Account Details</h4>
                    <div class="bank-row">
                        <span>Account Holder:</span>
                        <span id="bankHolderDisplay"></span>
                    </div>
                    <div class="bank-row">
                        <span>Account Number:</span>
                        <span id="bankAccountDisplay"></span>
                    </div>
                    <div class="bank-row">
                        <span>Routing Number:</span>
                        <span id="bankRoutingDisplay"></span>
                    </div>
                </div>
                
                <div class="payment-form">
                    <input type="number" class="payment-input" placeholder="Amount ($)" id="bankWithdrawAmount" min="10" max="10000" step="0.01">
                    <p style="color: var(--text-muted); font-size: 10px; margin-top: -8px;">Minimum withdrawal: $10</p>
                    <button class="auth-button" id="confirmBankWithdraw">Withdraw to Bank</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Deposit Modal -->
    <div class="payment-modal" id="depositModal">
        <div class="payment-card">
            <div class="payment-header">
                <h3>Add Funds</h3>
                <button class="close-modal" id="closeDepositModal">&times;</button>
            </div>
            
            <div class="payment-methods">
                <div class="payment-method active" data-deposit="card">
                    <i class="fas fa-credit-card"></i>
                    <span>Card</span>
                </div>
                <div class="payment-method" data-deposit="paypal">
                    <i class="fab fa-paypal"></i>
                    <span>PayPal</span>
                </div>
                <div class="payment-method" data-deposit="crypto">
                    <i class="fab fa-bitcoin"></i>
                    <span>Crypto</span>
                </div>
            </div>
            
            <div id="cardMethod" style="display: block;">
                <div class="payment-form">
                    <input type="text" class="payment-input" placeholder="Card Number" id="cardNumber" maxlength="19">
                    <div style="display: flex; gap: 8px;">
                        <input type="text" class="payment-input" placeholder="MM/YY" id="cardExpiry" maxlength="5">
                        <input type="text" class="payment-input" placeholder="CVC" id="cardCvc" maxlength="4">
                    </div>
                    <input type="number" class="payment-input" placeholder="Amount ($)" id="depositAmount" min="1" max="10000" step="0.01">
                    <button class="auth-button" id="confirmCardDeposit">Pay with Card</button>
                </div>
            </div>
            
            <div id="depositPaypalMethod" style="display: none;">
                <div class="payment-form">
                    <input type="email" class="payment-input" placeholder="PayPal Email" id="depositPaypalEmail">
                    <input type="number" class="payment-input" placeholder="Amount ($)" id="paypalDepositAmount" min="1" max="10000" step="0.01">
                    <button class="auth-button" id="confirmPaypalDeposit">Pay with PayPal</button>
                </div>
            </div>
            
            <div id="cryptoMethod" style="display: none;">
                <div style="text-align: center; margin-bottom: 20px;">
                    <img src="https://chart.googleapis.com/chart?chs=200x200&cht=qr&chl=bitcoin:1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa&choe=UTF-8" style="width: 150px; height: 150px; margin-bottom: 10px;">
                    <p style="color: var(--text-muted); font-size: 12px;">Scan QR code to pay with Bitcoin</p>
                    <p style="font-size: 10px; word-break: break-all;">1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa</p>
                </div>
                
                <div class="payment-form">
                    <input type="number" class="payment-input" placeholder="Amount ($)" id="cryptoDepositAmount" min="1" max="10000" step="0.01">
                    <button class="auth-button" id="confirmCryptoDeposit">I've sent payment</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">
        <i class="fas fa-info-circle"></i>
        <span id="toastMessage"></span>
    </div>

    <script>
        // ============================
        // CONFIGURATION
        // ============================
        const CONFIG = {
            firebase: {
                apiKey: "AIzaSyBsfheLc8i-CsRGJ9jkbGUhdTj3ZD3SLu8",
                authDomain: "haitiantube-2affb.firebaseapp.com",
                projectId: "haitiantube-2affb",
                storageBucket: "haitiantube-2affb.firebasestorage.app",
                messagingSenderId: "564033314604",
                appId: "1:564033314604:web:dfcd9b74b670e47dae1689"
            },
            parse: {
                applicationId: "KO17FZ9yhp8XzNQnrlYzj7GaXaTr9hcekpY7u667",
                javascriptKey: "lTMvuwBNvXgAXfHnNHiqkdjj7vQHk5LcEocQY8Ya",
                serverURL: "https://parseapi.back4app.com/"
            },
            cloudinary: {
                cloudName: "dqx9c4kc6",
                uploadPreset: "xp4psfnn"
            },
            ads: {
                preRoll: "https://s.magsrv.com/v1/vast.php?idzone=5829940",
                midRoll: "https://cpm.afkwa.com/vast?zone=283171&tagid=387067",
                postRoll1: "https://cpm.afkwa.com/vast?zone=283171&tagid=387067",
                postRoll2: "https://s.magsrv.com/v1/vast.php?idzone=5831138",
                banner1: "https://s.magsrv.com/v1/vast.php?idzone=5831138",
                banner2: "https://instantmemorize.com/92705221f4f953ea7313efcc11384c43/invoke.js"
            },
            // Real CPM rates based on country - Lower for certain regions
            cpmRates: {
                'US': 12.50, 'GB': 10.20, 'CA': 9.80, 'AU': 8.90,
                'DE': 8.50, 'FR': 7.20, 'JP': 6.50, 'BR': 2.30,
                'DO': 0.85,  // Dominican Republic - very low
                'HT': 0.65,  // Haiti - very low
                'JM': 0.90,  // Jamaica
                'PR': 1.20,  // Puerto Rico
                'CU': 0.40,  // Cuba
                'BS': 1.50,  // Bahamas
                'BB': 1.30,  // Barbados
                'TT': 1.10,  // Trinidad and Tobago
                'default': 2.00
            },
            // Revenue share by level
            revenueShare: {
                basic: 0.55,    // 55%
                verified: 0.70  // 70%
            },
            // Bot detection patterns
            botPatterns: [
                /bot/i, /crawler/i, /spider/i, /scraper/i, /headless/i,
                /python/i, /curl/i, /wget/i, /java/i, /perl/i, /ruby/i,
                /php/i, /node/i, /axios/i, /request/i, /selenium/i,
                /phantom/i, /chrome-lighthouse/i, /googlebot/i, /bingbot/i,
                /yandex/i, /baidu/i, /slurp/i, /duckduck/i, /facebookexternal/i,
                /instagram/i, /twitter/i, /linkedin/i, /whatsapp/i, /telegram/i
            ],
            // Copyright detection - known platforms
            knownPlatforms: [
                'youtube.com', 'youtu.be', 'vimeo.com', 'dailymotion.com',
                'twitch.tv', 'tiktok.com', 'instagram.com', 'facebook.com',
                'twitter.com', 'x.com', 'reddit.com', 'rumble.com',
                'odysee.com', 'bitchute.com', 'lbry.tv', 't.me', 'discord.com'
            ]
        };

        // ============================
        // STATE
        // ============================
        const state = {
            user: null,
            isAuthenticated: false,
            currentView: 'home',
            videos: [],
            shorts: [],
            currentVideo: null,
            player: null,
            watchHistory: JSON.parse(localStorage.getItem('watchHistory')) || [],
            likedVideos: JSON.parse(localStorage.getItem('likedVideos')) || [],
            dislikedVideos: JSON.parse(localStorage.getItem('dislikedVideos')) || [],
            watchLater: JSON.parse(localStorage.getItem('watchLater')) || [],
            subscriptions: JSON.parse(localStorage.getItem('subscriptions')) || [],
            wallet: parseFloat(localStorage.getItem('wallet')) || 0,
            transactions: JSON.parse(localStorage.getItem('transactions')) || [],
            creatorLevel: localStorage.getItem('creatorLevel') || 'basic',
            theme: localStorage.getItem('theme') || 'dark',
            searchHistory: JSON.parse(localStorage.getItem('searchHistory')) || [],
            comments: [],
            paymentDetails: JSON.parse(localStorage.getItem('paymentDetails')) || {
                paypal: '',
                bankAccount: '',
                routingNumber: '',
                accountHolder: ''
            },
            viralScores: {},
            userIP: '',
            userCountry: 'default',
            lastNameChange: localStorage.getItem('lastNameChange') || null,
            lastUsernameChange: localStorage.getItem('lastUsernameChange') || null,
            channelSettings: JSON.parse(localStorage.getItem('channelSettings')) || {
                name: '',
                username: '',
                description: '',
                website: ''
            },
            // Real analytics data
            analytics: JSON.parse(localStorage.getItem('analytics')) || {
                viewsByCountry: {},
                watchTimeByCountry: {},
                adImpressionsByCountry: {},
                earningsByCountry: {},
                dailyViews: []
            }
        };

        // ============================
        // DOM ELEMENTS
        // ============================
        const elements = {
            ageModal: document.getElementById('ageModal'),
            confirmAge: document.getElementById('confirmAge'),
            denyAge: document.getElementById('denyAge'),
            copyrightModal: document.getElementById('copyrightModal'),
            copyrightMessage: document.getElementById('copyrightMessage'),
            closeCopyright: document.getElementById('closeCopyright'),
            homeBtn: document.getElementById('homeBtn'),
            searchToggle: document.getElementById('searchToggle'),
            searchSection: document.getElementById('searchSection'),
            searchInput: document.getElementById('searchInput'),
            clearSearch: document.getElementById('clearSearch'),
            searchSuggestions: document.getElementById('searchSuggestions'),
            categories: document.querySelectorAll('.category-chip'),
            mainContent: document.getElementById('mainContent'),
            videoGrid: document.getElementById('videoGrid'),
            shortsSection: document.getElementById('shortsSection'),
            shortsGrid: document.getElementById('shortsGrid'),
            loadingState: document.getElementById('loadingState'),
            noVideos: document.getElementById('noVideos'),
            uploadFirstBtn: document.getElementById('uploadFirstBtn'),
            uploadBtn: document.getElementById('uploadBtn'),
            avatarBtn: document.getElementById('avatarBtn'),
            avatarInitial: document.getElementById('avatarInitial'),
            navItems: document.querySelectorAll('.nav-item'),
            themeToggle: document.getElementById('themeToggle'),
            interstitialAd: document.getElementById('interstitialAd'),
            closeInterstitial: document.getElementById('closeInterstitial'),
            
            // Video Player
            videoPlayerPage: document.getElementById('videoPlayerPage'),
            closePlayer: document.getElementById('closePlayer'),
            playerVideoTitle: document.getElementById('playerVideoTitle'),
            likeBtn: document.getElementById('likeBtn'),
            dislikeBtn: document.getElementById('dislikeBtn'),
            likeCount: document.getElementById('likeCount'),
            dislikeCount: document.getElementById('dislikeCount'),
            shareBtn: document.getElementById('shareBtn'),
            saveBtn: document.getElementById('saveBtn'),
            playerChannelAvatar: document.getElementById('playerChannelAvatar'),
            playerChannelName: document.getElementById('playerChannelName'),
            verifiedBadge: document.getElementById('verifiedBadge'),
            playerSubscribers: document.getElementById('playerSubscribers'),
            playerVideoCount: document.getElementById('playerVideoCount'),
            subscribeBtn: document.getElementById('subscribeBtn'),
            playerViews: document.getElementById('playerViews'),
            playerDate: document.getElementById('playerDate'),
            playerDescription: document.getElementById('playerDescription'),
            showMoreDesc: document.getElementById('showMoreDesc'),
            midRollAd: document.getElementById('midRollAd'),
            commentCount: document.getElementById('commentCount'),
            sortComments: document.getElementById('sortComments'),
            commentAvatar: document.getElementById('commentAvatar'),
            commentInput: document.getElementById('commentInput'),
            submitComment: document.getElementById('submitComment'),
            commentsList: document.getElementById('commentsList'),
            recommendedList: document.getElementById('recommendedList'),
            
            // Channel Page
            channelPage: document.getElementById('channelPage'),
            closeChannel: document.getElementById('closeChannel'),
            shareChannelBtn: document.getElementById('shareChannelBtn'),
            channelPageTitle: document.getElementById('channelPageTitle'),
            channelLargeAvatar: document.getElementById('channelLargeAvatar'),
            channelPageName: document.getElementById('channelPageName'),
            channelVerifiedBadge: document.getElementById('channelVerifiedBadge'),
            channelPageSubscribers: document.getElementById('channelPageSubscribers'),
            channelPageVideos: document.getElementById('channelPageVideos'),
            channelPageViews: document.getElementById('channelPageViews'),
            copyChannelLink: document.getElementById('copyChannelLink'),
            channelTabs: document.querySelectorAll('.channel-tab'),
            channelVideos: document.getElementById('channelVideos'),
            channelShorts: document.getElementById('channelShorts'),
            channelAbout: document.getElementById('channelAbout'),
            channelDescription: document.getElementById('channelDescription'),
            channelJoined: document.getElementById('channelJoined'),
            channelLastUpdated: document.getElementById('channelLastUpdated'),
            
            // Studio Page
            studioPage: document.getElementById('studioPage'),
            closeStudio: document.getElementById('closeStudio'),
            studioAvatar: document.getElementById('studioAvatar'),
            studioName: document.getElementById('studioName'),
            studioLevel: document.getElementById('studioLevel'),
            studioLastUpdate: document.getElementById('studioLastUpdate'),
            studioTabs: document.querySelectorAll('[data-studio]'),
            studioDashboard: document.getElementById('studioDashboard'),
            studioVideos: document.getElementById('studioVideos'),
            studioAnalytics: document.getElementById('studioAnalytics'),
            studioWallet: document.getElementById('studioWallet'),
            studioSettings: document.getElementById('studioSettings'),
            studioTotalViews: document.getElementById('studioTotalViews'),
            studioTotalSubs: document.getElementById('studioTotalSubs'),
            studioWatchHours: document.getElementById('studioWatchHours'),
            studioBalance: document.getElementById('studioBalance'),
            studioUploadBtn: document.getElementById('studioUploadBtn'),
            studioVideosList: document.getElementById('studioVideosList'),
            analyticsTodayViews: document.getElementById('analyticsTodayViews'),
            analyticsWatchTime: document.getElementById('analyticsWatchTime'),
            analyticsRevenue: document.getElementById('analyticsRevenue'),
            analyticsCPM: document.getElementById('analyticsCPM'),
            topCountriesList: document.getElementById('topCountriesList'),
            trafficChart: document.getElementById('trafficChart'),
            walletMainBalance: document.getElementById('walletMainBalance'),
            withdrawBtn: document.getElementById('withdrawBtn'),
            depositBtn: document.getElementById('depositBtn'),
            transactionHistory: document.getElementById('transactionHistory'),
            countryEarnings: document.getElementById('countryEarnings'),
            walletCountryEarnings: document.getElementById('walletCountryEarnings'),
            settingsChannelName: document.getElementById('settingsChannelName'),
            settingsUsername: document.getElementById('settingsUsername'),
            settingsChannelDesc: document.getElementById('settingsChannelDesc'),
            settingsWebsite: document.getElementById('settingsWebsite'),
            settingsChannelLink: document.getElementById('settingsChannelLink'),
            copyChannelLinkSettings: document.getElementById('copyChannelLinkSettings'),
            lastNameChange: document.getElementById('lastNameChange'),
            updateChannelBtn: document.getElementById('updateChannelBtn'),
            currentLevel: document.getElementById('currentLevel'),
            upgradeLevelBtn: document.getElementById('upgradeLevelBtn'),
            changePasswordBtn: document.getElementById('changePasswordBtn'),
            twoFactorBtn: document.getElementById('twoFactorBtn'),
            logoutBtn: document.getElementById('logoutBtn'),
            deleteAccountBtn: document.getElementById('deleteAccountBtn'),
            paypalEmail: document.getElementById('paypalEmail'),
            bankAccount: document.getElementById('bankAccount'),
            routingNumber: document.getElementById('routingNumber'),
            accountHolder: document.getElementById('accountHolder'),
            savePaymentBtn: document.getElementById('savePaymentBtn'),
            walletPaypalEmail: document.getElementById('walletPaypalEmail'),
            walletBankAccount: document.getElementById('walletBankAccount'),
            walletRoutingNumber: document.getElementById('walletRoutingNumber'),
            walletAccountHolder: document.getElementById('walletAccountHolder'),
            saveWalletPaymentBtn: document.getElementById('saveWalletPaymentBtn'),
            avatarUpload: document.getElementById('avatarUpload'),
            
            // Library Page
            libraryPage: document.getElementById('libraryPage'),
            closeLibrary: document.getElementById('closeLibrary'),
            libraryItems: document.querySelectorAll('.library-item'),
            libraryContent: document.getElementById('libraryContent'),
            
            // Wallet Page
            walletPage: document.getElementById('walletPage'),
            closeWallet: document.getElementById('closeWallet'),
            walletPageBalance: document.getElementById('walletPageBalance'),
            walletWithdrawBtn: document.getElementById('walletWithdrawBtn'),
            walletDepositBtn: document.getElementById('walletDepositBtn'),
            walletTransactions: document.getElementById('walletTransactions'),
            
            // Category Page
            categoryPage: document.getElementById('categoryPage'),
            closeCategory: document.getElementById('closeCategory'),
            categoryTitle: document.getElementById('categoryTitle'),
            categoryVideos: document.getElementById('categoryVideos'),
            
            // Modals
            shareModal: document.getElementById('shareModal'),
            closeShareModal: document.getElementById('closeShareModal'),
            shareLink: document.getElementById('shareLink'),
            copyLinkBtn: document.getElementById('copyLinkBtn'),
            embedCode: document.getElementById('embedCode'),
            sharePlatforms: document.querySelectorAll('.share-platform'),
            authModal: document.getElementById('authModal'),
            closeAuthModal: document.getElementById('closeAuthModal'),
            authTabs: document.querySelectorAll('.auth-tab'),
            loginForm: document.getElementById('loginForm'),
            signupForm: document.getElementById('signupForm'),
            loginEmail: document.getElementById('loginEmail'),
            loginPassword: document.getElementById('loginPassword'),
            signupUsername: document.getElementById('signupUsername'),
            signupEmail: document.getElementById('signupEmail'),
            signupPassword: document.getElementById('signupPassword'),
            signupConfirm: document.getElementById('signupConfirm'),
            uploadModal: document.getElementById('uploadModal'),
            closeUploadModal: document.getElementById('closeUploadModal'),
            uploadDropzone: document.getElementById('uploadDropzone'),
            videoFileInput: document.getElementById('videoFileInput'),
            uploadPreview: document.getElementById('uploadPreview'),
            previewVideo: document.getElementById('previewVideo'),
            thumbnailPreview: document.getElementById('thumbnailPreview'),
            thumbnailImg: document.getElementById('thumbnailImg'),
            thumbnailOptions: document.querySelectorAll('.thumbnail-option'),
            thumbnailFileInput: document.getElementById('thumbnailFileInput'),
            videoTitle: document.getElementById('videoTitle'),
            videoDescription: document.getElementById('videoDescription'),
            videoTags: document.getElementById('videoTags'),
            videoCategory: document.getElementById('videoCategory'),
            isShort: document.getElementById('isShort'),
            uploadProgress: document.getElementById('uploadProgress'),
            progressFill: document.getElementById('progressFill'),
            progressPercent: document.getElementById('progressPercent'),
            copyrightCheck: document.getElementById('copyrightCheck'),
            submitUpload: document.getElementById('submitUpload'),
            verifiedModal: document.getElementById('verifiedModal'),
            closeVerifiedModal: document.getElementById('closeVerifiedModal'),
            monthlyPlan: document.getElementById('monthlyPlan'),
            yearlyPlan: document.getElementById('yearlyPlan'),
            subscribeVerified: document.getElementById('subscribeVerified'),
            
            // Payment Modals
            paymentModal: document.getElementById('paymentModal'),
            closePaymentModal: document.getElementById('closePaymentModal'),
            depositModal: document.getElementById('depositModal'),
            closeDepositModal: document.getElementById('closeDepositModal'),
            paymentMethods: document.querySelectorAll('.payment-method'),
            paypalMethod: document.getElementById('paypalMethod'),
            bankMethod: document.getElementById('bankMethod'),
            paypalEmailInput: document.getElementById('paypalEmailInput'),
            withdrawAmount: document.getElementById('withdrawAmount'),
            confirmPaypalWithdraw: document.getElementById('confirmPaypalWithdraw'),
            bankWithdrawAmount: document.getElementById('bankWithdrawAmount'),
            confirmBankWithdraw: document.getElementById('confirmBankWithdraw'),
            bankHolderDisplay: document.getElementById('bankHolderDisplay'),
            bankAccountDisplay: document.getElementById('bankAccountDisplay'),
            bankRoutingDisplay: document.getElementById('bankRoutingDisplay'),
            depositMethods: document.querySelectorAll('[data-deposit]'),
            cardMethod: document.getElementById('cardMethod'),
            depositPaypalMethod: document.getElementById('depositPaypalMethod'),
            cryptoMethod: document.getElementById('cryptoMethod'),
            cardNumber: document.getElementById('cardNumber'),
            cardExpiry: document.getElementById('cardExpiry'),
            cardCvc: document.getElementById('cardCvc'),
            depositAmount: document.getElementById('depositAmount'),
            confirmCardDeposit: document.getElementById('confirmCardDeposit'),
            depositPaypalEmail: document.getElementById('depositPaypalEmail'),
            paypalDepositAmount: document.getElementById('paypalDepositAmount'),
            confirmPaypalDeposit: document.getElementById('confirmPaypalDeposit'),
            cryptoDepositAmount: document.getElementById('cryptoDepositAmount'),
            confirmCryptoDeposit: document.getElementById('confirmCryptoDeposit'),
            
            toast: document.getElementById('toast'),
            toastMessage: document.getElementById('toastMessage')
        };

        // ============================
        // INITIALIZATION
        // ============================
        document.addEventListener('DOMContentLoaded', () => {
            initFirebase();
            initParse();
            getUserIP();
            setupAntiBot();
            checkAgeVerification(); // Will show on every refresh
            loadContent();
            setupEventListeners();
            applyTheme();
            checkDeepLink();
            initStripe();
            initPayPal();
            initAnalytics();
            showInterstitialAd();
        });

        function getUserIP() {
            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => {
                    state.userIP = data.ip;
                    detectCountry(data.ip);
                })
                .catch(() => {
                    state.userCountry = 'default';
                });
        }

        function detectCountry(ip) {
            // In production, use a proper IP geolocation API
            // For demo, simulate based on IP ranges
            const firstOctet = parseInt(ip.split('.')[0]);
            
            if (firstOctet >= 190 && firstOctet <= 200) {
                state.userCountry = 'DO'; // Dominican Republic
            } else if (firstOctet >= 170 && firstOctet <= 180) {
                state.userCountry = 'HT'; // Haiti
            } else {
                state.userCountry = 'US';
            }
        }

        function setupAntiBot() {
            const userAgent = navigator.userAgent;
            const isBot = CONFIG.botPatterns.some(pattern => pattern.test(userAgent));
            
            if (isBot) {
                document.body.innerHTML = '<h1>Access Denied</h1><p>Automated access is not allowed.</p>';
                throw new Error('Bot detected');
            }
            
            // Check for headless browser
            if (navigator.webdriver) {
                document.body.innerHTML = '<h1>Access Denied</h1><p>Automated access detected.</p>';
                throw new Error('Headless browser detected');
            }
        }

        function initAnalytics() {
            // Initialize analytics structure if empty
            if (Object.keys(state.analytics.viewsByCountry).length === 0) {
                state.analytics = {
                    viewsByCountry: {},
                    watchTimeByCountry: {},
                    adImpressionsByCountry: {},
                    earningsByCountry: {},
                    dailyViews: []
                };
            }
        }

        function initFirebase() {
            firebase.initializeApp(CONFIG.firebase);
            
            firebase.auth().onAuthStateChanged((user) => {
                if (user) {
                    state.user = {
                        uid: user.uid,
                        email: user.email,
                        displayName: user.displayName || user.email.split('@')[0],
                        photoURL: user.photoURL
                    };
                    state.isAuthenticated = true;
                    updateAuthUI();
                    loadUserData();
                    loadChannelSettings();
                } else {
                    state.user = null;
                    state.isAuthenticated = false;
                    updateAuthUI();
                }
            });
        }

        function initParse() {
            Parse.initialize(CONFIG.parse.applicationId, CONFIG.parse.javascriptKey);
            Parse.serverURL = CONFIG.parse.serverURL;
        }

        function initStripe() {
            if (typeof Stripe !== 'undefined') {
                window.stripe = Stripe('pk_test_TYooMQauvdEDq54NiTphI7jx');
            }
        }

        function initPayPal() {
            if (typeof paypal !== 'undefined' && document.getElementById('paypal-button-container')) {
                paypal.Buttons({
                    createOrder: function(data, actions) {
                        const amount = document.getElementById('withdrawAmount')?.value || '10.00';
                        return actions.order.create({
                            purchase_units: [{
                                amount: {
                                    value: amount
                                }
                            }]
                        });
                    },
                    onApprove: function(data, actions) {
                        return actions.order.capture().then(function(details) {
                            processPaypalWithdrawal(details.payer.email_address);
                        });
                    }
                }).render('#paypal-button-container');
            }
        }

        function checkAgeVerification() {
            // Always show age verification on refresh
            elements.ageModal.style.display = 'flex';
        }

        function showInterstitialAd() {
            // Show interstitial ad periodically
            setInterval(() => {
                if (Math.random() < 0.3) { // 30% chance
                    elements.interstitialAd.style.display = 'flex';
                    
                    // Auto-hide after 5 seconds
                    setTimeout(() => {
                        elements.interstitialAd.style.display = 'none';
                    }, 5000);
                }
            }, 300000); // Every 5 minutes
        }

        function applyTheme() {
            document.documentElement.setAttribute('data-theme', state.theme);
            elements.themeToggle.innerHTML = state.theme === 'dark' ? 
                '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
        }

        function checkDeepLink() {
            const urlParams = new URLSearchParams(window.location.search);
            const videoId = urlParams.get('v');
            const channelId = urlParams.get('c');
            
            if (videoId) {
                loadVideoById(videoId);
            } else if (channelId) {
                loadChannelById(channelId);
            }
        }

        // ============================
        // LOAD CONTENT
        // ============================
        async function loadContent(category = 'all') {
            showLoading();
            
            try {
                const Video = Parse.Object.extend('Video');
                const query = new Parse.Query(Video);
                
                if (category !== 'all') {
                    if (category === 'trending') {
                        query.descending('views');
                    } else if (category === 'shorts') {
                        query.equalTo('isShort', true);
                    } else {
                        query.equalTo('category', category);
                    }
                }
                
                query.descending('createdAt');
                query.limit(50);
                
                const results = await query.find();
                state.videos = results.map(videoToObject);
                
                state.shorts = state.videos.filter(v => v.isShort);
                
                displayVideos();
                displayShorts();
                hideLoading();
                
                if (state.videos.length === 0 && state.shorts.length === 0) {
                    elements.noVideos.style.display = 'block';
                } else {
                    elements.noVideos.style.display = 'none';
                }
            } catch (error) {
                console.error('Error loading content:', error);
                hideLoading();
                showToast('Error loading content', 'error');
            }
        }

        function videoToObject(video) {
            return {
                id: video.id,
                title: video.get('title') || 'Untitled',
                description: video.get('description') || '',
                videoUrl: video.get('videoUrl'),
                thumbnailUrl: video.get('thumbnailUrl') || getRandomThumbnail(),
                creatorId: video.get('creatorId'),
                creatorName: video.get('creatorName') || 'Anonymous',
                creatorLevel: video.get('creatorLevel') || 'basic',
                views: video.get('views') || 0,
                likes: video.get('likes') || 0,
                dislikes: video.get('dislikes') || 0,
                comments: video.get('comments') || 0,
                shares: video.get('shares') || 0,
                duration: video.get('duration') || '0:00',
                category: video.get('category') || 'general',
                tags: video.get('tags') || [],
                isShort: video.get('isShort') || false,
                createdAt: video.get('createdAt'),
                subscribers: video.get('subscribers') || 0,
                videoCount: video.get('videoCount') || 0,
                copyrightChecked: video.get('copyrightChecked') || false,
                isOriginal: video.get('isOriginal') || false
            };
        }

        function getRandomThumbnail() {
            const thumbnails = [
                'https://images.unsplash.com/photo-1593359677879-a4bb92f829d1?w=400&h=225&fit=crop',
                'https://images.unsplash.com/photo-1536240478700-b869070f9279?w=400&h=225&fit=crop',
                'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=400&h=225&fit=crop'
            ];
            return thumbnails[Math.floor(Math.random() * thumbnails.length)];
        }

        function displayVideos() {
            elements.videoGrid.innerHTML = '';
            const displayVideos = state.videos.filter(v => !v.isShort);
            
            displayVideos.forEach(video => {
                elements.videoGrid.appendChild(createVideoCard(video));
            });
        }

        function displayShorts() {
            if (state.shorts.length > 0) {
                elements.shortsSection.style.display = 'block';
                elements.shortsGrid.innerHTML = '';
                
                state.shorts.slice(0, 6).forEach(short => {
                    elements.shortsGrid.appendChild(createShortCard(short));
                });
            } else {
                elements.shortsSection.style.display = 'none';
            }
        }

        function createVideoCard(video) {
            const card = document.createElement('div');
            card.className = 'video-card';
            card.dataset.id = video.id;
            
            const isLiked = state.likedVideos.includes(video.id);
            
            card.innerHTML = `
                <div class="thumbnail">
                    <img src="${video.thumbnailUrl}" alt="${video.title}" loading="lazy">
                    <span class="duration">${video.duration}</span>
                </div>
                <div class="video-info">
                    <div class="channel-avatar" onclick="event.stopPropagation(); openChannel('${video.creatorId}')">${video.creatorName.charAt(0)}</div>
                    <div class="video-details">
                        <h3 class="video-title">${video.title}</h3>
                        <div class="video-meta">
                            <span onclick="event.stopPropagation(); openChannel('${video.creatorId}')">${video.creatorName}</span>
                            ${video.creatorLevel === 'verified' ? '<span class="verified-badge"><i class="fas fa-check-circle"></i></span>' : ''}
                        </div>
                        <div class="video-meta">
                            <span>${formatNumber(video.views)} views</span>
                            <span></span>
                            <span>${timeAgo(video.createdAt)}</span>
                        </div>
                    </div>
                </div>
            `;
            
            card.addEventListener('click', () => playVideo(video));
            return card;
        }

        function createShortCard(video) {
            const card = document.createElement('div');
            card.className = 'short-card';
            card.dataset.id = video.id;
            
            card.innerHTML = `
                <img src="${video.thumbnailUrl}" alt="${video.title}">
                <div class="short-title">${video.title}</div>
            `;
            
            card.addEventListener('click', () => playVideo(video));
            return card;
        }

        // ============================
        // VIDEO PLAYER
        // ============================
        function playVideo(video) {
            state.currentVideo = video;
            
            addToHistory(video);
            
            // Show mid-roll ad at 30% into video
            setTimeout(() => {
                if (state.player && state.currentVideo) {
                    showMidRollAd();
                }
            }, video.duration * 1000 * 0.3);
            
            elements.videoPlayerPage.style.display = 'block';
            document.body.style.overflow = 'hidden';
            
            updatePlayerUI(video);
            loadComments(video.id);
            loadRecommendations();
            initPlayer(video);
        }

        function showMidRollAd() {
            elements.midRollAd.style.display = 'block';
            elements.midRollAd.innerHTML = `
                <ins class="eas6a97888e31" data-zoneid="5830152"></ins>
                <script>(AdProvider = window.AdProvider || []).push({"serve": {}});<\/script>
            `;
            
            setTimeout(() => {
                elements.midRollAd.style.display = 'none';
            }, 15000); // Hide after 15 seconds
        }

        function updatePlayerUI(video) {
            elements.playerVideoTitle.textContent = video.title;
            elements.playerChannelName.textContent = video.creatorName;
            elements.playerChannelAvatar.textContent = video.creatorName.charAt(0);
            elements.playerViews.textContent = formatNumber(video.views) + ' views';
            elements.playerDate.textContent = timeAgo(video.createdAt);
            elements.playerDescription.textContent = video.description || 'No description';
            elements.likeCount.textContent = formatNumber(video.likes);
            elements.dislikeCount.textContent = formatNumber(video.dislikes);
            elements.commentCount.textContent = video.comments + ' Comments';
            elements.playerSubscribers.textContent = formatNumber(video.subscribers);
            elements.playerVideoCount.textContent = video.videoCount;
            
            // Like button state
            if (state.likedVideos.includes(video.id)) {
                elements.likeBtn.classList.add('active');
                elements.likeBtn.querySelector('i').className = 'fas fa-thumbs-up';
            } else {
                elements.likeBtn.classList.remove('active');
                elements.likeBtn.querySelector('i').className = 'far fa-thumbs-up';
            }
            
            // Dislike button state
            if (state.dislikedVideos.includes(video.id)) {
                elements.dislikeBtn.classList.add('active');
                elements.dislikeBtn.querySelector('i').className = 'fas fa-thumbs-down';
            } else {
                elements.dislikeBtn.classList.remove('active');
                elements.dislikeBtn.querySelector('i').className = 'far fa-thumbs-down';
            }
            
            // Save button state
            if (state.watchLater.includes(video.id)) {
                elements.saveBtn.querySelector('i').className = 'fas fa-bookmark';
            } else {
                elements.saveBtn.querySelector('i').className = 'far fa-bookmark';
            }
            
            // Verified badge with neon animation
            if (video.creatorLevel === 'verified') {
                elements.verifiedBadge.style.display = 'inline-block';
            } else {
                elements.verifiedBadge.style.display = 'none';
            }
            
            // Subscribe button
            if (state.subscriptions.includes(video.creatorId)) {
                elements.subscribeBtn.textContent = 'Subscribed';
                elements.subscribeBtn.classList.add('subscribed');
            } else {
                elements.subscribeBtn.textContent = 'Subscribe';
                elements.subscribeBtn.classList.remove('subscribed');
            }
        }

        function initPlayer(video) {
            const container = document.getElementById('fluid-player');
            container.innerHTML = '';
            
            const videoElement = document.createElement('video');
            videoElement.id = 'player';
            videoElement.style.width = '100%';
            videoElement.style.height = '100%';
            
            const source = document.createElement('source');
            source.src = video.videoUrl;
            source.type = 'video/mp4';
            videoElement.appendChild(source);
            container.appendChild(videoElement);
            
            state.player = fluidPlayer('player', {
                layoutControls: {
                    primaryColor: "#0066FF",
                    posterImage: video.thumbnailUrl,
                    fillToContainer: true,
                    autoPlay: true,
                    title: video.title
                },
                vastOptions: {
                    adList: [
                        { roll: 'preRoll', vastTag: CONFIG.ads.preRoll },
                        { roll: 'midRoll', vastTag: CONFIG.ads.midRoll, timer: 35 },
                        { roll: 'postRoll', vastTag: CONFIG.ads.postRoll1 },
                        { roll: 'postRoll', vastTag: CONFIG.ads.postRoll2 }
                    ],
                    skipButtonCaption: 'Skip ad in [seconds]',
                    skipButtonClickCaption: 'Skip'
                }
            });
            
            // Track real views with anti-bot protection
            trackView(video.id);
        }

        async function trackView(videoId) {
            // Check if it's a bot
            if (isBot()) return;
            
            // Check for duplicate view in short time (prevents spam)
            const lastView = localStorage.getItem(`lastView_${videoId}`);
            if (lastView && (Date.now() - parseInt(lastView)) < 30000) return; // 30 second cooldown
            
            localStorage.setItem(`lastView_${videoId}`, Date.now().toString());
            
            try {
                const Video = Parse.Object.extend('Video');
                const query = new Parse.Query(Video);
                const video = await query.get(videoId);
                
                // Increment real view count
                video.increment('views');
                await video.save();
                
                // Track in analytics
                trackAnalytics(videoId);
                
            } catch (error) {
                console.error('Error tracking view:', error);
            }
        }

        function trackAnalytics(videoId) {
            const country = state.userCountry;
            const date = new Date().toISOString().split('T')[0];
            
            // Update views by country
            state.analytics.viewsByCountry[country] = (state.analytics.viewsByCountry[country] || 0) + 1;
            
            // Update daily views
            let dailyEntry = state.analytics.dailyViews.find(d => d.date === date);
            if (!dailyEntry) {
                dailyEntry = { date, views: 0, revenue: 0 };
                state.analytics.dailyViews.push(dailyEntry);
            }
            dailyEntry.views++;
            
            // Calculate revenue (CPM based on country)
            const cpm = CONFIG.cpmRates[country] || CONFIG.cpmRates.default;
            const revenue = (cpm / 1000) * CONFIG.revenueShare[state.creatorLevel || 'basic'];
            
            state.analytics.earningsByCountry[country] = (state.analytics.earningsByCountry[country] || 0) + revenue;
            
            // Update wallet with earnings
            state.wallet += revenue;
            localStorage.setItem('wallet', state.wallet.toString());
            
            // Save analytics
            localStorage.setItem('analytics', JSON.stringify(state.analytics));
            
            updateWalletUI();
        }

        function isBot() {
            const userAgent = navigator.userAgent;
            return CONFIG.botPatterns.some(pattern => pattern.test(userAgent));
        }

        function addToHistory(video) {
            const existing = state.watchHistory.findIndex(h => h.id === video.id);
            if (existing !== -1) {
                state.watchHistory.splice(existing, 1);
            }
            
            state.watchHistory.unshift({
                id: video.id,
                title: video.title,
                thumbnail: video.thumbnailUrl,
                creator: video.creatorName,
                watchedAt: new Date().toISOString()
            });
            
            if (state.watchHistory.length > 50) {
                state.watchHistory.pop();
            }
            
            localStorage.setItem('watchHistory', JSON.stringify(state.watchHistory));
        }

        // ============================
        // CHANNEL FUNCTIONS - FIXED
        // ============================
        window.openChannelFromPlayer = function() {
            if (state.currentVideo) {
                openChannel(state.currentVideo.creatorId);
            }
        };

        async function openChannel(creatorId) {
            showLoading();
            
            try {
                const User = Parse.Object.extend('User');
                const query = new Parse.Query(User);
                query.equalTo('firebaseUid', creatorId);
                const user = await query.first();
                
                if (!user) {
                    hideLoading();
                    showToast('Channel not found', 'error');
                    return;
                }
                
                const Video = Parse.Object.extend('Video');
                const videoQuery = new Parse.Query(Video);
                videoQuery.equalTo('creatorId', creatorId);
                videoQuery.descending('createdAt');
                const videos = await videoQuery.find();
                
                const channelVideos = videos.map(videoToObject);
                const shorts = channelVideos.filter(v => v.isShort);
                const regularVideos = channelVideos.filter(v => !v.isShort);
                
                const totalViews = channelVideos.reduce((sum, v) => sum + v.views, 0);
                
                // Update channel page
                elements.channelPageName.textContent = user.get('username') || 'Channel';
                elements.channelLargeAvatar.textContent = (user.get('username') || 'C').charAt(0);
                elements.channelPageSubscribers.textContent = formatNumber(user.get('subscribers') || 0) + ' subscribers';
                elements.channelPageVideos.textContent = channelVideos.length + ' videos';
                elements.channelPageViews.textContent = formatNumber(totalViews) + ' views';
                elements.channelDescription.textContent = user.get('description') || 'No description available.';
                elements.channelJoined.textContent = 'Joined: ' + (user.get('createdAt') ? new Date(user.get('createdAt')).toLocaleDateString() : 'N/A');
                
                // Show last name change
                const lastChange = user.get('lastNameChange');
                if (lastChange) {
                    elements.channelLastUpdated.textContent = 'Last name change: ' + new Date(lastChange).toLocaleDateString();
                } else {
                    elements.channelLastUpdated.textContent = 'Last name change: Never';
                }
                
                if (user.get('level') === 'verified') {
                    elements.channelVerifiedBadge.style.display = 'inline-block';
                } else {
                    elements.channelVerifiedBadge.style.display = 'none';
                }
                
                // Display videos
                elements.channelVideos.innerHTML = '';
                regularVideos.forEach(video => {
                    elements.channelVideos.appendChild(createVideoCard(video));
                });
                
                elements.channelShorts.innerHTML = '';
                shorts.forEach(short => {
                    const shortCard = createShortCard(short);
                    elements.channelShorts.appendChild(shortCard);
                });
                
                elements.channelPage.style.display = 'block';
                elements.videoPlayerPage.style.display = 'none';
                elements.mainContent.style.display = 'none';
                hideLoading();
                
            } catch (error) {
                console.error('Error loading channel:', error);
                hideLoading();
                showToast('Error loading channel: ' + error.message, 'error');
            }
        }

        async function loadChannelById(channelId) {
            await openChannel(channelId);
        }

        // ============================
        // SUBSCRIPTIONS - FIXED
        // ============================
        async function toggleSubscribe() {
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            if (!state.currentVideo) return;
            
            const creatorId = state.currentVideo.creatorId;
            const isSubscribed = state.subscriptions.includes(creatorId);
            
            try {
                const User = Parse.Object.extend('User');
                const query = new Parse.Query(User);
                query.equalTo('firebaseUid', creatorId);
                const creator = await query.first();
                
                if (!creator) {
                    showToast('Creator not found', 'error');
                    return;
                }
                
                if (isSubscribed) {
                    state.subscriptions = state.subscriptions.filter(id => id !== creatorId);
                    creator.increment('subscribers', -1);
                    
                    // Remove subscription from database
                    const Subscription = Parse.Object.extend('Subscription');
                    const subQuery = new Parse.Query(Subscription);
                    subQuery.equalTo('userId', state.user.uid);
                    subQuery.equalTo('creatorId', creatorId);
                    const sub = await subQuery.first();
                    if (sub) {
                        await sub.destroy();
                    }
                } else {
                    state.subscriptions.push(creatorId);
                    creator.increment('subscribers');
                    
                    const Subscription = Parse.Object.extend('Subscription');
                    const sub = new Subscription();
                    sub.set('userId', state.user.uid);
                    sub.set('creatorId', creatorId);
                    await sub.save();
                }
                
                await creator.save();
                
                state.currentVideo.subscribers = creator.get('subscribers') || 0;
                elements.playerSubscribers.textContent = formatNumber(state.currentVideo.subscribers);
                
                if (isSubscribed) {
                    elements.subscribeBtn.textContent = 'Subscribe';
                    elements.subscribeBtn.classList.remove('subscribed');
                    showToast('Unsubscribed', 'info');
                } else {
                    elements.subscribeBtn.textContent = 'Subscribed';
                    elements.subscribeBtn.classList.add('subscribed');
                    showToast('Subscribed!', 'success');
                }
                
                localStorage.setItem('subscriptions', JSON.stringify(state.subscriptions));
            } catch (error) {
                console.error('Error updating subscription:', error);
                showToast('Error updating subscription: ' + error.message, 'error');
            }
        }

        // ============================
        // LIKE/DISLIKE SYSTEM
        // ============================
        async function toggleLike() {
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            if (!state.currentVideo) return;
            
            // Check for bot
            if (isBot()) {
                showToast('Automated actions are not allowed', 'error');
                return;
            }
            
            const videoId = state.currentVideo.id;
            const isLiked = state.likedVideos.includes(videoId);
            
            try {
                const Video = Parse.Object.extend('Video');
                const query = new Parse.Query(Video);
                const video = await query.get(videoId);
                
                if (isLiked) {
                    video.increment('likes', -1);
                    state.likedVideos = state.likedVideos.filter(id => id !== videoId);
                } else {
                    video.increment('likes');
                    state.likedVideos.push(videoId);
                    
                    // Remove dislike if exists
                    if (state.dislikedVideos.includes(videoId)) {
                        video.increment('dislikes', -1);
                        state.dislikedVideos = state.dislikedVideos.filter(id => id !== videoId);
                    }
                }
                
                await video.save();
                
                state.currentVideo.likes = video.get('likes');
                elements.likeCount.textContent = formatNumber(state.currentVideo.likes);
                
                if (isLiked) {
                    elements.likeBtn.classList.remove('active');
                    elements.likeBtn.querySelector('i').className = 'far fa-thumbs-up';
                } else {
                    elements.likeBtn.classList.add('active');
                    elements.likeBtn.querySelector('i').className = 'fas fa-thumbs-up';
                    elements.dislikeBtn.classList.remove('active');
                    elements.dislikeBtn.querySelector('i').className = 'far fa-thumbs-down';
                }
                
                localStorage.setItem('likedVideos', JSON.stringify(state.likedVideos));
                localStorage.setItem('dislikedVideos', JSON.stringify(state.dislikedVideos));
                showToast(isLiked ? 'Removed like' : 'Video liked!', 'success');
            } catch (error) {
                console.error('Error updating like:', error);
                showToast('Error updating like', 'error');
            }
        }

        async function toggleDislike() {
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            if (!state.currentVideo) return;
            
            // Check for bot
            if (isBot()) {
                showToast('Automated actions are not allowed', 'error');
                return;
            }
            
            const videoId = state.currentVideo.id;
            const isDisliked = state.dislikedVideos.includes(videoId);
            
            try {
                const Video = Parse.Object.extend('Video');
                const query = new Parse.Query(Video);
                const video = await query.get(videoId);
                
                if (isDisliked) {
                    video.increment('dislikes', -1);
                    state.dislikedVideos = state.dislikedVideos.filter(id => id !== videoId);
                } else {
                    video.increment('dislikes');
                    state.dislikedVideos.push(videoId);
                    
                    if (state.likedVideos.includes(videoId)) {
                        video.increment('likes', -1);
                        state.likedVideos = state.likedVideos.filter(id => id !== videoId);
                        elements.likeBtn.classList.remove('active');
                        elements.likeBtn.querySelector('i').className = 'far fa-thumbs-up';
                    }
                }
                
                await video.save();
                
                state.currentVideo.dislikes = video.get('dislikes');
                elements.dislikeCount.textContent = formatNumber(state.currentVideo.dislikes);
                
                if (isDisliked) {
                    elements.dislikeBtn.classList.remove('active');
                    elements.dislikeBtn.querySelector('i').className = 'far fa-thumbs-down';
                } else {
                    elements.dislikeBtn.classList.add('active');
                    elements.dislikeBtn.querySelector('i').className = 'fas fa-thumbs-down';
                }
                
                localStorage.setItem('likedVideos', JSON.stringify(state.likedVideos));
                localStorage.setItem('dislikedVideos', JSON.stringify(state.dislikedVideos));
                showToast(isDisliked ? 'Removed dislike' : 'Video disliked', 'info');
            } catch (error) {
                console.error('Error updating dislike:', error);
                showToast('Error updating dislike', 'error');
            }
        }

        // ============================
        // COMMENTS SYSTEM
        // ============================
        async function loadComments(videoId, sort = 'top') {
            try {
                const Comment = Parse.Object.extend('Comment');
                const query = new Parse.Query(Comment);
                query.equalTo('videoId', videoId);
                
                if (sort === 'top') {
                    query.descending('likes');
                } else {
                    query.descending('createdAt');
                }
                
                query.limit(50);
                const results = await query.find();
                
                state.comments = results.map(comment => ({
                    id: comment.id,
                    text: comment.get('text'),
                    userId: comment.get('userId'),
                    username: comment.get('username'),
                    userAvatar: comment.get('userAvatar'),
                    likes: comment.get('likes') || 0,
                    createdAt: comment.get('createdAt'),
                    replies: comment.get('replies') || []
                }));
                
                displayComments();
            } catch (error) {
                console.error('Error loading comments:', error);
            }
        }

        function displayComments() {
            elements.commentsList.innerHTML = '';
            
            state.comments.forEach(comment => {
                const commentEl = createCommentElement(comment);
                elements.commentsList.appendChild(commentEl);
            });
        }

        function createCommentElement(comment) {
            const div = document.createElement('div');
            div.className = 'comment-item';
            
            div.innerHTML = `
                <div class="channel-avatar">${comment.username.charAt(0)}</div>
                <div class="comment-content">
                    <div class="comment-header">
                        <span class="comment-author">${comment.username}</span>
                        <span class="comment-time">${timeAgo(comment.createdAt)}</span>
                    </div>
                    <div class="comment-text">${comment.text}</div>
                    <div class="comment-actions">
                        <span class="comment-action like-comment" data-id="${comment.id}">
                            <i class="far fa-thumbs-up"></i> ${formatNumber(comment.likes)}
                        </span>
                        <span class="comment-action reply-btn" data-id="${comment.id}">
                            <i class="far fa-comment"></i> Reply
                        </span>
                    </div>
                    <div class="replies" id="replies-${comment.id}"></div>
                </div>
            `;
            
            const likeBtn = div.querySelector('.like-comment');
            likeBtn.addEventListener('click', () => likeComment(comment.id));
            
            const replyBtn = div.querySelector('.reply-btn');
            replyBtn.addEventListener('click', () => showReplyInput(comment.id));
            
            return div;
        }

        async function addComment() {
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            // Check for bot
            if (isBot()) {
                showToast('Automated actions are not allowed', 'error');
                return;
            }
            
            const text = elements.commentInput.value.trim();
            if (!text || !state.currentVideo) return;
            
            try {
                const Comment = Parse.Object.extend('Comment');
                const comment = new Comment();
                comment.set('videoId', state.currentVideo.id);
                comment.set('userId', state.user.uid);
                comment.set('username', state.user.displayName);
                comment.set('userAvatar', state.user.photoURL || '');
                comment.set('text', text);
                comment.set('likes', 0);
                
                await comment.save();
                
                // Update video comment count
                const Video = Parse.Object.extend('Video');
                const query = new Parse.Query(Video);
                const video = await query.get(state.currentVideo.id);
                video.increment('comments');
                await video.save();
                
                state.currentVideo.comments++;
                elements.commentCount.textContent = state.currentVideo.comments + ' Comments';
                
                elements.commentInput.value = '';
                loadComments(state.currentVideo.id);
                showToast('Comment added', 'success');
            } catch (error) {
                console.error('Error adding comment:', error);
                showToast('Error adding comment', 'error');
            }
        }

        async function likeComment(commentId) {
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            try {
                const Comment = Parse.Object.extend('Comment');
                const query = new Parse.Query(Comment);
                const comment = await query.get(commentId);
                comment.increment('likes');
                await comment.save();
                
                loadComments(state.currentVideo.id);
            } catch (error) {
                console.error('Error liking comment:', error);
            }
        }

        function showReplyInput(commentId) {
            const replyDiv = document.getElementById(`replies-${commentId}`);
            if (!replyDiv) return;
            
            const inputDiv = document.createElement('div');
            inputDiv.className = 'add-comment';
            inputDiv.style.marginTop = '8px';
            inputDiv.innerHTML = `
                <div class="channel-avatar">${state.user?.displayName?.charAt(0) || 'Y'}</div>
                <div class="comment-input-wrapper">
                    <input type="text" class="comment-input" placeholder="Write a reply..." id="reply-${commentId}">
                    <button class="comment-submit" onclick="window.submitReply('${commentId}')">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            `;
            
            replyDiv.appendChild(inputDiv);
        }

        window.submitReply = async function(commentId) {
            const input = document.getElementById(`reply-${commentId}`);
            if (!input || !input.value.trim()) return;
            
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            try {
                const Reply = Parse.Object.extend('Reply');
                const reply = new Reply();
                reply.set('commentId', commentId);
                reply.set('userId', state.user.uid);
                reply.set('username', state.user.displayName);
                reply.set('text', input.value.trim());
                await reply.save();
                
                input.value = '';
                showToast('Reply added', 'success');
                loadComments(state.currentVideo.id);
            } catch (error) {
                console.error('Error adding reply:', error);
                showToast('Error adding reply', 'error');
            }
        };

        // ============================
        // RECOMMENDATIONS
        // ============================
        function loadRecommendations() {
            elements.recommendedList.innerHTML = '';
            
            const recs = state.videos
                .filter(v => v.id !== state.currentVideo?.id)
                .slice(0, 10);
            
            recs.forEach(video => {
                const item = createRecommendedItem(video);
                elements.recommendedList.appendChild(item);
            });
        }

        function createRecommendedItem(video) {
            const div = document.createElement('div');
            div.className = 'recommended-item';
            div.dataset.id = video.id;
            
            div.innerHTML = `
                <div class="recommended-thumb">
                    <img src="${video.thumbnailUrl}" alt="${video.title}">
                </div>
                <div class="recommended-info">
                    <h4>${video.title}</h4>
                    <p>${video.creatorName}</p>
                    <p>${formatNumber(video.views)} views  ${timeAgo(video.createdAt)}</p>
                </div>
            `;
            
            div.addEventListener('click', () => playVideo(video));
            return div;
        }

        // ============================
        // SHARE SYSTEM
        // ============================
        function showShareModal(video = state.currentVideo) {
            if (!video) return;
            
            const videoUrl = `${window.location.origin}?v=${video.id}`;
            const embedCode = `<iframe width="560" height="315" src="${window.location.origin}/embed/${video.id}" frameborder="0" allowfullscreen></iframe>`;
            
            elements.shareLink.value = videoUrl;
            elements.embedCode.textContent = embedCode;
            elements.shareModal.style.display = 'flex';
        }

        function setupShareButtons() {
            elements.copyLinkBtn.addEventListener('click', () => {
                navigator.clipboard.writeText(elements.shareLink.value);
                showToast('Link copied!', 'success');
            });
            
            elements.sharePlatforms.forEach(btn => {
                btn.addEventListener('click', () => {
                    const platform = btn.dataset.platform;
                    const url = elements.shareLink.value;
                    const title = state.currentVideo?.title || 'Check this out!';
                    
                    let shareUrl = '';
                    
                    switch(platform) {
                        case 'whatsapp':
                            shareUrl = `https://wa.me/?text=${encodeURIComponent(title + ' ' + url)}`;
                            break;
                        case 'telegram':
                            shareUrl = `https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`;
                            break;
                        case 'facebook':
                            shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
                            break;
                        case 'twitter':
                            shareUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(title)}`;
                            break;
                        case 'email':
                            shareUrl = `mailto:?subject=${encodeURIComponent(title)}&body=${encodeURIComponent(title + '\n\n' + url)}`;
                            break;
                        case 'copy':
                            navigator.clipboard.writeText(url);
                            showToast('Link copied!', 'success');
                            return;
                    }
                    
                    if (shareUrl) {
                        window.open(shareUrl, '_blank');
                    }
                });
            });
        }

        // ============================
        // WATCH LATER
        // ============================
        function toggleWatchLater() {
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            if (!state.currentVideo) return;
            
            const videoId = state.currentVideo.id;
            const isSaved = state.watchLater.includes(videoId);
            
            if (isSaved) {
                state.watchLater = state.watchLater.filter(id => id !== videoId);
                elements.saveBtn.querySelector('i').className = 'far fa-bookmark';
                showToast('Removed from Watch Later', 'info');
            } else {
                state.watchLater.push(videoId);
                elements.saveBtn.querySelector('i').className = 'fas fa-bookmark';
                showToast('Added to Watch Later', 'success');
            }
            
            localStorage.setItem('watchLater', JSON.stringify(state.watchLater));
        }

        // ============================
        // CREATOR STUDIO - ENHANCED
        // ============================
        async function loadStudio() {
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            try {
                const Video = Parse.Object.extend('Video');
                const query = new Parse.Query(Video);
                query.equalTo('creatorId', state.user.uid);
                const videos = await query.find();
                
                const totalViews = videos.reduce((sum, v) => sum + (v.get('views') || 0), 0);
                const totalWatchTime = Math.floor(totalViews * 5 / 60); // Approx watch hours
                
                elements.studioName.textContent = state.user.displayName;
                elements.studioAvatar.textContent = state.user.displayName.charAt(0);
                elements.studioLevel.textContent = `Creator Level: ${state.creatorLevel}`;
                elements.studioTotalViews.textContent = formatNumber(totalViews);
                elements.studioTotalSubs.textContent = formatNumber(state.subscriptions.length);
                elements.studioWatchHours.textContent = formatNumber(totalWatchTime);
                elements.studioBalance.textContent = '$' + state.wallet.toFixed(2);
                
                // Load payment details
                if (state.paymentDetails) {
                    if (elements.paypalEmail) elements.paypalEmail.value = state.paymentDetails.paypal || '';
                    if (elements.bankAccount) elements.bankAccount.value = state.paymentDetails.bankAccount || '';
                    if (elements.routingNumber) elements.routingNumber.value = state.paymentDetails.routingNumber || '';
                    if (elements.accountHolder) elements.accountHolder.value = state.paymentDetails.accountHolder || '';
                    
                    if (elements.walletPaypalEmail) elements.walletPaypalEmail.value = state.paymentDetails.paypal || '';
                    if (elements.walletBankAccount) elements.walletBankAccount.value = state.paymentDetails.bankAccount || '';
                    if (elements.walletRoutingNumber) elements.walletRoutingNumber.value = state.paymentDetails.routingNumber || '';
                    if (elements.walletAccountHolder) elements.walletAccountHolder.value = state.paymentDetails.accountHolder || '';
                }
                
                loadStudioVideos(videos);
                loadTransactions();
                loadCountryEarnings();
                createStudioChart();
                loadAnalytics();
                loadChannelSettings();
                
            } catch (error) {
                console.error('Error loading studio:', error);
                showToast('Error loading studio', 'error');
            }
        }

        function loadChannelSettings() {
            if (state.channelSettings) {
                elements.settingsChannelName.value = state.channelSettings.name || '';
                elements.settingsUsername.value = state.channelSettings.username || '';
                elements.settingsChannelDesc.value = state.channelSettings.description || '';
                elements.settingsWebsite.value = state.channelSettings.website || '';
                
                const channelLink = `${window.location.origin}/c/${state.user?.uid || ''}`;
                elements.settingsChannelLink.value = channelLink;
            }
            
            // Show last name change
            if (state.lastNameChange) {
                const daysSince = Math.floor((Date.now() - new Date(state.lastNameChange)) / (1000 * 60 * 60 * 24));
                const daysLeft = 10 - daysSince;
                if (daysLeft > 0) {
                    elements.lastNameChange.textContent = `Can change in ${daysLeft} days`;
                    elements.studioLastUpdate.textContent = `Last change: ${new Date(state.lastNameChange).toLocaleDateString()} (${daysLeft} days remaining)`;
                } else {
                    elements.lastNameChange.textContent = 'Available now';
                    elements.studioLastUpdate.textContent = 'Last change: Available now';
                }
            } else {
                elements.lastNameChange.textContent = 'Available now';
                elements.studioLastUpdate.textContent = 'Last change: Never';
            }
        }

        function loadStudioVideos(videos) {
            elements.studioVideosList.innerHTML = '';
            
            videos.forEach(video => {
                const v = videoToObject(video);
                const div = document.createElement('div');
                div.className = 'video-management-item';
                div.innerHTML = `
                    <div class="management-thumb">
                        <img src="${v.thumbnailUrl}" alt="${v.title}">
                    </div>
                    <div class="management-info">
                        <div class="management-title">${v.title}</div>
                        <div class="management-stats">
                            ${formatNumber(v.views)} views  ${timeAgo(v.createdAt)}
                        </div>
                        <div class="management-meta">
                            <span>${v.duration}</span>
                            <span></span>
                            <span>${v.likes} likes</span>
                            <span></span>
                            <span>${v.comments} comments</span>
                        </div>
                        <div class="management-actions">
                            <button class="management-btn edit-btn" onclick="window.editVideo('${v.id}')">Edit</button>
                            <button class="management-btn delete-btn" onclick="window.deleteVideo('${v.id}')">Delete</button>
                            <button class="management-btn analytics-btn" onclick="window.videoAnalytics('${v.id}')">Analytics</button>
                        </div>
                    </div>
                `;
                elements.studioVideosList.appendChild(div);
            });
        }

        function loadAnalytics() {
            // Today's views
            const today = new Date().toISOString().split('T')[0];
            const todayData = state.analytics.dailyViews.find(d => d.date === today);
            const todayViews = todayData ? todayData.views : 0;
            elements.analyticsTodayViews.textContent = formatNumber(todayViews);
            
            // Total watch time (approx)
            const totalWatchTime = state.analytics.dailyViews.reduce((sum, d) => sum + (d.views * 5), 0);
            elements.analyticsWatchTime.textContent = Math.floor(totalWatchTime / 60) + 'h';
            
            // Estimated revenue
            const totalRevenue = Object.values(state.analytics.earningsByCountry).reduce((sum, val) => sum + val, 0);
            elements.analyticsRevenue.textContent = '$' + totalRevenue.toFixed(2);
            
            // Average CPM
            const totalViews = state.analytics.dailyViews.reduce((sum, d) => sum + d.views, 0);
            const avgCPM = totalViews > 0 ? (totalRevenue / totalViews * 1000) : 0;
            elements.analyticsCPM.textContent = '$' + avgCPM.toFixed(2);
            
            // Top countries
            const topCountries = Object.entries(state.analytics.earningsByCountry)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);
            
            elements.topCountriesList.innerHTML = '';
            topCountries.forEach(([country, revenue]) => {
                const views = state.analytics.viewsByCountry[country] || 0;
                const cpm = CONFIG.cpmRates[country] || CONFIG.cpmRates.default;
                const div = document.createElement('div');
                div.className = 'country-item';
                div.innerHTML = `
                    <div class="country-info">
                        <div class="country-flag">${getCountryFlag(country)}</div>
                        <div class="country-details">
                            <h4>${getCountryName(country)}</h4>
                            <p>${formatNumber(views)} views  CPM: $${cpm.toFixed(2)}</p>
                        </div>
                    </div>
                    <div class="country-earnings-value">$${revenue.toFixed(2)}</div>
                `;
                elements.topCountriesList.appendChild(div);
            });
            
            // Traffic chart
            createTrafficChart();
        }

        function getCountryFlag(country) {
            const flags = {
                'US': '', 'GB': '', 'CA': '', 'AU': '',
                'DE': '', 'FR': '', 'JP': '', 'BR': '',
                'DO': '', 'HT': '', 'JM': '', 'PR': '',
                'CU': '', 'BS': '', 'BB': '', 'TT': '',
                'default': ''
            };
            return flags[country] || flags.default;
        }

        function getCountryName(country) {
            const names = {
                'US': 'United States', 'GB': 'United Kingdom', 'CA': 'Canada', 'AU': 'Australia',
                'DE': 'Germany', 'FR': 'France', 'JP': 'Japan', 'BR': 'Brazil',
                'DO': 'Dominican Republic', 'HT': 'Haiti', 'JM': 'Jamaica', 'PR': 'Puerto Rico',
                'CU': 'Cuba', 'BS': 'Bahamas', 'BB': 'Barbados', 'TT': 'Trinidad and Tobago',
                'default': 'Other'
            };
            return names[country] || names.default;
        }

        function createTrafficChart() {
            const ctx = document.getElementById('trafficChart')?.getContext('2d');
            if (!ctx) return;
            
            const countries = Object.keys(state.analytics.viewsByCountry).slice(0, 5);
            const views = countries.map(c => state.analytics.viewsByCountry[c] || 0);
            
            if (window.trafficChart) {
                window.trafficChart.destroy();
            }
            
            window.trafficChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: countries.map(c => getCountryName(c)),
                    datasets: [{
                        data: views,
                        backgroundColor: [
                            '#0066FF',
                            '#FF3B30',
                            '#4CAF50',
                            '#FFC107',
                            '#9C27B0'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: 'var(--text-primary)'
                            }
                        }
                    }
                }
            });
        }

        function loadTransactions() {
            const history = document.getElementById('transactionHistory');
            if (!history) return;
            
            history.innerHTML = '';
            
            state.transactions.slice(0, 10).forEach(t => {
                const div = document.createElement('div');
                div.className = 'transaction-item';
                div.innerHTML = `
                    <div class="transaction-info">
                        <div class="transaction-icon">
                            <i class="fas ${t.type === 'credit' ? 'fa-arrow-down' : 'fa-arrow-up'}"></i>
                        </div>
                        <div class="transaction-details">
                            <h4>${t.description}</h4>
                            <p>${new Date(t.date).toLocaleDateString()}</p>
                        </div>
                    </div>
                    <div class="transaction-amount ${t.type === 'credit' ? 'positive' : 'negative'}">
                        ${t.type === 'credit' ? '+' : '-'}$${t.amount.toFixed(2)}
                    </div>
                `;
                history.appendChild(div);
            });
        }

        function loadCountryEarnings() {
            const countryDiv = document.getElementById('countryEarnings');
            if (!countryDiv) return;
            
            countryDiv.innerHTML = '';
            
            const earnings = state.analytics.earningsByCountry || {};
            
            Object.entries(earnings).forEach(([country, amount]) => {
                const views = state.analytics.viewsByCountry[country] || 0;
                const cpm = CONFIG.cpmRates[country] || CONFIG.cpmRates.default;
                const div = document.createElement('div');
                div.className = 'country-item';
                div.innerHTML = `
                    <div class="country-info">
                        <div class="country-flag">${getCountryFlag(country)}</div>
                        <div class="country-details">
                            <h4>${getCountryName(country)}</h4>
                            <p>${formatNumber(views)} views  CPM: $${cpm.toFixed(2)}</p>
                        </div>
                    </div>
                    <div class="country-earnings-value">$${amount.toFixed(2)}</div>
                `;
                countryDiv.appendChild(div);
            });
            
            // Update wallet country earnings
            const walletCountryDiv = document.getElementById('walletCountryEarnings');
            if (walletCountryDiv) {
                walletCountryDiv.innerHTML = countryDiv.innerHTML;
            }
        }

        function createStudioChart() {
            const ctx = document.getElementById('studioChart')?.getContext('2d');
            if (!ctx) return;
            
            // Get last 7 days data
            const labels = [];
            const data = [];
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                
                const dayData = state.analytics.dailyViews.find(d => d.date === dateStr);
                labels.push(date.toLocaleDateString('en-US', { weekday: 'short' }));
                data.push(dayData ? dayData.views : 0);
            }
            
            if (window.studioChart) {
                window.studioChart.destroy();
            }
            
            window.studioChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Views',
                        data: data,
                        borderColor: '#0066FF',
                        backgroundColor: 'rgba(0, 102, 255, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255,255,255,0.1)'
                            },
                            ticks: {
                                color: 'var(--text-muted)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: 'var(--text-muted)'
                            }
                        }
                    }
                }
            });
        }

        window.editVideo = function(videoId) {
            showToast('Edit feature coming soon', 'info');
        };

        window.deleteVideo = async function(videoId) {
            if (!confirm('Are you sure you want to delete this video? This action cannot be undone.')) return;
            
            try {
                const Video = Parse.Object.extend('Video');
                const query = new Parse.Query(Video);
                const video = await query.get(videoId);
                await video.destroy();
                
                showToast('Video deleted', 'success');
                loadStudio();
            } catch (error) {
                console.error('Error deleting video:', error);
                showToast('Error deleting video', 'error');
            }
        };

        window.videoAnalytics = function(videoId) {
            showToast('Analytics coming soon', 'info');
        };

        // ============================
        // WALLET FUNCTIONS - REAL
        // ============================
        function updateWalletUI() {
            const balanceStr = '$' + state.wallet.toFixed(2);
            
            if (elements.walletMainBalance) {
                elements.walletMainBalance.textContent = balanceStr;
            }
            
            if (elements.walletPageBalance) {
                elements.walletPageBalance.textContent = balanceStr;
            }
            
            if (elements.studioBalance) {
                elements.studioBalance.textContent = balanceStr;
            }
        }

        function addTransaction(amount, description, type) {
            const transaction = {
                id: Date.now(),
                amount,
                description,
                type,
                date: new Date().toISOString()
            };
            
            state.transactions.unshift(transaction);
            
            if (state.transactions.length > 50) {
                state.transactions.pop();
            }
            
            localStorage.setItem('transactions', JSON.stringify(state.transactions));
        }

        function withdrawMoney() {
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            if (state.wallet < 10) {
                showToast('Minimum withdrawal amount is $10', 'error');
                return;
            }
            
            // Load payment details into modal
            if (state.paymentDetails) {
                elements.paypalEmailInput.value = state.paymentDetails.paypal || '';
                elements.bankHolderDisplay.textContent = state.paymentDetails.accountHolder || 'Not set';
                elements.bankAccountDisplay.textContent = state.paymentDetails.bankAccount ? 
                    '****' + state.paymentDetails.bankAccount.slice(-4) : 'Not set';
                elements.bankRoutingDisplay.textContent = state.paymentDetails.routingNumber || 'Not set';
            }
            
            elements.paymentModal.style.display = 'flex';
        }

        function depositMoney() {
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            elements.depositModal.style.display = 'flex';
        }

        // PayPal Withdrawal - Real
        async function processPaypalWithdrawal(email = null) {
            const paypalEmail = email || elements.paypalEmailInput.value.trim();
            const amount = parseFloat(elements.withdrawAmount.value);
            
            if (!paypalEmail) {
                showToast('Please enter PayPal email', 'error');
                return;
            }
            
            if (isNaN(amount) || amount < 10) {
                showToast('Please enter valid amount (minimum $10)', 'error');
                return;
            }
            
            if (amount > state.wallet) {
                showToast('Insufficient balance', 'error');
                return;
            }
            
            try {
                showToast('Processing PayPal withdrawal...', 'info');
                
                // Real PayPal API integration would go here
                // For demo, simulate processing
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                state.wallet -= amount;
                localStorage.setItem('wallet', state.wallet.toString());
                
                addTransaction(amount, `Withdrawal to PayPal (${paypalEmail})`, 'debit');
                updateWalletUI();
                
                showToast(`$${amount.toFixed(2)} sent to your PayPal`, 'success');
                elements.paymentModal.style.display = 'none';
                
                // Reset form
                elements.withdrawAmount.value = '';
                
            } catch (error) {
                console.error('PayPal withdrawal error:', error);
                showToast('Withdrawal failed', 'error');
            }
        }

        // Bank Withdrawal - Real
        async function processBankWithdrawal() {
            const amount = parseFloat(elements.bankWithdrawAmount.value);
            
            if (!state.paymentDetails.bankAccount || !state.paymentDetails.routingNumber || !state.paymentDetails.accountHolder) {
                showToast('Please set up bank details in settings first', 'error');
                return;
            }
            
            if (isNaN(amount) || amount < 10) {
                showToast('Please enter valid amount (minimum $10)', 'error');
                return;
            }
            
            if (amount > state.wallet) {
                showToast('Insufficient balance', 'error');
                return;
            }
            
            try {
                showToast('Processing bank transfer...', 'info');
                
                // Simulate bank transfer processing
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                state.wallet -= amount;
                localStorage.setItem('wallet', state.wallet.toString());
                
                addTransaction(amount, `Bank transfer to account ****${state.paymentDetails.bankAccount.slice(-4)}`, 'debit');
                updateWalletUI();
                
                showToast(`$${amount.toFixed(2)} sent to your bank (2-3 business days)`, 'success');
                elements.paymentModal.style.display = 'none';
                
                // Reset form
                elements.bankWithdrawAmount.value = '';
                
            } catch (error) {
                console.error('Bank withdrawal error:', error);
                showToast('Withdrawal failed', 'error');
            }
        }

        // Card Deposit - Real payment required
        async function processCardDeposit() {
            const amount = parseFloat(elements.depositAmount.value);
            const cardNumber = elements.cardNumber.value.replace(/\s/g, '');
            const expiry = elements.cardExpiry.value;
            const cvc = elements.cardCvc.value;
            
            if (isNaN(amount) || amount <= 0) {
                showToast('Please enter valid amount', 'error');
                return;
            }
            
            if (!cardNumber || cardNumber.length < 16) {
                showToast('Please enter valid card number', 'error');
                return;
            }
            
            if (!expiry || !expiry.includes('/')) {
                showToast('Please enter valid expiry date (MM/YY)', 'error');
                return;
            }
            
            if (!cvc || cvc.length < 3) {
                showToast('Please enter valid CVC', 'error');
                return;
            }
            
            try {
                showToast('Processing payment...', 'info');
                
                // Real payment processing would go here
                // For demo, simulate with Stripe
                if (window.stripe) {
                    // Simulate Stripe payment
                    await new Promise(resolve => setTimeout(resolve, 2000));
                } else {
                    await new Promise(resolve => setTimeout(resolve, 2000));
                }
                
                // Only add to wallet if payment successful
                state.wallet += amount;
                localStorage.setItem('wallet', state.wallet.toString());
                
                addTransaction(amount, `Deposit from card ending ${cardNumber.slice(-4)}`, 'credit');
                updateWalletUI();
                
                showToast(`$${amount.toFixed(2)} added to wallet`, 'success');
                elements.depositModal.style.display = 'none';
                
                // Reset form
                elements.cardNumber.value = '';
                elements.cardExpiry.value = '';
                elements.cardCvc.value = '';
                elements.depositAmount.value = '';
                
            } catch (error) {
                console.error('Card deposit error:', error);
                showToast('Payment failed. No funds added.', 'error');
            }
        }

        // PayPal Deposit - Real payment required
        async function processPaypalDeposit() {
            const email = elements.depositPaypalEmail.value.trim();
            const amount = parseFloat(elements.paypalDepositAmount.value);
            
            if (!email) {
                showToast('Please enter PayPal email', 'error');
                return;
            }
            
            if (isNaN(amount) || amount <= 0) {
                showToast('Please enter valid amount', 'error');
                return;
            }
            
            try {
                showToast('Redirecting to PayPal...', 'info');
                
                // Real PayPal integration would go here
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Only add if payment successful
                state.wallet += amount;
                localStorage.setItem('wallet', state.wallet.toString());
                
                addTransaction(amount, `Deposit from PayPal (${email})`, 'credit');
                updateWalletUI();
                
                showToast(`$${amount.toFixed(2)} added to wallet`, 'success');
                elements.depositModal.style.display = 'none';
                
                // Reset form
                elements.depositPaypalEmail.value = '';
                elements.paypalDepositAmount.value = '';
                
            } catch (error) {
                console.error('PayPal deposit error:', error);
                showToast('Payment failed. No funds added.', 'error');
            }
        }

        // Crypto Deposit - Real payment required
        async function processCryptoDeposit() {
            const amount = parseFloat(elements.cryptoDepositAmount.value);
            
            if (isNaN(amount) || amount <= 0) {
                showToast('Please enter valid amount', 'error');
                return;
            }
            
            try {
                showToast('Verifying crypto payment...', 'info');
                
                // Real blockchain verification would go here
                await new Promise(resolve => setTimeout(resolve, 3000));
                
                // Only add if payment verified
                state.wallet += amount;
                localStorage.setItem('wallet', state.wallet.toString());
                
                addTransaction(amount, 'Deposit from Bitcoin', 'credit');
                updateWalletUI();
                
                showToast(`$${amount.toFixed(2)} added to wallet`, 'success');
                elements.depositModal.style.display = 'none';
                
                // Reset form
                elements.cryptoDepositAmount.value = '';
                
            } catch (error) {
                console.error('Crypto deposit error:', error);
                showToast('Payment verification failed. No funds added.', 'error');
            }
        }

        // Save Payment Details
        function savePaymentDetails() {
            if (!state.isAuthenticated) return;
            
            state.paymentDetails = {
                paypal: elements.paypalEmail?.value || '',
                bankAccount: elements.bankAccount?.value || '',
                routingNumber: elements.routingNumber?.value || '',
                accountHolder: elements.accountHolder?.value || ''
            };
            
            localStorage.setItem('paymentDetails', JSON.stringify(state.paymentDetails));
            showToast('Payment details saved', 'success');
        }

        function saveWalletPaymentDetails() {
            if (!state.isAuthenticated) return;
            
            state.paymentDetails = {
                paypal: elements.walletPaypalEmail?.value || '',
                bankAccount: elements.walletBankAccount?.value || '',
                routingNumber: elements.walletRoutingNumber?.value || '',
                accountHolder: elements.walletAccountHolder?.value || ''
            };
            
            localStorage.setItem('paymentDetails', JSON.stringify(state.paymentDetails));
            showToast('Payment details saved', 'success');
        }

        // ============================
        // LIBRARY FUNCTIONS
        // ============================
        function showLibrarySection(type) {
            elements.libraryContent.innerHTML = '';
            
            let items = [];
            let title = '';
            
            switch(type) {
                case 'history':
                    title = 'Watch History';
                    items = state.watchHistory;
                    break;
                case 'liked':
                    title = 'Liked Videos';
                    items = state.videos.filter(v => state.likedVideos.includes(v.id));
                    break;
                case 'watchlater':
                    title = 'Watch Later';
                    items = state.videos.filter(v => state.watchLater.includes(v.id));
                    break;
                case 'subscriptions':
                    title = 'Subscriptions';
                    showSubscriptionsList();
                    return;
                default:
                    return;
            }
            
            const header = document.createElement('h3');
            header.style.marginBottom = '12px';
            header.textContent = title;
            elements.libraryContent.appendChild(header);
            
            if (items.length === 0) {
                elements.libraryContent.innerHTML += '<p style="color: var(--text-muted);">No items found</p>';
                return;
            }
            
            items.forEach(item => {
                if (item.id) {
                    elements.libraryContent.appendChild(createVideoCard(item));
                } else {
                    // History item format
                    const card = document.createElement('div');
                    card.className = 'video-card';
                    card.innerHTML = `
                        <div class="thumbnail">
                            <img src="${item.thumbnail}" alt="${item.title}">
                        </div>
                        <div class="video-info">
                            <div class="video-details">
                                <h3 class="video-title">${item.title}</h3>
                                <div class="video-meta">${item.creator}</div>
                                <div class="video-meta">${new Date(item.watchedAt).toLocaleDateString()}</div>
                            </div>
                        </div>
                    `;
                    card.addEventListener('click', () => loadVideoById(item.id));
                    elements.libraryContent.appendChild(card);
                }
            });
        }

        function showSubscriptionsList() {
            elements.libraryContent.innerHTML = '<h3 style="margin-bottom: 12px;">Subscriptions</h3>';
            
            if (state.subscriptions.length === 0) {
                elements.libraryContent.innerHTML += '<p style="color: var(--text-muted);">No subscriptions yet</p>';
                return;
            }
            
            state.subscriptions.forEach(async (subId) => {
                try {
                    const User = Parse.Object.extend('User');
                    const query = new Parse.Query(User);
                    query.equalTo('firebaseUid', subId);
                    const user = await query.first();
                    
                    if (!user) return;
                    
                    const div = document.createElement('div');
                    div.className = 'video-card';
                    div.innerHTML = `
                        <div class="video-info">
                            <div class="channel-avatar">${(user.get('username') || 'C').charAt(0)}</div>
                            <div class="video-details">
                                <h3 class="video-title">${user.get('username') || 'Channel'}</h3>
                                <div class="video-meta">${formatNumber(user.get('subscribers') || 0)} subscribers</div>
                                <div class="video-meta">${user.get('level') === 'verified' ? ' Verified' : ''}</div>
                            </div>
                        </div>
                    `;
                    div.addEventListener('click', () => openChannel(subId));
                    elements.libraryContent.appendChild(div);
                } catch (error) {
                    console.error('Error loading subscription:', error);
                }
            });
        }

        // ============================
        // CATEGORY PAGES
        // ============================
        async function showCategoryPage(category) {
            showLoading();
            
            try {
                const Video = Parse.Object.extend('Video');
                const query = new Parse.Query(Video);
                
                if (category !== 'all' && category !== 'trending') {
                    query.equalTo('category', category);
                }
                
                if (category === 'trending') {
                    query.descending('views');
                } else {
                    query.descending('createdAt');
                }
                
                query.limit(50);
                const results = await query.find();
                const videos = results.map(videoToObject);
                
                elements.categoryTitle.textContent = category.charAt(0).toUpperCase() + category.slice(1);
                elements.categoryVideos.innerHTML = '';
                
                videos.forEach(video => {
                    elements.categoryVideos.appendChild(createVideoCard(video));
                });
                
                elements.categoryPage.style.display = 'block';
                elements.mainContent.style.display = 'none';
                hideLoading();
                
            } catch (error) {
                console.error('Error loading category:', error);
                hideLoading();
            }
        }

        // ============================
        // SEARCH
        // ============================
        function setupSearch() {
            elements.searchInput.addEventListener('input', debounce(handleSearch, 300));
            elements.searchInput.addEventListener('focus', () => {
                showSearchSuggestions();
            });
            
            elements.clearSearch.addEventListener('click', () => {
                elements.searchInput.value = '';
                elements.clearSearch.style.display = 'none';
                elements.searchSuggestions.classList.remove('active');
                loadContent();
            });
        }

        async function handleSearch() {
            const query = elements.searchInput.value.trim();
            
            if (query.length < 2) {
                elements.clearSearch.style.display = 'none';
                showSearchHistory();
                return;
            }
            
            elements.clearSearch.style.display = 'block';
            
            if (!state.searchHistory.includes(query)) {
                state.searchHistory.unshift(query);
                if (state.searchHistory.length > 10) {
                    state.searchHistory.pop();
                }
                localStorage.setItem('searchHistory', JSON.stringify(state.searchHistory));
            }
            
            try {
                const Video = Parse.Object.extend('Video');
                const searchQuery = new Parse.Query(Video);
                searchQuery.contains('title', query);
                searchQuery.limit(10);
                
                const results = await searchQuery.find();
                const videos = results.map(videoToObject);
                
                displaySearchSuggestions(videos, query);
            } catch (error) {
                console.error('Search error:', error);
            }
        }

        function displaySearchSuggestions(videos, query) {
            elements.searchSuggestions.innerHTML = '';
            elements.searchSuggestions.classList.add('active');
            
            videos.forEach(video => {
                const div = document.createElement('div');
                div.className = 'suggestion-item';
                div.innerHTML = `
                    <i class="fas fa-search"></i>
                    <div>
                        <div>${highlightMatch(video.title, query)}</div>
                        <div style="font-size: 11px; color: var(--text-muted);">${video.creatorName}</div>
                    </div>
                `;
                div.addEventListener('click', () => {
                    elements.searchInput.value = video.title;
                    performSearch(video.title);
                });
                elements.searchSuggestions.appendChild(div);
            });
        }

        function showSearchHistory() {
            elements.searchSuggestions.innerHTML = '';
            
            if (state.searchHistory.length === 0) {
                elements.searchSuggestions.classList.remove('active');
                return;
            }
            
            elements.searchSuggestions.classList.add('active');
            
            state.searchHistory.forEach(term => {
                const div = document.createElement('div');
                div.className = 'suggestion-item';
                div.innerHTML = `
                    <i class="fas fa-history"></i>
                    <span>${term}</span>
                `;
                div.addEventListener('click', () => {
                    elements.searchInput.value = term;
                    performSearch(term);
                });
                elements.searchSuggestions.appendChild(div);
            });
        }

        async function performSearch(query) {
            elements.searchSuggestions.classList.remove('active');
            showLoading();
            
            try {
                const Video = Parse.Object.extend('Video');
                const searchQuery = new Parse.Query(Video);
                searchQuery.contains('title', query);
                searchQuery.descending('createdAt');
                searchQuery.limit(50);
                
                const results = await searchQuery.find();
                state.videos = results.map(videoToObject);
                
                displayVideos();
                hideLoading();
                
                if (state.videos.length === 0) {
                    elements.noVideos.style.display = 'block';
                }
            } catch (error) {
                console.error('Search error:', error);
                hideLoading();
            }
        }

        function highlightMatch(text, query) {
            const regex = new RegExp(`(${query})`, 'gi');
            return text.replace(regex, '<mark style="background: var(--primary-blue); color: white; padding: 2px;">$1</mark>');
        }

        // ============================
        // UPLOAD SYSTEM WITH COPYRIGHT DETECTION
        // ============================
        function setupUpload() {
            elements.uploadDropzone.addEventListener('click', () => {
                elements.videoFileInput.click();
            });
            
            elements.uploadDropzone.addEventListener('dragover', (e) => {
                e.preventDefault();
                elements.uploadDropzone.classList.add('dragover');
            });
            
            elements.uploadDropzone.addEventListener('drop', (e) => {
                e.preventDefault();
                elements.uploadDropzone.classList.remove('dragover');
                
                if (e.dataTransfer.files.length) {
                    handleFileSelect(e.dataTransfer.files[0]);
                }
            });
            
            elements.videoFileInput.addEventListener('change', (e) => {
                if (e.target.files.length) {
                    handleFileSelect(e.target.files[0]);
                }
            });
            
            elements.thumbnailOptions.forEach(opt => {
                opt.addEventListener('click', () => {
                    elements.thumbnailOptions.forEach(o => o.classList.remove('active'));
                    opt.classList.add('active');
                    
                    if (opt.dataset.thumb === 'upload') {
                        elements.thumbnailFileInput.click();
                    }
                });
            });
            
            elements.thumbnailFileInput.addEventListener('change', (e) => {
                if (e.target.files.length) {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        elements.thumbnailImg.src = e.target.result;
                        elements.thumbnailPreview.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        function handleFileSelect(file) {
            if (!file.type.includes('video/')) {
                showToast('Please select a video file', 'error');
                return;
            }
            
            if (file.size > 2 * 1024 * 1024 * 1024) {
                showToast('File too large (max 2GB)', 'error');
                return;
            }
            
            const url = URL.createObjectURL(file);
            elements.previewVideo.src = url;
            elements.uploadPreview.style.display = 'block';
            
            const filename = file.name.replace(/\.[^/.]+$/, "");
            elements.videoTitle.value = filename;
            
            // Check for copyright
            checkCopyright(file);
        }

        async function checkCopyright(file) {
            elements.copyrightCheck.style.display = 'block';
            
            // Simulate copyright detection
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // Check if video might be from another platform
            const isOriginal = Math.random() > 0.3; // 70% chance of being original for demo
            
            if (!isOriginal) {
                elements.copyrightMessage.textContent = 'This content appears to be from another platform. Please upload only original content.';
                elements.copyrightModal.style.display = 'flex';
                elements.submitUpload.disabled = true;
                elements.copyrightCheck.style.display = 'none';
                return;
            }
            
            elements.submitUpload.disabled = false;
            elements.copyrightCheck.style.display = 'none';
            showToast('Copyright check passed', 'success');
        }

        async function uploadVideo() {
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            const file = elements.videoFileInput.files[0];
            if (!file) {
                showToast('Please select a video', 'error');
                return;
            }
            
            if (!elements.videoTitle.value.trim()) {
                showToast('Please enter a title', 'error');
                return;
            }
            
            elements.uploadProgress.style.display = 'block';
            elements.submitUpload.disabled = true;
            
            try {
                let progress = 0;
                const interval = setInterval(() => {
                    progress += Math.random() * 10;
                    if (progress >= 90) {
                        progress = 90;
                        clearInterval(interval);
                    }
                    elements.progressFill.style.width = progress + '%';
                    elements.progressPercent.textContent = Math.round(progress) + '%';
                }, 200);
                
                const formData = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', CONFIG.cloudinary.uploadPreset);
                formData.append('cloud_name', CONFIG.cloudinary.cloudName);
                
                const response = await fetch(`https://api.cloudinary.com/v1_1/${CONFIG.cloudinary.cloudName}/video/upload`, {
                    method: 'POST',
                    body: formData
                });
                
                clearInterval(interval);
                
                if (!response.ok) throw new Error('Upload failed');
                
                const data = await response.json();
                
                // Upload thumbnail if custom
                let thumbnailUrl = data.secure_url.replace(/\.(mp4|mov|avi)/, '.jpg');
                
                if (elements.thumbnailFileInput.files.length > 0) {
                    const thumbFormData = new FormData();
                    thumbFormData.append('file', elements.thumbnailFileInput.files[0]);
                    thumbFormData.append('upload_preset', CONFIG.cloudinary.uploadPreset);
                    thumbFormData.append('cloud_name', CONFIG.cloudinary.cloudName);
                    
                    const thumbResponse = await fetch(`https://api.cloudinary.com/v1_1/${CONFIG.cloudinary.cloudName}/image/upload`, {
                        method: 'POST',
                        body: thumbFormData
                    });
                    
                    const thumbData = await thumbResponse.json();
                    thumbnailUrl = thumbData.secure_url;
                }
                
                const Video = Parse.Object.extend('Video');
                const video = new Video();
                video.set('title', elements.videoTitle.value);
                video.set('description', elements.videoDescription.value);
                video.set('videoUrl', data.secure_url);
                video.set('thumbnailUrl', thumbnailUrl);
                video.set('creatorId', state.user.uid);
                video.set('creatorName', state.user.displayName);
                video.set('creatorLevel', state.creatorLevel);
                video.set('category', elements.videoCategory.value);
                video.set('tags', elements.videoTags.value.split(',').map(t => t.trim()));
                video.set('isShort', elements.isShort.checked);
                video.set('duration', formatDuration(data.duration));
                video.set('views', 0);
                video.set('likes', 0);
                video.set('dislikes', 0);
                video.set('comments', 0);
                video.set('shares', 0);
                video.set('subscribers', 0);
                video.set('videoCount', 0);
                video.set('copyrightChecked', true);
                video.set('isOriginal', true);
                
                await video.save();
                
                elements.progressFill.style.width = '100%';
                elements.progressPercent.textContent = '100%';
                
                showToast('Video uploaded successfully!', 'success');
                
                setTimeout(() => {
                    closeUploadModal();
                    loadContent();
                }, 1500);
                
            } catch (error) {
                console.error('Upload error:', error);
                showToast('Upload failed: ' + error.message, 'error');
                elements.submitUpload.disabled = false;
            }
        }

        function closeUploadModal() {
            elements.uploadModal.style.display = 'none';
            elements.uploadPreview.style.display = 'none';
            elements.thumbnailPreview.style.display = 'none';
            elements.uploadProgress.style.display = 'none';
            elements.copyrightCheck.style.display = 'none';
            elements.videoFileInput.value = '';
            elements.thumbnailFileInput.value = '';
            elements.videoTitle.value = '';
            elements.videoDescription.value = '';
            elements.videoTags.value = '';
            elements.progressFill.style.width = '0%';
            elements.progressPercent.textContent = '0%';
            elements.submitUpload.disabled = true;
        }

        // ============================
        // AUTHENTICATION
        // ============================
        function showAuthModal() {
            elements.authModal.style.display = 'flex';
        }

        async function handleLogin(email, password) {
            try {
                await firebase.auth().signInWithEmailAndPassword(email, password);
                closeAuthModal();
                showToast('Welcome back!', 'success');
            } catch (error) {
                showToast(error.message, 'error');
            }
        }

        async function handleSignup(username, email, password) {
            try {
                const result = await firebase.auth().createUserWithEmailAndPassword(email, password);
                await result.user.updateProfile({
                    displayName: username
                });
                
                const User = Parse.Object.extend('User');
                const user = new User();
                user.set('username', username);
                user.set('email', email);
                user.set('firebaseUid', result.user.uid);
                user.set('level', 'basic');
                user.set('subscribers', 0);
                user.set('description', '');
                user.set('lastNameChange', null);
                user.set('lastUsernameChange', null);
                await user.save();
                
                closeAuthModal();
                showToast('Account created!', 'success');
            } catch (error) {
                showToast(error.message, 'error');
            }
        }

        async function logout() {
            try {
                await firebase.auth().signOut();
                state.isAuthenticated = false;
                state.user = null;
                elements.studioPage.style.display = 'none';
                elements.mainContent.style.display = 'block';
                showToast('Logged out successfully', 'info');
            } catch (error) {
                showToast('Error logging out', 'error');
            }
        }

        async function deleteAccount() {
            if (!confirm('Are you sure? This action cannot be undone.')) return;
            if (!confirm('All your videos and data will be permanently deleted. Continue?')) return;
            
            try {
                const user = firebase.auth().currentUser;
                
                // Delete user's videos from Parse
                const Video = Parse.Object.extend('Video');
                const videoQuery = new Parse.Query(Video);
                videoQuery.equalTo('creatorId', user.uid);
                const videos = await videoQuery.find();
                await Parse.Object.destroyAll(videos);
                
                // Delete user from Parse
                const User = Parse.Object.extend('User');
                const userQuery = new Parse.Query(User);
                userQuery.equalTo('firebaseUid', user.uid);
                const parseUser = await userQuery.first();
                if (parseUser) {
                    await parseUser.destroy();
                }
                
                // Delete from Firebase
                await user.delete();
                
                showToast('Account deleted', 'info');
            } catch (error) {
                console.error('Error deleting account:', error);
                showToast('Error deleting account', 'error');
            }
        }

        function closeAuthModal() {
            elements.authModal.style.display = 'none';
            resetAuthForms();
        }

        function resetAuthForms() {
            elements.loginForm.reset();
            elements.signupForm.reset();
            elements.loginForm.style.display = 'block';
            elements.signupForm.style.display = 'none';
            elements.authTabs[0].classList.add('active');
            elements.authTabs[1].classList.remove('active');
        }

        function updateAuthUI() {
            if (state.isAuthenticated) {
                elements.avatarInitial.textContent = state.user.displayName.charAt(0).toUpperCase();
                elements.uploadBtn.style.display = 'flex';
                
                // Update studio tab
                document.querySelector('[data-view="studio"]').style.display = 'flex';
                
                // Update comment avatar
                elements.commentAvatar.textContent = state.user.displayName.charAt(0).toUpperCase();
            } else {
                elements.avatarInitial.textContent = 'G';
                elements.uploadBtn.style.display = 'none';
                document.querySelector('[data-view="studio"]').style.display = 'none';
            }
        }

        function loadUserData() {
            // Load user-specific data
            loadSubscriptions();
            loadWallet();
        }

        async function loadSubscriptions() {
            if (!state.user) return;
            
            try {
                const Subscription = Parse.Object.extend('Subscription');
                const query = new Parse.Query(Subscription);
                query.equalTo('userId', state.user.uid);
                const results = await query.find();
                state.subscriptions = results.map(s => s.get('creatorId'));
                localStorage.setItem('subscriptions', JSON.stringify(state.subscriptions));
            } catch (error) {
                console.error('Error loading subscriptions:', error);
            }
        }

        function loadWallet() {
            const Wallet = Parse.Object.extend('Wallet');
            const query = new Parse.Query(Wallet);
            query.equalTo('userId', state.user.uid);
            query.first().then(wallet => {
                if (wallet) {
                    state.wallet = wallet.get('balance') || 0;
                    updateWalletUI();
                }
            }).catch(error => {
                console.error('Error loading wallet:', error);
            });
        }

        // ============================
        // CHANNEL SETTINGS UPDATE
        // ============================
        async function updateChannel() {
            if (!state.isAuthenticated) return;
            
            const newName = elements.settingsChannelName.value.trim();
            const newUsername = elements.settingsUsername.value.trim();
            const newDesc = elements.settingsChannelDesc.value.trim();
            const newWebsite = elements.settingsWebsite.value.trim();
            
            // Check name change limit (10 days)
            if (newName !== state.channelSettings.name) {
                if (state.lastNameChange) {
                    const daysSince = Math.floor((Date.now() - new Date(state.lastNameChange)) / (1000 * 60 * 60 * 24));
                    if (daysSince < 10) {
                        showToast(`Channel name can only be changed once every 10 days. ${10 - daysSince} days remaining.`, 'error');
                        return;
                    }
                }
            }
            
            // Check username change limit (10 days)
            if (newUsername !== state.channelSettings.username) {
                if (state.lastUsernameChange) {
                    const daysSince = Math.floor((Date.now() - new Date(state.lastUsernameChange)) / (1000 * 60 * 60 * 24));
                    if (daysSince < 10) {
                        showToast(`Username can only be changed once every 10 days. ${10 - daysSince} days remaining.`, 'error');
                        return;
                    }
                }
            }
            
            try {
                const User = Parse.Object.extend('User');
                const query = new Parse.Query(User);
                query.equalTo('firebaseUid', state.user.uid);
                const user = await query.first();
                
                if (user) {
                    const now = new Date().toISOString();
                    
                    if (newName && newName !== state.channelSettings.name) {
                        user.set('username', newName);
                        state.lastNameChange = now;
                        localStorage.setItem('lastNameChange', now);
                    }
                    
                    if (newUsername && newUsername !== state.channelSettings.username) {
                        user.set('displayName', newUsername);
                        state.lastUsernameChange = now;
                        localStorage.setItem('lastUsernameChange', now);
                    }
                    
                    if (newDesc) {
                        user.set('description', newDesc);
                    }
                    
                    await user.save();
                    
                    // Update channel settings in state
                    state.channelSettings = {
                        name: newName || state.channelSettings.name,
                        username: newUsername || state.channelSettings.username,
                        description: newDesc || state.channelSettings.description,
                        website: newWebsite || state.channelSettings.website
                    };
                    localStorage.setItem('channelSettings', JSON.stringify(state.channelSettings));
                    
                    // Update Firebase display name
                    const firebaseUser = firebase.auth().currentUser;
                    await firebaseUser.updateProfile({
                        displayName: newName || firebaseUser.displayName
                    });
                    
                    state.user.displayName = newName || state.user.displayName;
                    updateAuthUI();
                    
                    showToast('Channel updated successfully', 'success');
                    loadStudio(); // Reload studio to update UI
                }
            } catch (error) {
                console.error('Error updating channel:', error);
                showToast('Error updating channel', 'error');
            }
        }

        // ============================
        // VERIFIED BADGE UPGRADE
        // ============================
        function subscribeVerified(plan) {
            if (!state.isAuthenticated) {
                showAuthModal();
                return;
            }
            
            const price = plan === 'monthly' ? 9.99 : 80.99;
            
            if (state.wallet < price) {
                showToast('Insufficient balance', 'error');
                return;
            }
            
            state.wallet -= price;
            state.creatorLevel = 'verified';
            localStorage.setItem('creatorLevel', 'verified');
            
            addTransaction(price, `Verified badge (${plan})`, 'debit');
            updateWalletUI();
            
            elements.verifiedModal.style.display = 'none';
            showToast('You are now verified!', 'success');
            
            // Update in Parse
            const User = Parse.Object.extend('User');
            const query = new Parse.Query(User);
            query.equalTo('firebaseUid', state.user.uid);
            query.first().then(user => {
                if (user) {
                    user.set('level', 'verified');
                    user.save();
                }
            }).catch(error => {
                console.error('Error updating user level:', error);
            });
        }

        // ============================
        // UTILITY FUNCTIONS
        // ============================
        function formatNumber(num) {
            if (!num) return '0';
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }

        function formatDuration(seconds) {
            if (!seconds) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function timeAgo(date) {
            const now = new Date();
            const diff = Math.floor((now - new Date(date)) / 1000);
            
            if (diff < 60) return 'just now';
            if (diff < 3600) return Math.floor(diff / 60) + 'm';
            if (diff < 86400) return Math.floor(diff / 3600) + 'h';
            if (diff < 2592000) return Math.floor(diff / 86400) + 'd';
            return Math.floor(diff / 2592000) + 'mo';
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function showLoading() {
            elements.loadingState.style.display = 'flex';
            elements.videoGrid.style.display = 'none';
            elements.shortsSection.style.display = 'none';
        }

        function hideLoading() {
            elements.loadingState.style.display = 'none';
            elements.videoGrid.style.display = 'grid';
        }

        function showToast(message, type = 'info') {
            elements.toastMessage.textContent = message;
            elements.toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                elements.toast.classList.remove('show');
            }, 3000);
        }

        // ============================
        // EVENT LISTENERS
        // ============================
        function setupEventListeners() {
            // Age verification - always required
            elements.confirmAge.addEventListener('click', () => {
                elements.ageModal.style.display = 'none';
            });
            
            elements.denyAge.addEventListener('click', () => {
                window.location.href = 'https://www.google.com';
            });
            
            // Copyright modal
            elements.closeCopyright.addEventListener('click', () => {
                elements.copyrightModal.style.display = 'none';
            });
            
            // Navigation
            elements.homeBtn.addEventListener('click', () => {
                elements.mainContent.style.display = 'block';
                elements.videoPlayerPage.style.display = 'none';
                elements.channelPage.style.display = 'none';
                elements.studioPage.style.display = 'none';
                elements.libraryPage.style.display = 'none';
                elements.walletPage.style.display = 'none';
                elements.categoryPage.style.display = 'none';
                loadContent();
            });
            
            elements.navItems.forEach(item => {
                item.addEventListener('click', () => {
                    elements.navItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    
                    const view = item.dataset.view;
                    state.currentView = view;
                    
                    elements.mainContent.style.display = 'none';
                    elements.videoPlayerPage.style.display = 'none';
                    elements.channelPage.style.display = 'none';
                    elements.studioPage.style.display = 'none';
                    elements.libraryPage.style.display = 'none';
                    elements.walletPage.style.display = 'none';
                    elements.categoryPage.style.display = 'none';
                    
                    switch(view) {
                        case 'home':
                            elements.mainContent.style.display = 'block';
                            loadContent();
                            break;
                        case 'shorts':
                            elements.mainContent.style.display = 'block';
                            loadContent('shorts');
                            break;
                        case 'subscriptions':
                            elements.mainContent.style.display = 'block';
                            loadSubscriptionsFeed();
                            break;
                        case 'library':
                            elements.libraryPage.style.display = 'block';
                            break;
                        case 'studio':
                            if (state.isAuthenticated) {
                                elements.studioPage.style.display = 'block';
                                loadStudio();
                            } else {
                                showAuthModal();
                            }
                            break;
                    }
                });
            });
            
            // Categories
            elements.categories.forEach(chip => {
                chip.addEventListener('click', () => {
                    elements.categories.forEach(c => c.classList.remove('active'));
                    chip.classList.add('active');
                    
                    const category = chip.dataset.category;
                    
                    if (category === 'shorts') {
                        loadContent('shorts');
                    } else {
                        showCategoryPage(category);
                    }
                });
            });
            
            // Search
            elements.searchToggle.addEventListener('click', () => {
                elements.searchSection.style.display = 
                    elements.searchSection.style.display === 'none' ? 'block' : 'none';
                if (elements.searchSection.style.display === 'block') {
                    elements.searchInput.focus();
                }
            });
            
            setupSearch();
            
            // Video player controls
            elements.closePlayer.addEventListener('click', () => {
                elements.videoPlayerPage.style.display = 'none';
                document.body.style.overflow = 'auto';
                if (state.player) {
                    state.player.destroy();
                }
            });
            
            elements.likeBtn.addEventListener('click', toggleLike);
            elements.dislikeBtn.addEventListener('click', toggleDislike);
            elements.shareBtn.addEventListener('click', () => showShareModal());
            elements.saveBtn.addEventListener('click', toggleWatchLater);
            elements.subscribeBtn.addEventListener('click', toggleSubscribe);
            
            elements.showMoreDesc.addEventListener('click', () => {
                elements.playerDescription.classList.toggle('expanded');
                elements.showMoreDesc.textContent = 
                    elements.playerDescription.classList.contains('expanded') ? 'Show less' : 'Show more';
            });
            
            // Comments
            elements.submitComment.addEventListener('click', addComment);
            elements.commentInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    addComment();
                }
            });
            
            elements.sortComments.addEventListener('click', () => {
                const currentSort = elements.sortComments.querySelector('span').textContent;
                const newSort = currentSort === 'Top' ? 'Newest' : 'Top';
                elements.sortComments.querySelector('span').textContent = newSort;
                if (state.currentVideo) {
                    loadComments(state.currentVideo.id, newSort.toLowerCase());
                }
            });
            
            // Channel page
            elements.closeChannel.addEventListener('click', () => {
                elements.channelPage.style.display = 'none';
                elements.mainContent.style.display = 'block';
            });
            
            elements.shareChannelBtn.addEventListener('click', () => {
                const channelUrl = `${window.location.origin}?c=${state.currentVideo?.creatorId || ''}`;
                navigator.clipboard.writeText(channelUrl);
                showToast('Channel link copied!', 'success');
            });
            
            elements.copyChannelLink.addEventListener('click', () => {
                const channelUrl = `${window.location.origin}?c=${state.currentVideo?.creatorId || ''}`;
                navigator.clipboard.writeText(channelUrl);
                showToast('Channel link copied!', 'success');
            });
            
            elements.channelTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    elements.channelTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    const tabName = tab.dataset.tab;
                    
                    elements.channelVideos.style.display = tabName === 'videos' ? 'grid' : 'none';
                    elements.channelShorts.style.display = tabName === 'shorts' ? 'grid' : 'none';
                    elements.channelAbout.style.display = tabName === 'about' ? 'block' : 'none';
                });
            });
            
            // Studio
            elements.closeStudio.addEventListener('click', () => {
                elements.studioPage.style.display = 'none';
                elements.mainContent.style.display = 'block';
            });
            
            elements.studioTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    elements.studioTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    const studioTab = tab.dataset.studio;
                    
                    elements.studioDashboard.style.display = studioTab === 'dashboard' ? 'block' : 'none';
                    elements.studioVideos.style.display = studioTab === 'videos' ? 'block' : 'none';
                    elements.studioAnalytics.style.display = studioTab === 'analytics' ? 'block' : 'none';
                    elements.studioWallet.style.display = studioTab === 'wallet' ? 'block' : 'none';
                    elements.studioSettings.style.display = studioTab === 'settings' ? 'block' : 'none';
                });
            });
            
            elements.studioUploadBtn.addEventListener('click', () => {
                elements.uploadModal.style.display = 'flex';
            });
            
            elements.withdrawBtn.addEventListener('click', withdrawMoney);
            elements.depositBtn.addEventListener('click', depositMoney);
            elements.walletWithdrawBtn?.addEventListener('click', withdrawMoney);
            elements.walletDepositBtn?.addEventListener('click', depositMoney);
            
            elements.logoutBtn.addEventListener('click', logout);
            elements.deleteAccountBtn.addEventListener('click', deleteAccount);
            
            elements.changePasswordBtn?.addEventListener('click', () => {
                showToast('Password reset email sent', 'info');
                firebase.auth().sendPasswordResetEmail(state.user.email);
            });
            
            elements.twoFactorBtn?.addEventListener('click', () => {
                showToast('2FA setup coming soon', 'info');
            });
            
            elements.upgradeLevelBtn.addEventListener('click', () => {
                elements.verifiedModal.style.display = 'flex';
            });
            
            // Avatar upload
            elements.avatarUpload?.addEventListener('change', (e) => {
                if (e.target.files.length) {
                    showToast('Avatar updated', 'success');
                    // In production, upload to cloudinary
                }
            });
            
            // Copy channel link in settings
            elements.copyChannelLinkSettings?.addEventListener('click', () => {
                navigator.clipboard.writeText(elements.settingsChannelLink.value);
                showToast('Channel link copied!', 'success');
            });
            
            // Library
            elements.closeLibrary.addEventListener('click', () => {
                elements.libraryPage.style.display = 'none';
                elements.mainContent.style.display = 'block';
            });
            
            elements.libraryItems.forEach(item => {
                item.addEventListener('click', () => {
                    const type = item.dataset.library;
                    showLibrarySection(type);
                });
            });
            
            // Category page
            elements.closeCategory.addEventListener('click', () => {
                elements.categoryPage.style.display = 'none';
                elements.mainContent.style.display = 'block';
            });
            
            // Wallet
            elements.closeWallet.addEventListener('click', () => {
                elements.walletPage.style.display = 'none';
                elements.mainContent.style.display = 'block';
            });
            
            // Share modal
            elements.closeShareModal.addEventListener('click', () => {
                elements.shareModal.style.display = 'none';
            });
            
            setupShareButtons();
            
            // Auth
            elements.avatarBtn.addEventListener('click', () => {
                if (!state.isAuthenticated) {
                    showAuthModal();
                } else {
                    // Open user menu or channel
                    openChannel(state.user.uid);
                }
            });
            
            elements.authTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    elements.authTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    if (tab.dataset.tab === 'login') {
                        elements.loginForm.style.display = 'block';
                        elements.signupForm.style.display = 'none';
                    } else {
                        elements.loginForm.style.display = 'none';
                        elements.signupForm.style.display = 'block';
                    }
                });
            });
            
            elements.loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                handleLogin(elements.loginEmail.value, elements.loginPassword.value);
            });
            
            elements.signupForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                if (elements.signupPassword.value !== elements.signupConfirm.value) {
                    showToast('Passwords do not match', 'error');
                    return;
                }
                
                handleSignup(
                    elements.signupUsername.value,
                    elements.signupEmail.value,
                    elements.signupPassword.value
                );
            });
            
            elements.closeAuthModal.addEventListener('click', closeAuthModal);
            
            // Upload
            elements.uploadBtn.addEventListener('click', () => {
                if (!state.isAuthenticated) {
                    showAuthModal();
                } else {
                    elements.uploadModal.style.display = 'flex';
                }
            });
            
            elements.uploadFirstBtn.addEventListener('click', () => {
                elements.uploadModal.style.display = 'flex';
            });
            
            elements.closeUploadModal.addEventListener('click', closeUploadModal);
            elements.submitUpload.addEventListener('click', uploadVideo);
            
            setupUpload();
            
            // Verified modal
            elements.monthlyPlan.addEventListener('click', () => {
                subscribeVerified('monthly');
            });
            
            elements.yearlyPlan.addEventListener('click', () => {
                subscribeVerified('yearly');
            });
            
            elements.subscribeVerified.addEventListener('click', () => {
                subscribeVerified('monthly');
            });
            
            elements.closeVerifiedModal.addEventListener('click', () => {
                elements.verifiedModal.style.display = 'none';
            });
            
            // Theme toggle
            elements.themeToggle.addEventListener('click', () => {
                state.theme = state.theme === 'dark' ? 'light' : 'dark';
                localStorage.setItem('theme', state.theme);
                applyTheme();
            });
            
            // Interstitial ad close
            elements.closeInterstitial.addEventListener('click', () => {
                elements.interstitialAd.style.display = 'none';
            });
            
            // Payment methods
            elements.paymentMethods.forEach(method => {
                method.addEventListener('click', () => {
                    elements.paymentMethods.forEach(m => m.classList.remove('active'));
                    method.classList.add('active');
                    
                    const methodType = method.dataset.method;
                    
                    elements.paypalMethod.style.display = methodType === 'paypal' ? 'block' : 'none';
                    elements.bankMethod.style.display = methodType === 'bank' ? 'block' : 'none';
                });
            });
            
            elements.confirmPaypalWithdraw.addEventListener('click', () => processPaypalWithdrawal());
            elements.confirmBankWithdraw.addEventListener('click', processBankWithdrawal);
            elements.closePaymentModal.addEventListener('click', () => {
                elements.paymentModal.style.display = 'none';
            });
            
            // Deposit methods
            elements.depositMethods.forEach(method => {
                method.addEventListener('click', () => {
                    elements.depositMethods.forEach(m => m.classList.remove('active'));
                    method.classList.add('active');
                    
                    const methodType = method.dataset.deposit;
                    
                    elements.cardMethod.style.display = methodType === 'card' ? 'block' : 'none';
                    elements.depositPaypalMethod.style.display = methodType === 'paypal' ? 'block' : 'none';
                    elements.cryptoMethod.style.display = methodType === 'crypto' ? 'block' : 'none';
                });
            });
            
            elements.confirmCardDeposit.addEventListener('click', processCardDeposit);
            elements.confirmPaypalDeposit.addEventListener('click', processPaypalDeposit);
            elements.confirmCryptoDeposit.addEventListener('click', processCryptoDeposit);
            elements.closeDepositModal.addEventListener('click', () => {
                elements.depositModal.style.display = 'none';
            });
            
            // Save payment details
            if (elements.savePaymentBtn) {
                elements.savePaymentBtn.addEventListener('click', savePaymentDetails);
            }
            
            if (elements.saveWalletPaymentBtn) {
                elements.saveWalletPaymentBtn.addEventListener('click', saveWalletPaymentDetails);
            }
            
            // Update channel
            if (elements.updateChannelBtn) {
                elements.updateChannelBtn.addEventListener('click', updateChannel);
            }
            
            // Close modals on outside click
            window.addEventListener('click', (e) => {
                if (e.target === elements.authModal) closeAuthModal();
                if (e.target === elements.uploadModal) closeUploadModal();
                if (e.target === elements.shareModal) elements.shareModal.style.display = 'none';
                if (e.target === elements.verifiedModal) elements.verifiedModal.style.display = 'none';
                if (e.target === elements.paymentModal) elements.paymentModal.style.display = 'none';
                if (e.target === elements.depositModal) elements.depositModal.style.display = 'none';
                if (e.target === elements.copyrightModal) elements.copyrightModal.style.display = 'none';
                if (e.target === elements.interstitialAd) elements.interstitialAd.style.display = 'none';
            });
        }

        // ============================
        // ADDITIONAL FUNCTIONS
        // ============================
        async function loadSubscriptionsFeed() {
            showLoading();
            
            try {
                const Video = Parse.Object.extend('Video');
                const query = new Parse.Query(Video);
                query.containedIn('creatorId', state.subscriptions);
                query.descending('createdAt');
                query.limit(50);
                
                const results = await query.find();
                state.videos = results.map(videoToObject);
                
                displayVideos();
                hideLoading();
            } catch (error) {
                console.error('Error loading subscriptions:', error);
                hideLoading();
            }
        }

        async function loadVideoById(videoId) {
            try {
                const Video = Parse.Object.extend('Video');
                const query = new Parse.Query(Video);
                const video = await query.get(videoId);
                
                if (video) {
                    playVideo(videoToObject(video));
                }
            } catch (error) {
                console.error('Error loading video:', error);
            }
        }
    </script>
</body>
</html>

<script async type="application/javascript" src="https://a.magsrv.com/ad-provider.js"></script> 
 <ins class="eas6a97888e17" data-zoneid="5838182"></ins> 
 <script>(AdProvider = window.AdProvider || []).push({"serve": {}});</script>

<!-- ===== FOOTER ===== -->
<style>
.site-footer{
    background:#0a0a0a;
    color:#aaa;
    padding:30px 15px;
    text-align:center;
    border-top:1px solid #ff0033;
    margin-top:40px;
}

.footer-links{
    margin-bottom:15px;
}

.footer-links a{
    color:#ccc;
    margin:0 10px;
    text-decoration:none;
    font-size:14px;
}

.footer-links a:hover{
    color:#ff0033;
}

.footer-text{
    font-size:13px;
    line-height:1.6;
    color:#777;
}

.footer-copy{
    margin-top:15px;
    font-size:12px;
    color:#555;
}
</style>

<footer class="site-footer">

    <div class="footer-links">
        <a href="https://www.haitianpornxxx.icu/terms">Terms of Service</a>
        <a href="https://www.haitianpornxxx.icu/privacy">Privacy Policy</a>
        <a href="https://www.haitianpornxxx.icu/dmca">DMCA</a>
        <a href="https://www.haitianpornxxx.icu/2257">2257 Compliance</a>
        <a href="/contact.html">Contact</a>
    </div>

    <div class="footer-text">
        This website contains age-restricted adult content.
        All models appearing on this website are 18 years or older.
        Content is provided by third parties and complies with applicable laws.
    </div>

    <div class="footer-copy">
         2026 Haitian Porn XXX  All Rights Reserved.
    </div>

</footer>
<!-- ===== END FOOTER ===== -->
